function ja(a,b,c,d,e,f,g){this.ba=f;this.userCnt=0;this.app=b;this.doc=a;this.visible=false;var h=v(a,c,"winChatShare",0,0,d,e);this.divMain=h;h.style.display="none";h.style.overflow="hidden";var i=d-24;var j=sb(a,h,g+"closeX.gif","closeImg","right:15px;top:5px","Close");j.onclick=la(f,f.lb,true,false,false,true);var l=da(a,h,"imTable","");l.style.height="100%";l.style.width=i;l.align="center";var k=K(l,10);k=K(l,20,"imTitle");k.innerHTML="Viewing now:";k=K(l,125);var n=v(a,k,"imUsers",8,0,i,"100%"
);this.Ff=sa(this.doc,n,"dlgTblGen",0,0,"","","table");this.Pj=n;k=K(l,10);k=K(l,"99%");n=v(this.doc,k,"imMsgs",0,0,i,"100%");this.Wi=sa(this.doc,n,"dlgTblGen",0,0,"","","table");this.Oj=n;k=K(l,15,"imShowHideDisabled");k.innerHTML="Press enter to send your message";k=K(l,55);this.curIM=pa(this.doc,k,"imEditBox","","relative",0,0,i,55,1000,"textarea");k=K(l,10);this.Ra=p.createAdapter(this,this.xc);p.addBuiltInListener(this.curIM,"keydown",this.Ra);this.Qb=p.createAdapter(this,this.cf);p.addBuiltInListener(
this.curIM,"keyup",this.Qb);this.clearIM=false;this.Jh=null}
ja.prototype.nl=function(){var a=this.Wi.style;a.display="none";window.setTimeout(function(){a.display=""}
,0)}
;ja.prototype.xc=function(a){var b=a.keyCode?a.keyCode:(a.which?a.which:a.charCode);var c=this.curIM.value;if(b==13){if(!a.altKey&&!a.ctrlKey&&!a.shiftKey){if(c.length>0){this.rg("me: "+c);var d=O+"=9";d+="&atyp="+q.newIM;d+="&v="+encodeURIComponent(c);this.app.Z("Updating...");this.app.ea(d,false)}this.clearIM=true}}}
;ja.prototype.cf=function(a){if(this.clearIM){this.curIM.value="";this.clearIM=false}}
;ja.prototype.rg=function(a){if(a==""){return false}var b=this.Wi;var c=b.insertRow(b.rows.length).insertCell(0);var d=a.indexOf(":");var e=a.substr(0,d+1);a=a.substr(d+1);if(this.Jh==e){c.innerHTML="&nbsp;&nbsp;"}else{c.innerHTML="<b>"+e+"</b>";this.Jh=e}c.appendChild(this.doc.createTextNode(a));this.Oj.scrollTop=2000000;this.ba.Jd(true)}
;ja.prototype.Bk=function(a,b){if(a!=null){for(var c=0;c<a.length;c++){this.Pc(a[c][0],a[c][1])}if(a.length>1){b.lb(true,true,false,false)}}}
;ja.prototype.Pc=function(a,b){if(this.hh(b)==null){var c=this.Ff;var d=c.insertRow(c.rows.length).insertCell(0);d.uid=b;X(this.doc,d,a);this.Pj.scrollTop=2000000;this.userCnt++;this.ba.Jd(false)}}
;ja.prototype.ye=function(a){var b=this.hh(a);if(b!=null){var c=this.Ff;c.rows[b].deleteCell(0);c.deleteRow(b);this.userCnt--;this.ba.Jd(false)}}
;ja.prototype.hh=function(a){var b=this.Ff.rows;for(var c=0;c<b.length;c++){if(b[c].cells[0].uid==a){return c}}return null}
;ja.prototype.cleanup=function(){p.removeBuiltInListener(this.curIM,"keydown",this.Ra);p.removeBuiltInListener(this.curIM,"keyup",this.Qb)}
;
var Lb=null;var Kb=["","buttonLight.gif","top-grad.gif","buttonDownTri.gif","openDlgBack.png","spinWait.gif","closeX.gif","buttonLightPressed.gif"];var I={image:0,name:1,filemenu:2,save:3,newfile:5,openfile:6,email:7,feedback:8,help:9,logoff:10,comment:11,share:12,numsharers:13,lastsaved:15,offline:16,reload:17,myaccount:18};function Aa(a,b,c,d,e,f,g,h,i,j,l,k,n,o,r,s,w,C){this.p=d;var F=this.qh(c.offsetWidth);this.ub=f;var x=[];if(C==null)C="trixlogo.png";if(Lb==null){Kb[0]=C;Lb=Qb(e,Kb)}var Ba=
v(b,c,"",0,0,F,"");this.divMenus=Ba;Ba.id="goofMenus";var Y=da(b,Ba,"","");Y.id="id_topnav";var aa=Y.insertRow(0);var ba=0;var D=aa.insertCell(ba);D.style.width=1;D.innerHTML="<img src='"+e+C+"' id=id_logo>";ba++;var rb=aa.insertCell(ba);var Ca=rb.style;Ca.width=1;Ca.verticalAlign="bottom";Ca.paddingBottom=6;x[I.filemenu]=tb(b,rb,["File <img src='"+e+"buttonDownTri.gif'>"],e);ba++;D=aa.insertCell(ba);Ca=D.style;Ca.width=1;Ca.verticalAlign="bottom";Ca.paddingBottom=6;x[I.save]=tb(b,D,["Save"],e);ba++
;D=aa.insertCell(ba);var wa=ha(b,D,"#","New");wa.style.paddingLeft="4px";x[I.newfile]=wa;wa=ha(b,D,"#","Open");wa.style.paddingLeft="12px";x[I.openfile]=wa;ba++;D=aa.insertCell(ba);D.id="id_userinfo";var pc=V(b,D,tc(g),"");pc.style.fontWeight="bold";xa(b,D," | ");var Wa=ha(b,D,o,"Send feedback");Wa.target="_blank";xa(b,D," | ");Wa=ha(b,D,n,"Help");Wa.target="_blank";xa(b,D," | ");Wa=ha(b,D,k,"My Account");Wa.target="_blank";xa(b,D," | ");x[I.logoff]=ha(b,D,l,"Sign Out");Y=da(b,Ba,"docbar","");Y.style.backgroundImage=
"url("+e+"top-grad.gif)";aa=Y.insertRow(0);D=aa.insertCell(0);x[I.name]=V(b,D,"","name");xa(b,D,"  ");var wa="";if(j){wa="Autosaved at "+i}x[I.lastsaved]=V(b,D,wa,"small");x[I.offline]=V(b,D,"","small");x[I.reload]=V(b,D,"","small");D=aa.insertCell(1);D.style.textAlign="right";xa(b,D,"   ");x[I.numSharers]=V(b,D,"","imShowHideDisabled");xa(b,D," ");var Da=null;if(f){if(j){Da=ha(b,D,"#",cb)}else{Da=ha(b,D,"#","Share this spreadsheet")}Da.className="imShowHideLink"}x[I.share]=Da;xa(b,D," ");Da=ha(b,
D,"#","No One To Chat With");x[I.comment]=Da;Da.className="imShowHideLink";var Ka=64;Ba.style.height=Ka;var qc=this.lh(c.offsetHeight-Ka)+Ka;this.heiMenus=Ka;this.heiApp=qc-Ka;this.leftChat=F-280;this.ba=new B(a,d,c,h,f,j,e,x,rb,s,w,r,C,this);if(this.ba.Gh()){F-=280}this.S=v(b,c,"",0,Ka,F,this.heiApp);this.S.style.position="absolute"}
Aa.prototype.setConnectionParams=function(a,b){this.p.wl(a,b)}
;Aa.prototype.getDivApp=function(){return this.S}
;Aa.prototype.qh=function(a){return Math.max(a,this.p.MIN_APP_WIDTH+280)}
;Aa.prototype.lh=function(a){return Math.max(a,this.p.MIN_APP_HEIGHT)}
;Aa.prototype.resize=function(a,b){var c=this.ba.Gh();if(a==null){a=this.divMenus.offsetWidth-(c?280:0);if(!this.p.isIE)a-=2;b=this.heiApp}else{a=this.qh(a);b=this.lh(b-this.heiMenus);this.heiApp=b;this.divMenus.style.width=a;if(c)a-=280}this.leftChat=a;if(c)this.ba.mf();this.p.yi(a,b,true)}
;Aa.prototype.cleanup=function(){if(this.ba!=null){this.ba.cleanup()}this.p=null;this.ba=null}
;
var Ib="Oops, this file could not be imported.\nGoogle spreadsheets currently support XLS and CSV files.";var Jb="WARNING: Your changes have not been saved.";var cb="Show sharing options";
function na(a,b,c,d,e,f,g,h,i,j,l){this.ba=l;this.ub=j;this.visible=false;var k=v(a,c,"winChatShare",0,0,d,e);k.style.overflow="auto";k.style.overflowX="hidden";this.divMain=k;k.style.display="none";k.style.textAlign="center";V(a,k,"<p style='height:100'></p><p style='font-size:10pt'>Loading data...</p><img src='"+f+"spinWait.gif' />","");this.p=b;this.I=a;this.Se=f;this.H=g;this.uk=h;this.Dh=false;this.hi=null;this.ii=null;this.td=null;this.ud=null;this.ue=null;this.ve=null;this.Vc=0;this.Wc=0;this.Ik=
i}
na.prototype.Hf=function(a){var b="Shared with "+a;if(a==0||a==null||a==""){b=""}this.Ik.innerHTML=b}
;na.prototype.show=function(a,b){if(!a||!b){this.divMain.innerHTML="";return false}if(!this.Dh){this.divMain.innerHTML="";this.ok(a);this.vh();var c=W(this.H+"&fmcmd="+ea.getEV,"",false);var d=ra(eval(c.responseText));if(d!=null){this.ug(d)}}}
;na.prototype.vk=function(){var a=this.hi;var b=this.ii;var c=encodeURIComponent(a.value);var d=encodeURIComponent(b.value);if(c.length==0&&d.length==0){alert("Please type in the names of people you would like to invite.");return false}var e="edit="+c+"&view="+d;var f=W(this.H+"&fmcmd="+ea.addEV,e,false);var g=ra(eval(f.responseText));if(g!=null){this.vh();this.ug(g);var h="&to="+c;var i="&cc="+d;var j=this.uk+h+i;window.open(j,"Invite","toolbar=no,width=700,height=500,resizable=yes");a.value="";
b.value=""}}
;na.prototype.ug=function(a){var b=this.ue;var c=this.ve;var d=0;var e=0;for(var f=0;f<a.length;f++){if(a[f].t==0){this.og(b,a[f],d,true);d++}else{this.og(c,a[f],e,false);e++}}if(d>0){this.td.style.display=""}if(e>0){this.ud.style.display=""}this.Vc=d;this.Wc=e;this.Hf(d+e)}
;na.prototype.og=function(a,b,c,d){var e=null;if(a.rows.length<=c){e=K(a,null,"shareData")}else{e=a.rows[c].cells[0];e.style.display=""}e.innerHTML=b.u+" - ";var f=ha(this.I,e,"#","Remove");f.onclick=la(this,this.fl,b.i,e,d)}
;na.prototype.fl=function(a,b,c){var d=W(this.H+"&fmcmd="+ea.delEV,"tid="+encodeURIComponent(a),false);var e=ra(eval(d.responseText));if(e==true){b.style.display="none";if(c){this.Vc--;if(this.Vc<=0){this.td.style.display="none"}}else{this.Wc--;if(this.Wc<=0){this.ud.style.display="none"}}this.Hf(this.Vc+this.Wc)}}
;na.prototype.vh=function(){this.td.style.display="none";this.ud.style.display="none";var a=this.ue.rows;for(var b=0;b<a.length;b++){a[b].cells[0].style.display="none"}a=this.ve.rows;for(var b=0;b<a.length;b++){a[b].cells[0].style.display="none"}}
;na.prototype.ok=function(a){this.Dh=true;var b=this.I;var c=this.ba;var d=sb(b,this.divMain,this.Se+"closeX.gif","closeImg","right:15px;top:5px","Close");d.onclick=la(c,c.lb,false,false,false,true);var e=da(b,this.divMain,"imTable","");e.style.width="90%";e.align="center";var f=K(e,10);f=K(e,15,"imRegText");f.innerHTML="Invite people to <b>Edit</b>";f=K(e,55);this.hi=pa(b,f,"shareEditBox","","relative",0,0,"100%",55,1000,"textarea");f=K(e,15,"imSmallTxt");f.innerHTML="Separate email addresses with commas"
;f=K(e,10);f=K(e,15,"imRegText");f.innerHTML="Invite people to <b>View</b>";f=K(e,55);this.ii=pa(b,f,"shareEditBox","","relative",0,0,"100%",55,1000,"textarea");f=K(e,15,"imSmallTxt");f.innerHTML="Separate email addresses with commas";f=K(e,10);f=K(e,30);var g=tb(b,f,["Invite People"],this.Se);g.style.width="60px";g.onclick=L(this,this.vk);f=K(e,20);f=K(e,20,"imTitle");f.innerHTML="Editors";this.td=f;var h=da(b,K(e),"","");this.ue=h;f=K(e,10);f=K(e,20,"imTitle");f.innerHTML="Viewers";this.ud=f;h=
da(b,K(e),"","");this.ve=h;f=K(e,10)}
;
var ea={open:1,save:2,saveas:3,deleteKey:11,importFile:16,needsSaving:20,abandon:21,getEV:41,addEV:42,delEV:43};function B(a,b,c,d,e,f,g,h,i,j,l,k,n,o){b.gooffiLink=this;this.Ob=o;this.H=a;this.Hc="/ccc?";this.cd=d;this.ub=e;this.logo=g+n;this.p=b;this.I=b.x();this.pa=b.sb();this.la=f;this.sf=false;if(b.eb()){this.sf=true}this.Qa=h;this.Hb=c;this.xb=null;this.Ya=null;this.Tc=[["Save",,"Save",ea.save,0],,["New",,"New",0,0],["Open",,"Open",ea.open,0],["Save as...",,"Saveas",ea.saveas,0],,["Download as .xls"
,,"ExpXLS",4,0],["Download as .csv","Sheet Only","ExpCSV",5,0],["Get HTML","Sheet Only","Print",7,0],,["Upload new version",,"Replace",15,1],["Rename",,"Rename",9,1],["Delete",,"Delete",10,1],,["Close",,"Close",19,0]];this.Sc={save:0,replace:10,rename:11,deleteIt:12};this.wc=false;if(d.length==0){this.kb("Unsaved spreadsheet","");this.wc=true;this.la=false}else if(!this.la){this.kb(d,"Unsaved")}else{this.kb(d,null)}this.Od=new na(this.I,b,c,280,o.heiApp,g,a,l,h[I.numSharers],e,this);if(e){if(f){h[
I.share].onclick=la(this,this.lb,false,true,false,true)}else{h[I.share].onclick=L(this,this.Ll)}}this.Od.Hf(k);this.Ea=new ja(this.I,b,c,280,o.heiApp,this,g);this.Ea.Bk(j,this);if(this.la||!this.ub){this.Ae(false,true)}else{h[I.save].onclick=H(this,this.Gd,false)}h[I.newfile].onclick=H(this,this.bf,false);h[I.openfile].onclick=L(this,this.Oi);h[I.logoff].onclick=L(b,b.Sd);this.Vd=null;var r=h[I.filemenu];r.onclick=L(this,this.Kj);this.bm=i;this.Ni()}
B.prototype.Ll=function(){this.Gd(true);if(this.la){this.lb(false,true,false,true)}}
;B.prototype.Gh=function(){return this.Ea.visible||this.Od.visible}
;B.prototype.Jd=function(a,b){var c=this.Ea;var d=this.Qa[I.comment];var e=Math.max(0,c.userCnt-1);if(e==0){d.innerHTML="";return false}if(!a){if(c.visible){d.innerHTML="Hide chat";d.onclick=la(this,this.lb,true,false,true,true)}else{var f=e+" people";if(e==1){f=e+" person"}d.innerHTML="Chat with "+f;d.onclick=la(this,this.lb,true,true,true,true)}}var g=d.style;if(c.visible||b){g.fontWeight="normal"}else{g.backgroundColor="#f6c284";g.fontWeight="bold";window.setTimeout(function(){g.backgroundColor=
""}
,200)}}
;B.prototype.lb=function(a,b,c,d){var e=this.ub;var f=this.Ea;var g=this.Od;var h=f.divMain.style;var i=g.divMain.style;var j=this.Qa[I.share];if(!this.p.isIE){this.Ob.leftChat=0}this.mf(h);this.mf(i);if(a&&b){if(e)j.innerHTML=cb;i.display="none";g.visible=false;h.display="";f.visible=true;if(a&&c==true){f.curIM.focus()}if(u.os==2){h.display="none";window.setTimeout(function(){h.display=""}
,0)}}else if(!a){if(g.visible){b=false}else{if(e)j.innerHTML="Hide sharing options";i.display="";g.visible=true;h.display="none";f.visible=false;g.show(this.ub,this.la);if(u.os==2){i.display="none";window.setTimeout(function(){i.display=""}
,0)}}}if(!b){if(e)j.innerHTML=cb;i.display="none";g.visible=false;h.display="none";f.visible=false;this.p.A(true)}if(d==true){this.Ob.resize()}this.Jd(false,true)}
;B.prototype.mf=function(a){if(a==null){if(this.Ea.visible){a=this.Ea.divMain.style;this.Ea.nl()}else{a=this.Od.divMain.style}}var b=this.Ob;a.left=b.leftChat;a.top=b.heiMenus;a.height=b.heiApp+(this.p.isIE?0:2)}
;B.prototype.Gj=function(a){var b=W(this.H+"&fmcmd="+ea.deleteKey+"&key="+a,"",false);var c=ra(eval(b.responseText));if(c!=null){return true}return false}
;B.prototype.Ae=function(a,b){if(a){var c=this.xb;if(c!=null){c.enable(c.xa()[this.Sc.save],0,false);c.y(0,"Automatically Saved")}}if(b){var d=this.Qa[I.save];d.onclick=null;d.style.color="#b0b0b0";d.onmousedown="";d.title="This spreadsheet is automatically saved as you work.";d.innerHTML="Saved"}}
;B.prototype.Kj=function(){if(!this.sd())return false;var a=this.xb;if(a==null){var a=new ca(this.p.x(),this.Hb,this.Tc,true);var b=a.xa();var c=this.Tc;var d;var e=this.la&&this.ub;for(var f=0;f<c.length;f++){if(c[f]!=null){d=b[f];if(c[f][4]==0||e){d.onclick=H(this,this.Ph,c[f])}else{a.enable(d,f,false)}}}this.xb=a}if(this.la||!this.ub){this.Ae(true,false)}if(a.isVisible){this.s()}else{this.p.s();var g=this.bm;a.ua("",g.offsetLeft,g.offsetTop+g.offsetHeight-1)}this.p.A(false,true)}
;B.prototype.Ph=function(a){var b=this.p;if(a[2]=="New"){this.bf(false)}else if(a[2]=="Open"){this.Oi()}else if(a[2]=="Save"){this.Gd(false)}else if(a[2]=="Saveas"){this.Gd(true)}else if(a[2]=="Print"){b.Yk()}else{var c=this.H+"&fmcmd="+a[3];if(a[2]=="ExpXLS"){this.Sg(c)}else if(a[2]=="ExpCSV"){this.Sg(c+"&gid="+this.Zj())}else if(a[2]=="Replace"){this.jl(c)}else if(a[2]=="Rename"){this.il(c)}else if(a[2]=="Delete"){this.Ij(c)}else if(a[2]=="Close"){this.xj()}}this.s()}
;B.prototype.xj=function(){if(this.Ng()){if(!confirm(Jb)){return false}}this.bf(true)}
;B.prototype.bf=function(a){if(!this.sd())return false;this.vb(this.Hc+"new=true",a)}
;B.prototype.Ij=function(a){if(!confirm("Are you sure you want to delete '"+this.cd+"'?\n\nWarning: This action cannot be undone.")){return false}var b=W(a,"",false);var c=ra(eval(b.responseText));if(c!=null){this.vb(this.Hc+"new=true",true)}}
;B.prototype.Xk=function(a){this.Ya.screen.hide();this.vb(this.Hc+"key="+a,this.wc)}
;B.prototype.jl=function(a){var b=this.Vd;if(b==null){b=new Ta(this.p,this.Ob.getDivApp(),a,this);this.Vd=b}b.ml();b.Ca(0);b.screen.show()}
;B.prototype.il=function(a){if(!this.la){alert("Oops, try saving your file first before renaming it.");return false}var b=prompt("Rename spreadsheet as:",this.cd);if(!b){return false}var c=W(a+"&name="+encodeURIComponent(b),"",false);var d=ra(eval(c.responseText));if(d!=null){this.kb(b,null)}}
;B.prototype.Hl=function(){this.Qa[I.offline].innerHTML="&nbsp;- <font style='color:#c00000;padding-right:10'>Offline</font>";var a=this.Qa[I.reload];a.innerHTML="<a href='#'>Reload spreadsheet</a>";var b=this.p;a.onclick=L(b,b.Vl)}
;B.prototype.kb=function(a,b){if(a!=null){this.cd=a;X(this.I,this.Qa[I.name],a);document.title=a+" - Google Spreadsheets"+(this.sf?" (view only)":"")}if(this.p.eb()){b="View only"}if(b!=null){this.Qa[I.lastsaved].innerHTML=b}}
;B.prototype.vb=function(a,b){if(b){this.hf(true);if(a==null){this.I.location.reload(true)}else{this.I.location.href=a}}else{Sb(a,true)}}
;B.prototype.Oi=function(){if(!this.sd())return false;this.p.s();var a=this.Ya;if(a==null){a=new Ga(this.p,this.Ob.getDivApp(),this);a.uploadObject.Ji(this,this.H+"&fmcmd="+ea.importFile,this.ff,this.zc);this.Ya=a}a.uploadObject.jf();a.Ca(0);a.Ml();var b=W(this.H+"&fmcmd="+ea.open,"",true);b.onreadystatechange=H(this,this.Tl,b)}
;B.prototype.ff=function(){var a=this.Ya;var b=a.uploadObject;if(b.initFileUpload){var c=ra(b.iFrame.contentWindow.document.body.innerHTML);if(c!=null){a.impDoneLink.onclick=la(this,this.Ch,c,a,this.wc);a.Ca(2)}else{a.Ca(0)}b.initFileUpload=false}}
;B.prototype.zc=function(a,b){if(a){this.Ya.Ca(1)}else{alert(Ib)}}
;B.prototype.Ch=function(a,b,c){b.Ca(0);b.screen.hide();if(this.Ya==b){if(a==null){this.vb(null,true)}else{this.vb(this.Hc+"key="+a,c)}}}
;B.prototype.Tl=function(a){if(a.readyState==4){var b=eval(a.responseText);this.Ya.show(b)}}
;B.prototype.Gd=function(a){if(!this.sd())return false;var b=this.H;var c=prompt("Save spreadsheet as:",this.cd);if(c){var d=encodeURIComponent(c);if(this.la){b+="&fmcmd="+ea.saveas+"&name="+d}else{b+="&fmcmd="+ea.save+"&name="+d}}else{return false}var e=this.I.body.style;e.cursor="wait";var f=W(b,"",false);e.cursor="auto";var g=ra(f.responseText);if(g!=null){if(a&&this.la){this.hf(true);this.I.location.href=this.Hc+"key="+g}else{this.kb(c,"Autosaved at "+g);this.Sj();this.la=true;this.Rj()}}}
;B.prototype.Rj=function(){this.Ae(true,true);this.Ge(this.Sc.replace);this.Ge(this.Sc.rename);this.Ge(this.Sc.deleteIt)}
;B.prototype.Ge=function(a){var b=this.xb;if(b!=null){var c=b.xa()[a];b.enable(c,a,true);c.onclick=H(this,this.Ph,this.Tc[a])}}
;B.prototype.Sj=function(){if(!this.la){var a=this.Qa[I.share];a.innerHTML=cb;a.onclick=la(this,this.lb,false,true,false,true)}}
;B.prototype.Sg=function(a){this.hf(false);this.pa.open(a);this.Ni()}
;B.prototype.hf=function(a){if(a){this.ie()}this.pa.onbeforeunload=null;this.pa.onunload=null}
;B.prototype.Ni=function(){this.pa.onbeforeunload=L(this,this.em)}
;B.prototype.em=function(){if(this.Ng()){this.pa.onunload=L(this,this.ie);return Jb}else{this.ie()}}
;B.prototype.Ng=function(){return!this.wc&&!this.la}
;B.prototype.ie=function(){this.p.Sd();var a=this.H+"&fmcmd="+ea.abandon;W(a,"",false)}
;B.prototype.Jk=function(a,b){if(a!=null){this.wc=false;for(var c=0;c<a.length;c++){if(a[c].g==null){var d=a[c].t;var e=this.Ea;switch(d){case q.Pc:e.Pc(a[c].tu,a[c].ts);break;case q.ye:e.ye(a[c].ts);break;case q.newIM:e.rg(a[c].v);break;case q.errorReload:qa(this,this.vb,50,null,true);break;case q.renameDoc:this.kb(a[c].v,null);break;case q.lastSaved:this.kb(null,"Autosaved at "+a[c].v);break;default:break}}}}}
;B.prototype.Dl=function(a){this.sf=a;this.kb(null,"View only")}
;B.prototype.s=function(){if(this.xb!=null){this.xb.ua("none")}}
;B.prototype.sd=function(){return this.p.X()}
;B.prototype.Zj=function(){return this.p.activeGrid.id}
;B.prototype.el=function(){this.vb(null,true)}
;B.prototype.cleanup=function(){if(this.Ya!=null){this.Ya.cleanup()}if(this.Vd!=null){this.Vd.cleanup()}if(this.p!=null){this.p.cleanup()}if(this.Hb!=null){this.Hb.innerHTML=""}this.Ea.cleanup();this.Ea=null;this.Ob=null;this.p=null;this.Hb=null;this.pa=null;this.I=null;this.Qa=null;this.xb=null;this.Tc=null}
;
function Ga(a,b,c){var d=a.x();this.I=d;this.pd=a.pathImg;this.Pe=c;var e=594;var f=394;var g=new T(a,b,true,e,f,"dlgOpen","Cancel");this.screen=g;g.wd(e,f,this.pd+"openDlgBack.png");var h=g.divBar;h.style.height=65;h.innerHTML="<div class='dlgLogo'><img src='"+c.logo+"'/></div><div>Open a spreadsheet</div>";var i=v(d,g.divMain,"dlgOpenContent",20,80,"","");i.innerHTML="<b>Choose a spreadsheet you have previously opened:</b><table class='dlgOpenHead' cellpadding=0 cellspacing=0><tr><td class='dlgOpenColName'><a>Name</a></td><td class='dlgOpenColOwn'><a>Owner</a></td><td class='dlgOpenColDate'><a>Date viewed</a></td></tr></table>"
;var j=v(d,i,"",0,0,"","");this.Kf=v(d,j,"dlgOpenData",0,0,"","");this.Kf.innerHTML="<div class='loadingMsg'>Loading spreadsheets...&nbsp; <img src='"+this.pd+"spinWait.gif' width=16 height=16 /></div>";this.we=v(d,j,"dlgOpenData",0,0,"","");this.we.style.display="none";var l=v(d,i,"",0,0,"","");var k=v(d,l,"dlgOpenImport1",0,0,"","");k.innerHTML="<b>Or upload a file from your computer: </b><span class='dlgOpenImport2'>(supports .xls, .csv)</span>";var i=d.createElement("div");i.style.paddingTop=
6;k.appendChild(i);var n=da(d,i,"","");var o=n.insertRow(0);var r=o.insertCell(0);var s=o.insertCell(1);this.Ef=V(d,s,"&nbsp;&nbsp;<img src='"+this.pd+"spinWait.gif' />","");this.Rd=V(d,s,"&nbsp;&nbsp;File imported successfully.  ","");this.impDoneLink=ha(d,this.Rd,"#","");this.impDoneLink.innerHTML="<b>Open now &raquo;</b>";this.Ca(0);this.uploadObject=new La(d,r,"importFromOpen");this.oi=null;g.focusElem=null}
Ga.prototype.Ca=function(a){var b=this.Ef.style;var c=this.Rd.style;if(a==0){b.display="none";c.display="none"}else if(a==1){b.display="";c.display="none"}else if(a==2){b.display="none";c.display=""}}
;Ga.prototype.Ml=function(){this.we.style.display="none";this.Kf.style.display="";if(!this.screen.visible){this.screen.show()}}
;Ga.prototype.show=function(a){var b=this.we;if(a.length==0){b.innerHTML="You haven't saved any spreadsheets yet.<br/>You can import a new spreadsheet or cancel and create a new one."}else{b.innerHTML="";var c=da(this.I,b,"dlgFileList","");this.oi=c;var d,e;var f=a;var g="<img title='Remove from your list' class='dlgOpenImgX' src='"+this.pd+"closeX.gif'>";for(var h=0;h<f.length;h++){d=c.insertRow(h);if(h%2>0){d.className="dlgOpenDataEvenRow"}e=this.mc(d,0,"dlgOpenColNameVal",f[h].n,true);e.onclick=
H(this.Pe,this.Pe.Xk,f[h].k);this.mc(d,1,"dlgOpenColOwn",f[h].o);this.mc(d,2,"dlgOpenColDate",f[h].l);e=this.mc(d,3,"dlgOpenColRemove","&nbsp;");if(f[h].me==false){e.innerHTML=g;e.childNodes[0].onclick=la(this,this.Hj,f[h].n,f[h].k,d)}this.mc(d,4,"dlgOpenColLast","&nbsp;")}}if(!this.screen.visible){this.screen.show()}this.Kf.style.display="none";b.style.display=""}
;Ga.prototype.Hj=function(a,b,c){if(!confirm("Are you sure you want to remove '"+a+"' from this list?\nThe spreadsheet will be added back to this list the next time you click on a link to it.")){return false}if(this.Pe.Gj(b)){var d=this.oi;var e=d.rows;eb(d,c,c.rowIndex);for(var f=0;f<e.length;f++){if(f%2>0){e[f].className="dlgOpenDataEvenRow"}else{e[f].className=""}}}}
;Ga.prototype.mc=function(a,b,c,d,e){var f=a.insertCell(b);f.className=c;if(e==true){X(this.I,f,d)}else{f.innerHTML=d}return f}
;Ga.prototype.cleanup=function(){this.screen.cleanup();if(this.uploadObject!=null){this.uploadObject.cleanup()}}
;
function Ta(a,b,c,d){var e=416;var f=202;var g=a.x();this.ba=d;var h=new T(a,b,true,e,f,"dlgAlert","Close");h.wd(e,f,a.pathImg+"smallDlgBack.png");this.screen=h;var i=h.divMain;var j=v(g,i,"dlgContentOut",20,50,376,100);var l=v(g,j,"dlgUploadIn",0,0,"","");h.divBar.innerHTML="Upload new version";l.innerHTML="You can upload a new .xls file to replace the contents of this spreadsheet.  Please note: you will lose your current content.";var k=V(g,j,"","");this.If=new La(g,k,"importAndReplace");this.If.Ji(
this,c,this.ff,this.zc);this.Ef=V(g,j,"Importing file...<img src='"+a.pathImg+"spinWait.gif' />","dlgUploadIn");this.Rd=V(g,j,"File imported successfully.","dlgUploadIn");var n=Ma(g,i,null,152,"","","dlgButtUpload","Cancel",L(h,h.hide));n.style.right=20;this.tj=n;h.focusElem=n;this.le=Ma(g,i,null,152,"","","dlgButtUpload","Replace Spreadsheet",null);this.le.style.right=25+n.offsetWidth;this.Ca(0)}
Ta.prototype.ml=function(){this.If.jf()}
;Ta.prototype.ff=function(){var a=this.If;if(a.initFileUpload){var b=ra(a.iFrame.contentWindow.document.body.innerHTML);if(b!=null){this.le.onclick=la(this.ba,this.ba.Ch,null,this,true)}else{this.Ca(0)}a.initFileUpload=false}}
;Ta.prototype.zc=function(a,b){if(a){this.Ca(1)}else{alert(Ib)}}
;Ta.prototype.Ca=function(a){var b=this.Ef.style;var c=this.Rd.style;var d=this.le.style;var e=this.tj.style;if(a==0){b.display="none";c.display="none";d.display="none";e.display=""}else if(a==1){b.display="";c.display="none";d.display="none";e.display="none"}else if(a==2){b.display="none";c.display="";d.display="";e.display=""}}
;Ta.prototype.cleanup=function(){this.screen.cleanup()}
;
function G(a){this.b=a;this.J=u.type==1;var b=this.b.x();var c=this.b.divGrids;this.Vj=pa(b,c,"","z-index:5;","absolute",-1000,-1000,"0px","0px",1,"text");this.ia=null;this.G=null;this.Jg(true);this.Ie=pa(b,c,"","z-index:5;","absolute",-1000,-1000,"0px","0px",3,"text");this.Vj.onfocus=L(this,this.A);this.Ie.onfocus=L(this,this.A);this.oc=sa(b,c,"formulaAddressLocator",0,0,"","","P");this.oc.style.visibility="hidden";this.Na=b.createElement("table");var d=this.Na.insertRow(0);this.Wg=d.insertCell(
0);c.appendChild(this.Na);this.Na.className="editBoxResizerTable";var e=this.Na.style;e.width="";e.left="-1000px";e.top="-1000px";this.wf=null;this.xd=null;this.Oh=null;this.Ue=null;this.Ra=null;this.Qb=null;this.keyCodUp=null;this.isEditBoxActive=false;this.F2OrMouse=false;this.He=1;this.We=null}
G.prototype.Jg=function(a){if(a||!this.J){var b=this.b.x();var c=this.b.divGrids;if(this.J){this.G=pa(b,c,"editBoxIE","z-index:5","absolute",-1000,-1000,"0px","0px",2,"textarea");this.ia=this.G}else{if(this.ia==null){this.ia=v(b,c,"editBoxWrapper",-1000,-1000,"0px","0px",this.Ie);this.ia.style.zIndex=5;this.G=pa(b,this.ia,"editBoxFF","","absolute",0,0,"100%","97%",2,"textarea")}else{var d=c.removeChild(this.ia);c.insertBefore(d,this.Ie)}}}}
;G.prototype.sl=function(){if(!this.J){this.Ue=p.createAdapter(this,this.Lk);p.addBuiltInListener(this.G,"keypress",this.Ue)}this.Ra=p.createAdapter(this,this.xc);p.addBuiltInListener(this.G,"keydown",this.Ra);this.Qb=p.createAdapter(this,this.cf);p.addBuiltInListener(this.G,"keyup",this.Qb)}
;G.prototype.cf=function(a){this.Xb();if(!this.isEditBoxActive){if(this.keyCodUp==86){this.b.paste(false);this.keyCodUp=null}else{this.b.copyPaste.Zc(this.b.activeGrid)}}}
;G.prototype.Lk=function(a){if(a.ctrlKey&&(a.which==98||a.which==66||a.which==105||a.which==73)){N(a)}else{this.ji(a,true,a.keyCode)}}
;G.prototype.xc=function(a){var b=a.keyCode?a.keyCode:(a.which?a.which:a.charCode);if(b==16||b==17){}else{this.keyCodUp=null;this.ji(a,false,b)}}
;G.prototype.ji=function(a,b,c){var d=this.b;if(d.activeFormuGrid!=null){d.activeFormuGrid.ya(3)}if(d.modalDbox==null){if(a.altKey){if(!b){switch(c){case 13:break;default:break}}}else{var e=d.activeGrid;var f=false;if(b||this.J){switch(c){case 37:if(!this.F2OrMouse&&!this.rc()){if(this.fa(true)){this.Qi(a.ctrlKey,a.shiftKey,false)}}break;case 38:if(!this.F2OrMouse){if(this.fa(true)){this.Cf(a.ctrlKey,a.shiftKey,false)}}break;case 39:if(!this.F2OrMouse&&!this.rc()){if(this.fa(true)){this.Ri(a.ctrlKey,
a.shiftKey,false,true)}}break;case 40:if(!this.F2OrMouse){if(this.fa(true)){this.Bf(a.ctrlKey,a.shiftKey,false)}}break;case 13:var g=true;if(!a.ctrlKey&&!this.isEditBoxActive&&!e.yg()&&d.mode<=0){this.La(true);this.F2OrMouse=true;g=false;N(a)}if(g){if(this.fa(true)){if(a.ctrlKey){e.hyperlink()}else{var h=e.wa();if(e.rowsSelected>1||e.colsSelected>ta(h,e)){if(this.He==1){this.Yl(a.shiftKey)}this.He=1}else{if(a.shiftKey){this.Cf(a.ctrlKey,false,false)}else{this.Bf(a.ctrlKey,false,false)}}}}}break;case 9:
if(this.fa(true)){var h=e.wa();if(e.rowsSelected>1||e.colsSelected>ta(h,e)){this.Zl(a.shiftKey)}else{if(a.shiftKey){this.Qi(a.ctrlKey,false,false)}else{this.Ri(a.ctrlKey,false,false,false)}}}break;case 33:if(this.fa(true)){if(a.ctrlKey){d.activate(Math.max(0,e.index-1),true,false,false)}else{this.Cf(a.ctrlKey,a.shiftKey,true)}}break;case 34:if(this.fa(true)){if(a.ctrlKey){d.activate(Math.min(d.kh().T()-1,e.index+1),true,false,false)}else{this.Bf(a.ctrlKey,a.shiftKey,true)}}break;default:f=true;break}
}if(!b||f&&this.J){switch(c){case 27:this.fa(false);d.s();break;case 35:if(a.ctrlKey&&!this.F2OrMouse){this.Ek()}break;case 36:if(a.ctrlKey&&!this.F2OrMouse){this.Fk()}break;case 113:if(!a.ctrlKey&&!this.isEditBoxActive){this.La(true);this.F2OrMouse=true}break;case 8:if(!this.isEditBoxActive&&d.mode<=0){e.ze();N(a)}case 46:if(!a.ctrlKey&&!this.isEditBoxActive){if(d.mode<=0){e.ze()}}break;case 32:if(!this.isEditBoxActive){if(a.shiftKey&&a.ctrlKey){this.Fi()}else if(a.shiftKey){this.vf()}else if(a.ctrlKey)
{this.tf()}else{this.La(false)}}break;default:if(!this.isEditBoxActive){if(a.ctrlKey){if(d.mode<=0){if(c==66){d.Rc("bold");N(a)}else if(c==73){d.Rc("italic");N(a)}else if(c==67){d.copy(q.pasteAll,false)}else if(c==88){d.copy(q.pasteCut,false)}else if(c==86){this.keyCodUp=c}else if(c==90){d.Hd(q.undo)}else if(c==89){d.Hd(q.redo)}else if(c==68){var i=d.copyPaste;i.copy(q.pasteAll,1);i.paste();N(a)}else if(c==82){var i=d.copyPaste;i.copy(q.pasteAll,2);i.paste();N(a)}else if(c==85){d.Rc("underline");
N(a)}}}else{if(this.J){if(c>=48&&c<=57||c>=65&&c<=90||c>=96&&c<=111||c>=186&&c<=192||c>=219&&c<=222){this.La(false)}}else{if(c>=48&&c<=57||c>=65&&c<=90||c==59||c==61||c>=96&&c<=111||c>=186&&c<=192||c>=219&&c<=222){this.La(false)}}}}break}}}}}
;G.prototype.fd=function(a,b,c,d,e){var f=b.e(c);while(c<=e){if(a.O(f,f.cells[d])){c++;f=b.e(c)}else{return c}}return-1}
;G.prototype.jd=function(a,b,c,d){var e=b.e(c);while(c>0){if(a.O(e,e.cells[d])){c--;e=b.e(c)}else{return c}}return-1}
;G.prototype.hd=function(a,b,c,d,e){var f=b.e(c);var g=f.cells;var h=g[d];while(d<=e){if(a.O(null,h)){d++;h=g[d]}else{return d}}return-1}
;G.prototype.gd=function(a,b,c,d){var e=b.e(c);var f=e.cells;var g=f[d];while(d>0){if(a.O(null,g)){d--;g=f[d]}else{return d}}return-1}
;G.prototype.Tg=function(a,b,c,d){var e=a.topLeftCol+a.colsSelected-1;if(a.topLeftCol!=a.activeCol){e=a.topLeftCol}var f=1;if(d==1){f=-1}var g=e+f;var h=false;var i=b.e(c);var j=i.cells;var l=j[e];var k=ib(l);while(f==1?e<d:e>1){e+=f;l=j[e];if(!a.O(null,l)){if(ib(l)){if(!k){k=true;if(h&&g!=e){return e-f}}}else{if(k){return e}}h=true}}return d}
;G.prototype.Ug=function(a,b,c,d){var e=a.topLeftRow+a.rowsSelected-1;if(a.topLeftRow!=a.activeRow){e=a.topLeftRow}var f=1;if(d==1){f=-1}var g=e+f;var h=false;var i=b.e(e);var j=i.cells[c];var l=ib(j);while(f==1?e<d:e>1){e+=f;i=b.e(e);j=i.cells[c];if(!a.O(null,j)){if(ib(j)){if(!l){l=true;if(h&&g!=e){return e-f}}}else{if(l){return e}}h=true}}return d}
;G.prototype.Bf=function(a,b,c){var d=this.b.activeGrid;var e=d.j();var f=d.topLeftCol;var g=d.numRows;if(a){var h=this.Ug(d,e,f,g);this.Qd(d,b,h,f)}else{var h=d.activeRow+1;if(c){var i=d.mainGridHei;for(var j=h-1;j<g&&i>0;j++){i-=e.e(j).offsetHeight}h=j}if(b){if(d.topLeftRow<d.activeRow){h=d.topLeftRow+1}else{h+=d.rowsSelected-1}}if(h<=g){h=this.fd(d,e,h,f,g);if(h>-1){this.Qd(d,b,h,f)}}}}
;G.prototype.Cf=function(a,b,c){var d=this.b;var e=d.activeGrid;var f=e.j();var g=e.topLeftCol;if(a){var h=this.Ug(e,f,g,1);this.Qd(e,b,h,g)}else{var h=e.activeRow-1;if(c){var i=e.mainGridHei;for(var j=h+1;j>1&&i>0;j--){i-=f.e(j).offsetHeight}h=j;if(h<=e.freezeRow){d.mouseSelection.Ei(e)}}if(b){if(e.topLeftRow<e.activeRow){h=e.topLeftRow-1}else{h+=e.rowsSelected-1}}if(h>0){h=this.jd(e,f,h,g);if(h>-1){this.Qd(e,b,h,g)}}}}
;G.prototype.Qd=function(a,b,c,d){if(b){a.da(a.activeRow,d,c,d+a.colsSelected-1,true)}else{a.F(c,a.activeCol,true)}a.ma(c,d+a.colsSelected-1)}
;G.prototype.Ri=function(a,b,c,d){var e=this.b.activeGrid;var f=e.j();var g=e.topLeftRow;var h=e.numCols;if(a&&d){var i=this.Tg(e,f,g,h);this.Pd(e,b,g,i)}else{var i=e.activeCol+1;if(b){if(e.topLeftCol<e.activeCol){i=e.topLeftCol+1}else{i+=e.colsSelected-1}}if(i<=h){i=this.hd(e,f,g,i,h);if(i>-1){this.Pd(e,b,g,i)}}}}
;G.prototype.Qi=function(a,b,c){var d=this.b.activeGrid;var e=d.j();var f=d.topLeftRow;if(a){var g=this.Tg(d,e,f,1);this.Pd(d,b,f,g)}else{var g=d.activeCol-1;if(b){if(d.topLeftCol<d.activeCol){g=d.topLeftCol-1}else{g+=d.colsSelected-1}}if(g>0){g=this.gd(d,e,f,g);if(g>-1){this.Pd(d,b,f,g)}}}}
;G.prototype.Pd=function(a,b,c,d){if(b){a.da(c,a.activeCol,c+a.rowsSelected-1,d,true)}else{a.F(a.activeRow,d,true)}a.ma(c+a.rowsSelected-1,d)}
;G.prototype.Yl=function(a){var b=this.b.activeGrid;var c=b.j();var d=b.topLeftRow;var e=b.topLeftCol;var f=b.activeRow;var g=b.activeCol;var h=d+b.rowsSelected-1;var i=e+b.colsSelected-1;if(a){if(d==f){if(e==g){b.F(h,i,false)}else{var j=this.gd(b,c,h,g-1);b.F(h,j,false)}}else{var l=this.jd(b,c,f-1,g);b.F(l,g,false)}}else{if(h==f){if(i==g){b.F(d,e,false)}else{var j=this.hd(b,c,d,g+1,i);b.F(d,j,false)}}else{var l=this.fd(b,c,f+1,g,h);b.F(l,g,false)}}b.ma(b.activeRow,b.activeCol)}
;G.prototype.Zl=function(a){var b=this.b.activeGrid;var c=b.j();var d=b.topLeftRow;var e=b.topLeftCol;var f=b.activeRow;var g=b.activeCol;var h=d+b.rowsSelected-1;var i=e+b.colsSelected-1;if(a){if(e==g){if(d==f){b.F(h,i,false)}else{var j=this.jd(b,c,f-1,i);b.F(j,i,false)}}else{var l=this.gd(b,c,f,g-1);b.F(f,l,false)}}else{if(i==g){if(h==f){b.F(d,e,false)}else{var j=this.fd(b,c,f+1,e,h);b.F(j,e,false)}}else{var l=this.hd(b,c,f,g+1,i);b.F(f,l,false)}}b.ma(b.activeRow,b.activeCol)}
;G.prototype.vf=function(){var a=this.b.activeGrid;var b=a.j();var c=a.topLeftRow;var d=a.numCols;var e=this.hd(a,b,c,1,d);var f=this.gd(a,b,c,d);a.da(c,e,c+a.rowsSelected-1,f);a.F(c,e,false);a.ma(c,e)}
;G.prototype.tf=function(){var a=this.b.activeGrid;var b=a.j();var c=a.topLeftCol;var d=a.numRows;var e=this.fd(a,b,1,c,d);var f=this.jd(a,b,d,c);a.da(e,c,f,c+a.colsSelected-1);a.F(e,c,false);a.ma(e,c)}
;G.prototype.Fi=function(){var a=this.b.activeGrid;if(a.wa()==null){a.Gi()}this.vf();this.tf()}
;G.prototype.Fk=function(){var a=this.b.activeGrid;a.Gi();a.ma(a.activeRow,a.activeCol)}
;G.prototype.Ek=function(){var a=this.b.activeGrid;a.pl();a.ma(a.activeRow,a.activeCol)}
;G.prototype.A=function(a,b){if(a==true){this.G.disabled=false}if(!this.G.disabled){if(b!==true){this.b.s()}this.G.focus()}}
;G.prototype.Mb=function(){return this.G}
;G.prototype.rc=function(){var a=this.G.value.charAt(0);return this.isEditBoxActive&&(a=="+"||a=="=")}
;G.prototype.Dc=function(a){var b=this.oc.style;var c=this.ia.offsetTop-18;var d=this.ia.offsetLeft;if(!this.J){c-=10;d++}b.top=c;b.left=d;b.visibility="visible";var e=this.b.activeGrid;var f=e.activeRow;var g=e.activeCol;if(a==true){f=e.info.idsTOrows[e.activeRowID];g=e.info.idsTOcols[e.activeColID]}var h=this.oc;if(f==null||g==null){h.innerHTML="Deleted Cell!!"}else{h.innerHTML=P(g)+f}}
;G.prototype.im=function(a){var b=a.charAt(a.length-1);if(b.match(/[\+\-\/\*\^(=]/)!=null){this.G.disabled=true;this.b.Y(Tb);return false}var c=false;var d=0;for(var e=0;e<a.length;e++){b=a.charAt(e);if(b=='"'){c=!c}else if(!c){if(b=="("){d++}else if(b==")"){d--}}}if(c){this.G.disabled=true;this.b.Y("Make sure your formula has matching quotes.");return false}else if(d<0){this.G.disabled=true;this.b.Y(Tb);return false}else if(d>0){for(var e=0;e<d;e++){this.G.value+=")"}}return true}
;G.prototype.fa=function(a){var b=this.b;if(b.activeFormuGrid!=null){b.activeFormuGrid.ya(3)}var c=true;var d=this.G;var e=d.value;var f=this.We!=e;this.We=null;if(this.isEditBoxActive&&a){if(e.indexOf("+")==0){e="="+e.substring(1);d.value=e}if(e.indexOf("=")==0){c=this.im(e);e=d.value}}if(c){var g=b.activeGrid;if(b.activeFormuGrid!=null){b.activeFormuGrid=null;b.activate(g.index,true,true,false,null,true)}if(this.isEditBoxActive){if(a&&f){var h=g;var i=h.info;var j=h.activeRowID;var l=h.activeColID;
var k=i.idsTOrows[j];var n=i.idsTOcols[l];var o=null;if(k==null||n==null){b.Y("The cell you are trying to access may have been deleted.")}else{o=h.j().e(k).cells[n]}if(o!=null){X(null,o,e);if(o.innerHTML.indexOf("=")!=0){i.pe(k,n)}h.rowHObj.xg(k,o.parentNode);h.Za();h.ql(o,j,l)}h.activeRowID=null;h.activeColID=null}var r=this.ia.style;r.left=-100;r.top=-100;r.width=0;r.height=0;this.oc.innerHTML="";this.oc.style.visibility="hidden"}d.focus();d.value="";X(b.x(),this.Wg,"");this.Na.style.width="";this.isEditBoxActive=
false;this.F2OrMouse=false}return c}
;G.prototype.La=function(a,b){var c=this.b;c.s();c.iconManager.od();if(b!=null){this.He=b}if(c.mode<=0){var d=c.activeGrid;var e=d.wa();if(e!=null){d.ma(d.activeRow,d.activeCol);var f=this.ia.style;var g=d.gh(e);f.left=g[0];f.top=g[1];var h=this.G;var i=d.info;var j=d.activeRow;var l=d.activeCol;d.activeRowID=d.info.rowsTOids[j];d.activeColID=d.info.colsTOids[l];if(a){var k=i.jh(j,l);if(k==null){var n=i.eh(j,l);if(n==null){h.value=Ia(e)}else{h.value=n}}else{h.value="="+k}var o=h.value.length;if(o>
0){if(this.J){h.select();var r=c.doc.selection.createRange();r.moveStart("character",o);r.select()}else{h.setSelectionRange(o,o)}}else if(this.J){h.select()}}else{h.value=""}this.We=h.value;var s=U(e,"fontSize","font-size");if(s.indexOf("%")>0){s=parseFloat(s)*parseFloat(U(e.offsetParent,"fontSize","font-size"))/100+"pt"}f=this.G.style;f.fontSize=s;f.fontFamily=U(e,"fontFamily","font-family");f.fontWeight=U(e,"fontWeight","font-weight");f.fontStyle=U(e,"fontStyle","font-style");var w=this.Na.style;
w.fontSize=s;w.fontFamily=f.fontFamily;w.fontWeight=f.fontWeight;w.fontStyle=f.fontStyle;w.width="";this.wf=e;this.xd=c.divGrids.offsetWidth-this.ia.offsetLeft-5;this.Oh=c.divGrids.offsetHeight-this.ia.offsetTop-5;this.isEditBoxActive=true;this.Xb()}}else{this.F2OrMouse=false;this.A()}}
;G.prototype.Xb=function(){if(this.isEditBoxActive){X(this.b.x(),this.Wg,this.G.value+" ===");var a=this.ia.style;var b=Math.max(30,this.wf.offsetWidth,this.Na.offsetWidth);if(b>this.xd){a.width=this.xd;this.Na.style.width=this.xd}else{a.width=b+3}var c=Math.min(Math.max(30,this.wf.offsetHeight+4,this.Na.offsetHeight),this.Oh);if(u.os==2){c+=2}a.height=c}}
;G.prototype.cleanup=function(){if(!this.J){p.removeBuiltInListener(this.G,"keypress",this.Ue)}p.removeBuiltInListener(this.G,"keydown",this.Ra);p.removeBuiltInListener(this.G,"keyup",this.Qb)}
;
function R(a,b){this.w=a;this.ga=v(a.trixApp.x(),b,"divColHead",35,0,a.mainGridWid,20);this.ga.style.cursor="default";this.divActiveCellInH=null;this.divSelectionInH=null;this.divFormulasInH=null;this.tblMain=null;this.q=null;this.zh="colHead_"+a.id;this.uh={}}
R.prototype.je=function(a){p.addBuiltInListener(this.ga,"mousedown",a.mouseDownHandler)}
;R.prototype.gf=function(a){p.removeBuiltInListener(this.ga,"mousedown",a.mouseDownHandler)}
;R.prototype.ch=function(a,b,c){var d=this.q;var e=this.tblMain;var f=d.length;var g,h,i,j;var l=this.w;var k=l.j();var n=l.numCols+1;var o=l.rowHObj;if(a){var r=l.trixApp.x();for(g=f;g<=c;g++){i=e.insertRow(g);i.isHeader=true;for(h=0;h<=n;h++){j=i.insertCell(h)}}for(g=b;g<=c;g++){s=k.e(g,true);this.Ig(r,s,d[g],n,true);d[g].style.display="";s.style.display="none";o.e(g).style.display="none"}}else{var r,s;for(g=b;g<=c;g++){s=k.e(g,true);this.Ig(s.ownerDocument,d[g],s,n,false);d[g].style.display="none"
;s.style.display="";o.e(g).style.display=""}}}
;R.prototype.Ig=function(a,b,c,d,e){var f=b.cells;var g=c.cells;var h,i,j;for(var l=0;l<d;l++){h=f[l];i=g[l];if(l==0){i.innerHTML=h.innerHTML}else{X(a,i,Ia(h))}i.colSpan=h.colSpan;i.mergP=h.mergP;if(e){j=h.className;i.className=j;this.Aj(a,h,j)}i.style.cssText=h.style.cssText}}
;R.prototype.Aj=function(a,b,c){if(this.uh[c]==null){var d=this.uh;var e=c.split(" ");var f=a.styleSheets[0];var g="#"+this.zh+" td.";var h=null;for(var i=0;i<e.length;i++){h=e[i];if(d[h]==null){d[h]=1;vc(f,g+h,xc(b.ownerDocument,h))}}d[c]=1}}
;R.prototype.kj=function(a){var b=this.w;var c=b.j();var d=c.e(0).cells;var e=[];e.push("<table cellpadding='0' class='tblGenFixed' id='"+this.zh,"' style='font-size:10pt;'><tr><td class='cAll' style='width:0px'></td>");for(var f=1;f<=a;f++){e.push("<td class='cAll' style='width:",d[f].style.width,"'>",P(f),"</td>")}if(this.isIE){e.push("<td style='width:"+(b.scrollDepth-1)+"px' class='headerEnd'></td></tr></table>")}else{e.push("<td style='width:"+(b.scrollDepth-2)+"px' class='headerEnd'></td></tr></table>"
)}this.ga.innerHTML=e.join("");this.tblMain=this.ga.childNodes[0];this.q=this.tblMain.rows;var g=this.w.trixApp.x();this.divActiveCellInH=v(g,this.ga,"divActiveCell",-3,-3,"0px","0px");this.divSelectionInH=v(g,this.ga,"divSelection",-3,-3,"0px","0px");this.divFormulasInH=v(g,this.ga,"divFormuSelect",-3,-3,"0px","0px")}
;R.prototype.wg=function(){var a=this.w;var b=a.j();var c=b.e(0).cells;var d=this.q[0].cells;for(var e=1;e<d.length-1;e++){if(a.O(null,c[e])){d[e].style.display="none"}else{d[e].style.display=""}}}
;R.prototype.Cc=function(a){this.ga.style.visibility=a}
;R.prototype.Kl=function(a){this.ga.style.width=a}
;R.prototype.Md=function(a){this.ga.style.height=a}
;R.prototype.na=function(a){this.ga.scrollLeft=a}
;R.prototype.Nb=function(){return this.ga.scrollLeft}
;R.prototype.Pa=function(a){return this.q[0].cells[a]}
;R.prototype.kd=function(a){return this.q[a]}
;R.prototype.Te=function(a,b,c,d){var e,f,g,h,i;for(e=0;e<this.q.length;e++){g=this.q[e];h=g.cells[a];for(f=0;f<b;f++){i=Xb(h,g,a+d);if(e==0){i.style.cssText=h.style.cssText;i.style.width=c}}}}
;R.prototype.xe=function(a,b,c){var d,e,f;for(d=0;d<this.q.length;d++){f=this.q[d];for(e=0;e<b;e++){if(c){f.removeChild(f.cells[a])}else{f.deleteCell(a)}}}}
;
function yc(a,b,c){b=parseInt(b);c=parseInt(c);var d=false;var e=false;var f="";var g="";var h=null;var i=null;var j=0;var l=0;var k=0;var n=0;var o=true;for(var r=0;r<a.length;r++){h=a.charAt(r);if(!d&&!e&&wb(h)){f=f+h}if(r==a.length-1||d||e||!wb(h)){if(h=='"'){d=!d}if(!d&&h=="'"){e=!e}var s=r==a.length-1||jb(h);if(f.length>0){i=Wb(f,/^(\$)?([a-zA-Z])?([a-zA-Z])?(\$)?(\d+)?(?:(:)(\$)?([a-zA-Z])?([a-zA-Z])?(\$)?(\d+)?)?$/);if(o&&s&&i!=null){var w="";for(j=1;j<=11;j++){if(i[j]==null){i[j]=""}}if(i[
2].length>0&&i[5].length>0&&i[6].length>0&&i[8].length>0&&i[11].length>0||i[2].length>0&&i[5].length>0||i[2].length>0&&i[6].length>0&&i[8].length>0||i[5].length>0&&i[6].length>0&&i[11].length>0){if(i[5].length>0){l=i[5];if(i[4].length>0){w+="R"+l}else{l=parseInt(l)-b;w+="R["+l+"]"}}if(i[2].length>0){k=i[2].toUpperCase().charCodeAt(0)-64;if(i[3].length>0){n=i[3].toUpperCase().charCodeAt(0)-64;k=k*26+n}if(i[1].length>0){w+="C"+k}else{k=parseInt(k)-c;w+="C["+k+"]"}}if(i[6].length>0){w+=i[6];if(i[11]
.length>0){l=i[11];if(i[10].length>0){w+="R"+l}else{l=parseInt(l)-b;w+="R["+l+"]"}}if(i[8].length>0){k=i[8].toUpperCase().charCodeAt(0)-64;if(i[9].length>0){n=i[9].toUpperCase().charCodeAt(0)-64;k=k*26+n}if(i[7].length>0){w+="C"+k}else{k=parseInt(k)-c;w+="C["+k+"]"}}}g+=w}else{g+=f}}else{g+=f}}if(!(r==a.length-1&&wb(h))){g+=h}f="";o=jb(h)}}return g}
function wc(a,b,c){b=parseInt(b);c=parseInt(c);var d=false;var e=false;var f="";var g="";var h=null;var i=null;var j=null;var l=0;var k=0;var n=0;var o=0;var r=true;a=""+a;for(var s=0;s<a.length;s++){h=a.charAt(s);if(s>0){i=a.charAt(s-1)}if(!d&&!e&&xb(h,i)){f=f+h}if(s==a.length-1||d||e||!xb(h,i)){if(h=='"'){d=!d}if(!d&&h=="'"){e=!e}var w=s==a.length-1||jb(h);if(f.length>0){j=Wb(f,/^([R|r])?(\[)?(\-)?(\d+)?(\])?([C|c])?(\[)?(\-)?(\d+)?(\])?(?:(:)([R|r])?(\[)?(\-)?(\d+)?(\])?([C|c])?(\[)?(\-)?(\d+)?(\])?)?$/
);if(r&&w&&j!=null){for(l=1;l<=21;l++){if(j[l]==null){j[l]=""}}var C="";var F=false;var x=false;if(j[1].length>0&&j[6].length>0||j[1].length>0&&j[11].length>0&&j[12].length>0||j[6].length>0&&j[11].length>0&&j[17].length>0){if(j[6].length>0){if(j[7].length>0&&j[10].length>0&&j[9].length>0){k=parseInt(j[9]);if(j[8].length>0){k=k*-1}o=c+k;C+=P(o);x=x||parseInt(o)>0}else if(j[9].length>0){C+="$";C+=P(j[9]);x=x||parseInt(j[9])>0}else{C+=P(c);x=x||parseInt(c)>0}}else{x=true}if(j[1].length>0){if(j[2].length>
0&&j[5].length>0&&j[4].length>0){k=parseInt(j[4]);if(j[3].length>0){k=k*-1}n=b+k;C+=Ua(n);F=F||parseInt(n)>0}else if(j[4].length>0){C+="$"+Ua(j[4]);F=F||parseInt(j[4])>0}else{C+=Ua(b);F=F||parseInt(b)>0}}else{F=true}if(j[11].length>0){C+=":";if(j[17].length>0){if(j[18].length>0&&j[21].length>0&&j[20].length>0){k=parseInt(j[20]);if(j[19].length>0){k=k*-1}o=c+k;C+=P(o);x=x||parseInt(o)>0}else if(j[20].length>0){C+="$";C+=P(j[20]);x=x||parseInt(j[20])>0}else{C+=P(c);x=x||parseInt(c)>0}}if(j[12].length>
0){if(j[13].length>0&&j[16].length>0&&j[15].length>0){k=parseInt(j[15]);if(j[14].length>0){k=k*-1}n=b+k;C+=Ua(n);F=F||parseInt(n)>0}else if(j[15].length>0){C+="$"+Ua(j[15]);F=F||parseInt(j[15])>0}else{C+=Ua(b);F=F||parseInt(b)>0}}}if(F&&x){g+=C}else{g+="{}"}}else{g+=f}}else{g+=f}}if(!(s==a.length-1&&xb(h,i))){g+=h}f="";r=jb(h)}}return g}
function wb(a){var b=/\w/;if(b.test(a)||a=="$"||a==":"){return true}else{return false}}
function xb(a,b){var c=/\d/;if(c.test(a)||a=="R"||a=="C"||a=="r"||a=="c"||a=="["||a=="]"||a=="-"&&b=="["||a==":"){return true}else{return false}}
function jb(a){var b=/\w/;if(!b.test(a)){return true}else{return false}}
function Wb(a,b){if(b.test(a)){return b.exec(a)}else{return null}}
function P(a){a=parseInt(a);if(a<=0){a=1}var b="";if(a<676&&a>0){var c=0;if(a>26){c=(a-1)/26;a=(a-1)%26+1}if(c==0){b=String.fromCharCode(a+64)}else{b=String.fromCharCode(c+64)+String.fromCharCode(a+64)}}return b}
function Ua(a){a=parseInt(a);if(a<=0){a=1}return a}
;
function Xa(a){this.b=a;this.copyType=null;this.w=null;this.pf=null;this.Gg=null;this.rf=null;this.qe=null}
Xa.prototype.copy=function(a,b){this.copyType=a;var c=this.b.activeGrid;this.w=c;this.pf=c.info.rowsTOids[c.topLeftRow];this.Gg=c.info.colsTOids[c.topLeftCol];this.rf=c.rowsSelected;this.qe=c.colsSelected;if(b==1){this.rf=1}else if(b==2){this.qe=1}}
;Xa.prototype.paste=function(){if(this.b.modalDbox==null){var a=this.b.activeGrid;if(this.copyType!=null&&this.pf!=null&&a!=null&&a.topLeftRow!=null){var b=this.w;var c=b.info;var d=c.idsTOrows[this.pf];var e=c.idsTOcols[this.Gg];var f=this.rf;var g=this.qe;var h=a.topLeftRow;var i=a.topLeftCol;var j=a.rowsSelected;var l=a.colsSelected;var k=O+"=9";k+="&atyp="+this.copyType;var n=c.rowsTOids;var o=c.colsTOids;k+="&gid="+b.id;k+="&srow="+n[d];k+="&scol="+o[e];k+="&erow="+n[d+f-1];k+="&ecol="+o[e+g-
1];var r=a.info.rowsTOids;var s=a.info.colsTOids;k+="&pgi="+a.id;k+="&pri="+r[h];k+="&pci="+s[i];k+="&peri="+r[h+j-1];k+="&peci="+s[i+l-1];this.b.Z(Q);this.b.ea(k,false);if(f*g!=1){if(j*l==1||j==f&&l==g||j<f||l<g){var w=Math.min(f,a.numRows-h+1);var C=Math.min(g,a.numCols-i+1);a.da(h,i,h+w-1,i+C-1,true)}else if(j>f||l>g){var F=Math.floor(j/f);var x=Math.floor(l/g);a.da(h,i,h+f*F-1,i+g*x-1,true)}}}}}
;Xa.prototype.Zc=function(a){if(a!=null){var b=this.b.cellSelection.Mb();var c=a.topLeftRow;if(c!=null){var d=1;var e=true;var f=a.topLeftCol;var g=a.rowsSelected;var h=a.colsSelected;var i=[];var j=null;var l=a.j();var k,n;for(k=0;k<g&&e;k++){j=l.e(c+k).cells;for(n=0;n<h&&e;n++){i.push(Ia(j[f+n]));if(n<h-1){i.push("\t")}d++;if(d>1000){e=false}}i.push("\n")}b.value=i.join("");b.focus();b.select()}}}
;Xa.prototype.pi=function(){if(this.b.modalDbox==null){var a=this.b.activeGrid;if(this.copyType==null&&a!=null&&a.topLeftRow!=null){var b=this.b.cellSelection.Mb().value;if(b.length>20000){this.b.oa("Oops, you can't paste that much text from the clipboard.","secStatCopy")}else if(b.length>0){var c=a.topLeftRow;var d=a.topLeftCol;var e=O+"=9";e+="&atyp="+q.pasteFromClip;e+="&pgi="+a.id;e+="&pri="+a.info.rowsTOids[c];e+="&pci="+a.info.colsTOids[d];e+="&v="+encodeURIComponent(b);var f=1;var g=1;var h=
b.split("\n");if(h!=null){f=Math.max(1,h.length-1);h=h[0].split("\t");if(h!=null){g=Math.max(1,h.length)}}f=Math.min(f,a.numRows-c+1);g=Math.min(g,a.numCols-d+1);a.da(c,d,c+f-1,d+g-1,true);e+="&nrow="+f;e+="&ncol="+g;this.b.Z(Q);this.b.ea(e,true)}}}}
;
function Ub(a,b,c){this.w=a;this.Se=a.trixApp.pathImg;var d=v(b,c,"divEmbedObjs",35,20,0,0);this.Nj=d}
Ub.prototype.na=function(a,b){var c=this.Nj.style;if(a!=null)c.left=35-a;c.top=20-b}
;
function _getInstanceOfFileManager(a,b,c,d,e,f,g,h,i,j,l,k,n,o,r,s,w,C){return new Aa(a,b,c,d,e,f,g,h,i,j,l,k,n,o,r,s,w,C)}
function _getInstanceOfApp(a,b,c){if(Nc()){return new t(a,b,c)}}
;
function Ya(a,b){var c=a.createElement("iframe");c.className="tiles";c.frameBorder="0px";c.marginWidth="0px";c.marginHeight="0px";c.scrolling="no";b.appendChild(c);this.ah=c}
Ya.prototype.bk=function(a){this.md().location.replace(a)}
;Ya.prototype.nh=function(){return this.ah.style}
;Ya.prototype.md=function(){return this.ah.contentWindow}
;Ya.prototype.ih=function(){return this.md().document}
;
function y(a,b,c,d){this.isIE=u.type==1;this.Hh=false;this.info=new fa(this);this.headersOn=true;this.trixApp=a;this.index=this.trixApp.kh().T();this.id=b;this.trixApp.grids.ids[this.id]=this;this.name="Sheet"+(this.id+1);this.numRows=parseInt(c);this.numCols=parseInt(d);var e=this.trixApp.x();var f=v(e,this.trixApp.divGrids,"divGrid",0,0,"100%","100%");this.pb=f;this.mainGridWid=f.offsetWidth-35;this.mainGridHei=f.offsetHeight-20;this.divTop=v(e,f,"divTop",0,0,"100%","100%");this.topLeftRow=1;this.topLeftCol=
1;this.activeRow=1;this.activeCol=1;this.rowsSelected=1;this.colsSelected=1;this.activeRowID=null;this.activeColID=null;var g=v(e,f,"divMainArea",35,20,this.mainGridWid,this.mainGridHei);this.divMain=g;g.id="g"+this.id;this.De=v(e,g,"divSelObjs",0,0,"0px","0px");this.Be=v(e,this.De,"divActiveCell",-3,-3,"0px","0px");this.divSelection=v(e,this.De,"divSelection",-3,-3,"0px","0px");this.divFormulas=v(e,this.De,"divFormuSelect",-3,-3,"0px","0px");this.rowHObj=new S(this,f);this.colHObj=new R(this,f);
this.Qg=new Ub(this,e,f);this.scrollDepth=g.offsetWidth-g.clientWidth-1;this.wi();this.eventSrc=null;this.L=new J(e,this,g);this.divTop.style.cursor="default";this.lastTblHeight=-1;this.Af=null;this.Lb=true;this.freezeRow=0;this.freezeHeight=0}
y.prototype.Oe=function(){return this.Qg}
;y.prototype.Ke=function(a,b){a=Math.max(Math.min(5,a),0);if(b==true){var c=this.colHObj;if(a>this.freezeRow){c.ch(true,this.freezeRow+1,a)}else if(a<this.freezeRow){c.ch(false,a+1,this.freezeRow)}var d=c.kd(0).cells;if(a>0&&this.freezeRow==0){for(var e=0;e<d.length;e++){d[e].style.borderBottom="1px solid #9FC2FD"}}else if(a==0){for(var e=0;e<d.length;e++){d[e].style.borderBottom=""}}this.freezeRow=a;this.zf();this.divMain.scrollTop=0;if(this.isIE){this.rowHObj.xg(a+1,this.L.e(a+1))}this.ya(0)}else{
var f=O+"=9";f+="&gid="+this.id;f+="&atyp="+q.freeze;f+="&srow="+a;var g=this.trixApp;g.Z(Q);g.ea(f,false);g.s()}}
;y.prototype.zf=function(){var a=this.colHObj;var b=a.tblMain.offsetHeight;if(this.freezeHeight!=b-20){this.divMain.style.top=b;this.rowHObj.Il(b);a.Md(b);this.mainGridHei=this.pb.offsetHeight-b;this.divMain.style.height=this.mainGridHei;this.rowHObj.Md(this.mainGridHei);this.freezeHeight=0;if(this.freezeRow>0){this.freezeHeight=b-20}this.L.lc();return true}return false}
;y.prototype.wi=function(){this.mainGridWid=this.pb.offsetWidth-35;var a=this.colHObj.tblMain;this.mainGridHei=this.pb.offsetHeight-(a==null?20:a.offsetHeight);this.divTop.style.width=this.pb.offsetWidth-this.scrollDepth;this.divTop.style.height=this.pb.offsetHeight-this.scrollDepth;if(!this.isIE){this.mainGridWid-=4;this.mainGridHei-=4}if(this.headersOn){this.divMain.style.width=this.mainGridWid;this.divMain.style.height=this.mainGridHei}else{this.divMain.style.width="100%";this.divMain.style.height=
"100%"}this.rowHObj.Md(this.mainGridHei);this.colHObj.Kl(this.mainGridWid-this.scrollDepth)}
;y.prototype.Zk=function(){this.rowHObj.lj();this.colHObj.kj(this.numCols);this.trixApp.mouseSelection.Bl(this,this.divTop);this.lastTblHeight=-1;this.rowHObj.nk();this.colHObj.wg();this.Za();this.lastTblHeight=this.j().Fa();var a=this.info.freezeOnLoad;if(a>0){this.Ke(a,true)}this.Hh=true;this.trixApp.oa("Sheet '"+this.name+"' added.")}
;y.prototype.rm=function(a){var b=this.divMain.style;if(a){this.rowHObj.Cc("visible");this.colHObj.Cc("visible");b.left="35px";b.top="20px";b.width=this.mainGridWid+"px";b.height=this.mainGridHei+"px"}else{this.rowHObj.Cc("hidden");this.colHObj.Cc("hidden");b.left="0px";b.top="0px";b.width="100%";b.height="100%"}this.headersOn=a}
;y.prototype.mm=function(){return this.headersOn}
;y.prototype.yg=function(){if(this.rowsSelected>1||this.colsSelected>ta(this.wa(),this)){return true}}
;y.prototype.Fh=function(a,b){var c=this.L;var d=null;var e=-this.divMain.scrollTop;var f=-this.divMain.scrollLeft;var g=c.e(a);if(g.isHeader!=true){var h=g.cells[0];var i=c.K(h.parentNode);var j=i+h.offsetHeight;var l=this.divMain.scrollTop;var k=this.divMain.scrollTop+this.mainGridHei-this.scrollDepth;if(j>k){e=Math.max(e-(j-k),-2000000);d=[e,f]}else if(i<l){e=Math.min(e-(i-l),0);d=[e,f]}}var h=c.e(0).cells[b];i=h.offsetLeft;j=h.offsetLeft+h.offsetWidth;l=this.divMain.scrollLeft;k=this.divMain.scrollLeft+
this.mainGridWid-this.scrollDepth;if(j>k){f=Math.max(f-(j-k),-2000000);d=[e,f]}else if(i<l){f=Math.min(f-(i-l),0);d=[e,f]}return d}
;y.prototype.ma=function(a,b){var c=this.Fh(a,b);if(c!=null){var d=c[0];var e=c[1];this.divMain.scrollLeft=-e;this.divMain.scrollTop=-d;this.colHObj.na(-e);this.rowHObj.na(-d);this.Qg.na(-e,-d)}}
;y.prototype.da=function(a,b,c,d,e){this.trixApp.cellSelection.fa(true);var f=Math.min(a,c);var g=Math.min(b,d);var h=this.L;var i=h.e(Math.max(a,c)).cells[Math.max(b,d)];var j=Math.abs(c-a)+1;var l=Math.abs(d-b);var k=ta(i,this);if(k>1){l+=k}else{l+=1}this.topLeftRow=f;this.topLeftCol=g;this.rowsSelected=j;this.colsSelected=l;this.Fe(f,g,f+j-1,g+l-1);if(e==true){this.zb(true,false)}}
;y.prototype.Gi=function(){var a=this.j();var b=1;var c=a.e(b);while(this.O(null,c)){b++;c=a.e(b)}var d=1;var e=c.cells;var f=e[d];while(this.O(null,f)){d++;f=e[d]}this.F(b,d,true)}
;y.prototype.pl=function(){var a=this.j();var b=this.numRows;var c=a.e(b);while(this.O(null,c)){b--;c=a.e(b)}var d=this.numCols;var e=c.cells;var f=e[d];while(this.O(null,f)&&d>0){d--;f=e[d]}if(d>0){this.F(b,d,true)}}
;y.prototype.F=function(a,b,c){this.trixApp.cellSelection.fa(true);this.activeRow=a;this.activeCol=b;if(c){this.topLeftRow=a;this.topLeftCol=b;var d=this.L.e(a).cells[b];if(d.rowSpan>1){this.rowsSelected=d.rowSpan}else{this.rowsSelected=1}var e=ta(d,this);if(e>1){this.colsSelected=e}else{this.colsSelected=1}}this.zb(true,c)}
;y.prototype.Qj=function(a,b,c,d,e){var f=this.freezeHeight;var g=f>0;var h=this.divSelection.style;var i=this.colHObj.divSelectionInH.style;var j=false;if(e!=null){h=e.style;if(e==this.divFormulas){i=this.colHObj.divFormulasInH.style;j=true}}if(a!=null){h.left=a;if(g)i.left=a}if(b!=null){h.top=Math.max(0,b);if(b<0&&g&&c>0){h.top=0;i.top=Math.max(20,f+b+20);i.width=c;var l=Math.min(-b,f,d);i.height=l;i.visibility="visible";d-=l}else{i.height=0;i.visibility="hidden"}}if(d!=null)h.height=Math.max(0,
d);if(c>0){h.width=c;if(g)i.width=c;h.visibility="visible"}}
;y.prototype.Fe=function(a,b,c,d,e){var f=this.divSelection.style;var g=this.colHObj.divSelectionInH.style;var h=false;if(e!=null){f=e.style;if(e==this.divFormulas){g=this.colHObj.divFormulasInH.style;h=true}}var i=this.j();var j=i.e(a).cells[b];var l=i.e(c).cells[d];var k=Ha(l,this);if(k!=null){l=k}var n=j.offsetLeft;var o=j.offsetWidth;var r=ta(j,this);if(d>b+r-1){o=l.offsetLeft+l.offsetWidth-n}var s,w;s=i.K(j.parentNode);w=i.K(l.parentNode)+l.offsetHeight;var C=this.freezeRow;if(a>C){this.Kb(f,
n,s,o,w-s);g.visibility="hidden"}else if(c<=C){this.Kb(g,n,s+20,o,w-s);f.visibility="hidden"}else{var F=this.freezeHeight-s;this.Kb(g,n,s+20,o,F);this.Kb(f,n,0,o,w)}}
;y.prototype.Kb=function(a,b,c,d,e){if(this.isIE){e=Math.min(e,32768)}a.left=b;a.top=c;a.width=d;a.height=e;a.visibility="visible"}
;y.prototype.Ck=function(){var a=this.divSelection.style;this.Kb(a,0,0,1,1);a.visibility="hidden";var a=this.divFormulas.style;this.Kb(this.divFormulas.style,0,0,1,1);a.visibility="hidden"}
;y.prototype.ya=function(a){var b=this.colHObj;if(a==0||a==1){Oa(b.divActiveCellInH);Oa(this.Be)}if(a==0||a==2){Oa(b.divSelectionInH);Oa(this.divSelection)}if(a==0||a==3){Oa(b.divFormulasInH);Oa(this.divFormulas)}}
;y.prototype.zg=function(a){var b="#3366cc";if(a){b="#ff9900"}this.colHObj.divSelectionInH.style.backgroundColor=b;this.divSelection.style.backgroundColor=b;this.colHObj.divActiveCellInH.style.borderColor=b;this.Be.style.borderColor=b;if(a==true){qa(this,this.zg,200)}}
;y.prototype.gh=function(a){var b=[];var c=this.divMain;var d=this.j().K(a.parentNode);b[0]=a.offsetLeft+c.offsetLeft-c.scrollLeft+1;if(a.parentNode.isHeader==true){b[1]=d+20}else{b[1]=d+c.offsetTop-c.scrollTop}return b}
;y.prototype.zb=function(a,b){this.trixApp.iconManager.od();var c;if(this.Lb){this.trixApp.menuMain.Ld();this.Lb=false}var d=this.divSelection.style;var e=d.visibility=="visible";var f=false;var g=this.colHObj.divSelectionInH;if(g!=null){f=g.style.visibility=="visible"}if(b){this.ya(0)}else{this.ya(1)}if(a){c=this.wa();if(c!=null){if(!this.O(c.parentNode,c)){if(!b&&!this.trixApp.isPanningOn){if(this.rowsSelected>1||this.colsSelected>1){if(e)d.visibility="visible";if(f)g.style.visibility="visible"
}else{this.ya(2)}}var h=this.Be.style;var i=this.j().K(c.parentNode);if(c.parentNode.isHeader==true){h=this.colHObj.divActiveCellInH.style;i+=20}var j=this.isIE?0:1;h.top=i-j;h.left=c.offsetLeft-j;h.width=c.offsetWidth+1;h.height=c.offsetHeight+1;h.visibility="visible"}}}this.Li(c,250,false)}
;y.prototype.Li=function(a,b,c){window.clearTimeout(this.Af);this.Af=qa(this,this.xf,b,a,c)}
;y.prototype.xf=function(a,b){var c=this.trixApp;if(b!=true){var d,e;if(a!=null){var f=this.activeCol;var g=this.activeRow;var e="<B>"+P(f)+g+"</B>&nbsp;=&nbsp;";var h=this.info.jh(g,f);var i=this.info.eh(g,f);if(i==null){i=Ia(a)}if(h!=null&&c.mode<2){d=h}else{d=i}c.oa(d)}var j=c.menuMain;if(d==null){j.Ld();j.lf()}else{j.Ld(e,d);j.Mi(a,this)}}if(a!=null){c.iconManager.Ql(this)}this.Af=null}
;y.prototype.Za=function(a){var b=this.L;b.lc();this.zb(true,false);if(this.divSelection.style.visibility==="visible"){var c=this.topLeftRow;var d=this.topLeftCol;var e=this.rowsSelected;var f=this.colsSelected;this.Fe(c,d,c+e-1,d+f-1)}else{this.ya(2);if(a){this.Ck()}}this.ya(3)}
;y.prototype.sh=function(){var a=this.activeRow;var b=this.activeCol;if(a!=null&&b!=null){var c=this.info.dk(a,b);if(c==null){c=Ia(this.L.e(a).cells[b]);if(/^((www\.)|((ftp|http|https|gopher|mailto|news|telnet|aim):\/\/))[%A-Za-z0-9$_.+!*(),;\/?#:@&~=-]+$/.test(c)){if(c.indexOf("www.")==0){c="http://"+c}return c}}else{return zc(c)}}return null}
;y.prototype.hyperlink=function(){var a=this.sh();if(a!=null){Sb(a,true)}}
;y.prototype.wa=function(){if(!this.L.th()){return null}if(this.activeRow==null){return null}else{return this.L.e(this.activeRow).cells[this.activeCol]}}
;y.prototype.Nd=function(a,b){this.pb.style.zIndex=a;this.zb(b,false);this.trixApp.oa(this.name+": "+this.numRows+"x"+this.numCols)}
;y.prototype.kl=function(){if(u.os==2){var a=this.pb.style;a.display="none";window.setTimeout(function(){a.display=""}
,0)}}
;y.prototype.qm=function(){return this.Hh}
;y.prototype.j=function(){return this.L}
;y.prototype.O=function(a,b){if(a!=null&&U(a,"display","display")=="none"){return true}else if(U(b,"display","display")=="none"){return true}else{return false}}
;y.prototype.sk=function(a,b){var c=this.L;var d=null;var e=null;var f=null;var g,h;var i=this.trixApp.defaultRowHeight;var j=this.trixApp.defaultColWidth;var l=0;if(a==q.rowInsertAfter){a=q.rowInsert;l=1}if(a==q.colInsertAfter){a=q.colInsert;l=1}if(a==q.rowInsert||a==q.rowDelete){var k=b.r;if(k==-1){l=1;k=this.numRows}else{k=this.info.idsTOrows[k]}if(k!=null){if(a==q.rowInsert){var n=b.nid;var o=n.length;var r=c.e(k).cells;var s=null;var w=null;var C=c.e(0).cells;for(h=0;h<o;h++){s=c.insertRow(k,
l);w=s.insertCell(0);for(g=1;g<r.length;g++){d=r[g];if(this.isIE){e=s.appendChild(w.cloneNode(true))}else{e=s.insertCell(g)}e.className="g";if(this.O(null,d)){if(this.O(null,C[g])){e.style.display="none"}}}w.className=r[0].className;w.innerHTML="<P></P>";w.childNodes[0].style.height=i}this.rowHObj.tk(k,o,w.offsetHeight,l);this.numRows+=o;this.info.vg(n,null,k+l)}else{var F=this.info.idsTOrows[b.r2];if(F!=null){var o=F-k+1;for(g=0;g<o;g++){this.rowHObj.Jj(k);c.deleteRow(k);this.numRows--}if(F>this.numRows)
{this.F(this.numRows,this.topLeftCol,true)}this.info.ri(k,null,o)}}this.rowHObj.si(k,c)}}else{var x=b.c;if(x==-1){l=1;x=this.numCols}else{x=this.info.idsTOcols[x]}if(x!=null){var Ba=this.colHObj.kd(0);var Y=null;if(a==q.colInsert){var n=b.nid;var o=n.length;c.Te(x,o,j,l);for(g=1;g<=this.numRows;g++){f=c.e(g).cells[x+o];Y=Ha(f,this);if(Y!=null){if(Y!=f){Y.colSpan+=o}}}this.colHObj.Te(x,o,j,l);this.numCols+=o;this.info.vg(null,n,x+l)}else{var aa=this.info.idsTOcols[b.c2];if(aa!=null){var o=aa-x+1;var ba=
0;for(g=0;g<o;g++){for(h=1;h<=this.numRows;h++){f=c.e(h).cells[x+g];Y=Ha(f,this);if(Y!=null){if(Y==f){ba=ta(f,this)-o+g;if(ba>0){this.tc(h,aa+1,f.rowSpan,ba)}}else{Y.colSpan--}}}}c.xe(x,o);this.colHObj.xe(x,o,this.isIE);this.numCols-=o;if(aa>this.numCols){this.F(this.topLeftRow,this.numCols,true)}this.info.ri(null,x,o)}}for(g=x;g<=this.numCols;g++){Ba.cells[g].innerHTML=P(g)}}}this.Za(true);var D=this.trixApp.cellSelection;if(D.isEditBoxActive){D.Dc(true)}}
;y.prototype.pm=function(a,b,c,d){var e=this.L;var f="";if(d){this.zb(false,true);this.topLeftRow=null;this.topLeftCol=null;this.activeRow=null;this.activeCol=null;this.rowsSelected=1;this.colsSelected=1;f="none"}if(c){for(var g=a;g<=b;g++){e.e(g).style.display=f;this.rowHObj.e(g).style.display=f}}else{e.mk(a,b,f);this.colHObj.wg()}this.L.lc()}
;y.prototype.tc=function(a,b,c,d){var e=this.L;var f,g,h,i,j,l;var k=e.e(a).cells[b];k.mergP=k;for(h=0;h<c;h++){j=a+h;f=e.e(j).cells;for(i=0;i<d;i++){if(h+i>0){l=b+i;g=f[b+i];g.innerHTML="";g.style.display="none";g.colSpan=1;g.rowSpan=1;this.info.pe(j,l);g.mergP=k}}}f=e.e(0).cells;var n=d;for(i=0;i<d;i++){if(this.O(null,f[b+i])){n--}}k.colSpan=n;k.rowSpan=c;k.style.display="";if(!this.isIE){if(a+c<=this.numRows){g=e.e(a+c).cells[b];var o=g.className;g.className="";qa(this,this.vl,0,g,o)}}}
;y.prototype.vl=function(a,b){a.className=b}
;y.prototype.Ud=function(a,b,c,d){if(c>1||d>1){var e=this.L;var f,g,h,i,j;var l=e.e(0).cells;for(h=0;h<c;h++){f=e.e(a+h).cells;for(i=0;i<d;i++){j=b+i;g=f[j];if(!this.O(null,l[j])){g.style.display=""}g.colSpan=1;g.rowSpan=1;g.mergP=null}}}}
;y.prototype.of=function(a,b,c,d,e){var f=this.L;if(c){var g=null;var h=null;var i=null;for(var j=a;j<=b;j++){h=f.e(j);g=h.cells[0].childNodes[0];g.style.height=d;i=this.rowHObj.e(j);i.style.height=h.offsetHeight;i.cells[0].style.height=h.offsetHeight}}else{var l=this.colHObj.kd(0).cells;for(var j=a;j<=b;j++){f.ol(j,d);l[j].style.width=d}}if(e){this.L.lc()}}
;y.prototype.rl=function(a,b,c,d){var e=false;var f=O+"=9";f+="&gid="+this.id;if(d){var g=this.info.rowsTOids;var h=g[b];var i=g[c];if(h==null||i==null){e=true;this.trixApp.ab($a,q.errorGeneric,true)}else{f+="&atyp="+q.resizeRow;f+="&srow="+h;f+="&erow="+i;f+="&v="+this.rowHObj.e(a).offsetHeight}}else{var j=this.info.colsTOids;var h=j[b];var i=j[c];if(h==null||i==null){e=true;this.trixApp.ab($a,q.errorGeneric,true)}else{f+="&atyp="+q.resizeCol;f+="&scol="+h;f+="&ecol="+i;f+="&v="+this.colHObj.Pa(
a).offsetWidth}}if(!e){this.trixApp.Z(Q);this.trixApp.ea(f,false)}}
;y.prototype.ja=function(a,b){if(this.topLeftRow!=null){var c=this.L;var d,e,f;for(d=0;d<this.rowsSelected;d++){f=c.e(this.topLeftRow+d).cells;for(e=0;e<this.colsSelected;e++){f[this.topLeftCol+e].style[a]=b}}this.rowHObj.ke();this.jb(q[a],b,Q)}}
;y.prototype.ze=function(){if(this.topLeftRow!=null){var a=this.L;var b,c,d;var e,f;for(b=0;b<this.rowsSelected;b++){e=this.topLeftRow+b;d=a.e(e).cells;for(c=0;c<this.colsSelected;c++){f=this.topLeftCol+c;d[f].innerHTML="";this.info.pe(e,f)}}this.jb(q.clear,"","Updating...");this.rowHObj.ke();this.xf(this.wa())}this.trixApp.A()}
;y.prototype.ql=function(a,b,c){if(b==null||c==null){this.trixApp.ab($a,q.errorGeneric,true)}else{this.trixApp.Z("Updating...");var d=O+"=9";var e=Ia(a);if(e.indexOf("=")==0){e=yc(e,this.activeRow,this.activeCol);d+="&atyp="+q.formula}else{d+="&atyp="+q.value}d+="&gid="+this.id;d+="&srow="+b;d+="&scol="+c;d+="&v="+encodeURIComponent(e);this.trixApp.ea(d,true)}}
;y.prototype.jb=function(a,b,c){var d=this.info.rowsTOids;var e=this.info.colsTOids;var f=d[this.topLeftRow];var g=e[this.topLeftCol];var h=d[this.topLeftRow+this.rowsSelected-1];var i=e[this.topLeftCol+this.colsSelected-1];if(f==null||g==null||h==null||i==null){this.trixApp.ab($a,q.errorGeneric,true)}else{this.trixApp.Z(c);var j=O+"=9";j+="&atyp="+a;j+="&gid="+this.id;j+="&srow="+f;j+="&scol="+g;j+="&erow="+h;j+="&ecol="+i;j+="&v="+encodeURIComponent(b);this.trixApp.ea(j,true)}}
;y.prototype.fm=function(a){var b=this.info.idsTOrows;var c=this.info.idsTOcols;var d=b[a.r];var e=c[a.c];var f=b[a.r2];var g=c[a.c2];var h=1;var i=1;if(f!=null){h=f-d+1}if(g!=null){i=g-e+1}var j=a.css;var l=this.L;var k,n,o;for(k=0;k<h;k++){o=l.e(d+k).cells;for(n=0;n<i;n++){o[e+n].style.cssText+=";"+j}}if(j.indexOf("border")!=-1){this.j().bordersChanged=true}}
;
function fa(a){this.w=a;this.formulaList=null;this.numfmtList=null;this.cells=null;this.rowsTOids=null;this.colsTOids=null;this.idsTOrows=null;this.idsTOcols=null;this.freezeOnLoad=0}
fa.prototype.Lh=function(){var a=O+"=2";a+="&grid="+this.w.id;var b=W(this.w.trixApp.url,a,false);this._a=null;this._b=null;this._x=null;this._rs=null;this._cs=null;this._fz=0;this._action=null;eval(b.responseText);var c=false;if(this._action==2){this.formulaList=this._a;if(this.formulaList==null){this.formulaList=[]}this.numfmtList=this._b;if(this.numfmtList==null){this.numfmtList=[]}this.cells=this._x;if(this.cells==null){this.cells=[]}if(this._rs==null){c=true}else{this.rowsTOids=this._rs;this.idsTOrows=
this.Jb(this._rs)}if(this._cs==null){c=true}else{this.colsTOids=this._cs;this.idsTOcols=this.Jb(this._cs)}this.freezeOnLoad=0;if(this._fz!=null){this.freezeOnLoad=this._fz}}else{c=true}this._a=null;this._b=null;this._x=null;this._rs=null;this._cs=null;if(c){this.w.trixApp.ab("We're sorry. There was an error while loading '"+this.w.name+"'",q.errorGeneric,true)}}
;fa.prototype.vg=function(a,b,c){var d=this.cells;if(b==null){var e=a.length;var f=this.rowsTOids;for(var g=f.length-1;g>=c;g--){f[g+e]=f[g];d[g+e-1]=d[g-1]}for(var g=0;g<e;g++){f[c+g]=a[g];d[c+g-1]=null}this.idsTOrows=this.Jb(f)}else{var e=b.length;var f=this.colsTOids;for(var g=f.length-1;g>=c;g--){f[g+e]=f[g]}for(var g=0;g<e;g++){f[c+g]=b[g]}var h=null;var g=0;for(var i=0;i<this.w.numRows;i++){h=d[i];if(h!=null){for(g=f.length-1;g>=c;g--){h[g+e-1]=h[g-1];h[g-1]=null}}}this.idsTOcols=this.Jb(f)
}}
;fa.prototype.ri=function(a,b,c){if(b==null){var d=this.rowsTOids;var e=this.cells;var f=d.length;for(var g=a;g<f-c;g++){d[g]=d[g+c];e[g-1]=e[g+c-1]}d.length=f-c;e.length=f-c-1;this.idsTOrows=this.Jb(d)}else{var d=this.colsTOids;var e=this.cells;var f=d.length;for(var g=b;g<f-c;g++){d[g]=d[g+c]}d.length=f-c;var h=null;var g=0;for(var i=0;i<this.w.numRows;i++){h=e[i];if(h!=null){for(g=b;g<f-c;g++){h[g-1]=h[g+c-1]}h.length=f-c-1}}this.idsTOcols=this.Jb(d)}}
;fa.prototype.dk=function(a,b){var c=this.Ne(a,b);if(c!=null){return c.h}return null}
;fa.prototype.jh=function(a,b){a--;b--;if(this.cells[a]!=null){var c=this.cells[a][b];if(c!=null){if(c.f!=null){return wc(this.formulaList[c.f],a+1,b+1)}}}}
;fa.prototype.pe=function(a,b){a--;b--;if(this.cells[a]!=null){var c=this.cells[a][b];if(c!=null){delete c.f;delete c.v;delete c.h}}}
;fa.prototype.eh=function(a,b){var c=this.Ne(a,b);if(c!=null){return c.v}return null}
;fa.prototype.Ne=function(a,b){a--;b--;if(this.cells[a]!=null){return this.cells[a][b]}return null}
;fa.prototype.Cl=function(a,b,c){var d=c.va;var e=c.h;var f=this.Ne(a,b);var g=true;if(d==null||d==""){if(f!=null){f.v=null}g=false}if(g||e!=null){if(f==null){a--;b--;var h=this.cells;if(h[a]==null){h[a]=[]}f=h[a][b];if(f==null){f={}}h[a][b]=f}if(g)f.v=d}if(f!=null){f.h=e}}
;fa.prototype.gm=function(a){var b=a.fI;var c=a.nI;var d=a.v;var e=false;if(b==-1){b=null;e=true}else{if(a.fx!=null||b!=null){this.formulaList[b]=a.fx}}if(a.nf!=null||c!=null){this.numfmtList[c]=a.nf}var f=this.idsTOrows;var g=this.idsTOcols;var h=f[a.r];var i=g[a.c];if(h!=null&&i!=null){var j=f[a.r2];var l=g[a.c2];var k=1;var n=1;if(j!=null){k=j-h+1}if(l!=null){n=l-i+1}var o,r,s,w;for(o=0;o<k;o++){w=h+o-1;if(this.cells[w]==null){this.cells[w]=[]}for(r=0;r<n;r++){s=this.cells[w][i+r-1];if(s==null)
{s={}}if(b!=null){s.f=b;delete s.v}else if(d!=null){delete s.f;if(d.length>0){s.v=d}else{delete s.v}}if(e){delete s.f}s.h=a.h;if(c!=null){s.n=c}this.cells[w][i+r-1]=s}}}}
;fa.prototype.Jb=function(a){var b=[];for(var c=1;c<a.length;c++){b[a[c]]=c}return b}
;
function Ra(a){this.b=a;this.N=[];this.ids=[]}
Ra.prototype.qg=function(a,b,c,d){if(c>0&&d>0){var e=new y(this.b,b,c,d);this.N[this.N.length]=e;e.name=a;return e}else{this.b.oa("Empty sheet '"+a+"' - nothing added.");return false}}
;Ra.prototype.M=function(a){if(a<this.N.length&&a>=0){return this.N[a]}else{return null}}
;Ra.prototype.Xa=function(a,b,c){if(c==null)c=true;if(a.index!=b){var d=a.index;var e=null;if(b>d){for(var f=d;f<b;f++){e=this.N[f];this.N[f]=this.N[f+1];this.N[f].index=f;this.N[f+1]=e;e.index=f+1}}else if(b<d){for(var f=d;f>b;f--){e=this.N[f];this.N[f]=this.N[f-1];this.N[f].index=f;this.N[f-1]=e;e.index=f-1}}}var g=this.b;if(!c){b=g.activeGrid.index}g.kf(b,c)}
;Ra.prototype.yb=function(a,b){if(b==null)b=true;var c=this.b;var d=a.index-1;if(a.index==0){d=1}if(!b&&a!=c.activeGrid){d=c.activeGrid.index}c.activate(d,false,false,false,b);this.ids[a.id]=null;var e=[];var f=0;for(var g=0;g<this.N.length;g++){if(this.N[g]!=a){f=e.length;e[f]=this.N[g];e[f].index=f}}this.N=e;if(d>a.index){d--}delete a;c.kf(d,b)}
;Ra.prototype.T=function(){return this.N.length}
;
function gb(a,b,c){this.p=a;var d=a.pathImg;this.yh=this.Bj(b,c,"divIcon","divIconUp","divIconDown",d+"hyperlink.gif","hyperlink")}
gb.prototype.od=function(){var a=this.yh.style;a.display="none";a.left=0;a.top=0}
;gb.prototype.Ql=function(a){this.od();if(a.sh()){if(!a.Fh(a.activeRow,a.activeCol)){var b=this.yh;var c=a.gh(a.wa());var d=b.style;d.display="";d.left=c[0]-b.offsetWidth+1;d.top=c[1]+1;b.onclick=L(a,a.hyperlink)}}}
;gb.prototype.Bj=function(a,b,c,d,e,f,g){var h=c+" "+d;var i=v(a,b,h,0,0,"20","20");i.style.display="none";sb(a,i,f,"","width:16;top:16;",g);i.onmouseup=Rb(i,h);i.onmousedown=Rb(i,c+" "+e);return i}
;
z.HEIGHT=60;z.NUMFMT=10;z.INSERT=11;z.DELETE=12;function z(a,b,c){this.S=b;this.b=a;this.J=u.type==1;this.lk=["Format","Sort","Formulas"];this.Oc=0;var d=[];d.$i=0;d.hj=1;d.aj=2;this.Ua=d;this.ne={bold:1,italic:2,underline:3,fontfamily:4,fontsize:5,textcolor:6,bgcolor:7,border:8,clearFmt:9,wrap:13};this.Gf=null;this.divMain=null;this.Ka=null;this.sc=null;this.ca=null;this.Sh=null;this.Qh=null;this.Th=null;this.Rh=null;this.Vh=null;this.Wh=null;this.Ye=null;this.Uh=null;this.vd=5;this.Va=null;this.Ze=
null;this.$e=null;this.Yg=null;this.Zg=null;this.$g=null;this.qk(a.doc,b,c)}
z.prototype.Gk=function(){this.b.mouseSelection.Re()}
;z.prototype.qk=function(a,b,c){this.divMain=v(a,b,"menuMain",0,c,"100%",z.HEIGHT+"px");var d=this.divMain;v(a,d,"menuMainHr1",0,27,"100%","1px");var e=this.lk;var f=sa(a,d,"menuMainTbl",0,2,"","28","table");this.Ka=f;f.style.width="100%";var g=f.insertRow(0);var h=g.insertCell(0);h.innerHTML="&nbsp;";h.style.width="1%";var i,j;for(var l=0;l<e.length;l++){h=g.insertCell(l+1);j={};this.Ua[l]=j;j.head=h;j.div=v(a,d,"menuDivs",0,28,"100%","32");if(this.J){j.div.onmousemove=L(this,this.Gk)}i=j.div.style;
if(l==0){h.className="menuMainHeaderCellOn";i.visibility="visible"}else{h.className="menuMainHeaderCellOff";i.visibility="hidden"}h.innerHTML=e[l];h.style.width="1%";h.style.whiteSpace="nowrap";h.onclick=H(this,this.$l,l)}h=g.insertCell(g.cells.length);h.style.width="100%";h.style.textAlign="right";f=a.createElement("table");f.align="right";f.cellPadding=0;f.cellSpacing=0;h.appendChild(f);g=f.insertRow(0);var k=this.b;var n=k.pathImg;h=g.insertCell(0);h.style.verticalAlign="top";var o=Na(a,h,["Cut"
,"Copy","Paste","<img style='margin-top:5px' src='"+n+"buttonDownTri.gif'>"],n,18);o[0].onclick=M(k,k.copy,q.pasteCut,false);o[1].onclick=M(k,k.copy,q.pasteAll,true);o[2].onclick=H(k,k.paste,true);o[3].onclick=M(this,this.Ul,k,o[3]);i=o[3].style;i.paddingLeft="3px";i.paddingRight="3px";h=g.insertCell(1);h.innerHTML="&nbsp;";h=g.insertCell(2);h.style.verticalAlign="top";o=Na(a,h,["Undo","Redo"],n,18);o[0].onclick=H(k,k.Hd,q.undo);o[1].onclick=H(k,k.Hd,q.redo);this.Oc=0;this.Cj(a);this.Dj(a);this.Fj(
a)}
;z.prototype.Ul=function(a,b){var c=this.Uh;if(c==null){var d=[["Paste <b>values</b> only"],["Paste <b>format</b> only"]];c=new ca(a.x(),a.getDivApp(),d,false);var e=c.xa();e[0].onclick=M(a,a.paste,true,q.pasteValues);e[1].onclick=M(a,a.paste,true,q.pasteFormat);this.Uh=c}if(c.isVisible){this.s();return false}a.s();var f=Mb(b)-c.menuWidth+b.offsetWidth+3;var g=this.Ka.rows[0].offsetHeight;c.ua("",f,g+(this.J?1:-2));this.ca=c}
;z.prototype.Cj=function(a){var b=this.b;var c=b.pathImg;var d=this.Ua[this.Ua.$i].div;d.style.overflow="hidden";var e=sa(a,d,"menuMainTbl",this.vd,3,"700","20","table");e.style.tableLayout="fixed";var f=e.insertRow(0);var g=f.cells;var h,i;this.$c(a,f,g,"Choose Format",z.NUMFMT,110,c);var j=[0,1,2,3,4,5,6,22,13];for(var l=0;l<j.length;l++){h=f.insertCell(l+1);if(this.J){h.style.width="22px"}else{h.style.width="20px"}i=v(a,h,"menuToolbarCell",0,0,"18","18");i.innerHTML="<img src='"+c+"toolbarAll3.gif' style='position:absolute'>"
;i.childNodes[0].style.left=-18*j[l]}var k=this.ne;this.Kd(g[k.bold],b,"bold","Bold");this.Kd(g[k.italic],b,"italic","Italic");this.Kd(g[k.underline],b,"underline","Underline");this.Bc(g[k.fontfamily],m.FONT,"Font Family");this.Bc(g[k.fontsize],m.SIZE,"Font Size");this.Bc(g[k.textcolor],m.FCOLOR,"Text Color");this.Bc(g[k.bgcolor],m.BGCOLOR,"Background Color");this.Bc(g[k.border],m.BORDER,"Borders");g[k.clearFmt].onclick=L(b,b.wj);g[k.clearFmt].title="Clear Format";this.$c(a,f,g,"Align",m.ALIGN,60,
c);this.$c(a,f,g,"Insert",z.INSERT,60,c);this.$c(a,f,g,"Delete",z.DELETE,60,c);h=f.insertCell(g.length);h.className="menuCheckbox";if(!this.J){h.style.width="90px"}pa(a,h,"","","relative",0,0,"","",100,"checkbox");h.appendChild(a.createTextNode(" Wrap Text"));this.Kd(h,b,"wrap","Wrap Text");h=f.insertCell(g.length);h.className="mergeButton";var n="<table id=mergeTable class=inactive><tr class=top>";n+="<td class=r height=4 width=3></td><td class=r></td>";n+="<td class=r></td><td width=4></td></tr><tr><td class=r></td>"
;n+="<td class=r2><div id=mergeWord1 class=word>Merge</div></td>";n+="<td class=r><div id=mergeWord2 class=word>across</div></td>";n+="<td></td></tr><tr class=bottom><td class=r height=3></td>";n+="<td class=r></td><td class=r></td><td></td></tr></table>";h.innerHTML=n;this.Va=a.getElementById("mergeTable");this.Ze=a.getElementById("mergeWord1");this.$e=a.getElementById("mergeWord2");h.onclick=L(this,this.Dk);this.Gf=g;this.sc=new m(b,this.S,0,c)}
;z.prototype.$c=function(a,b,c,d,e,f,g){var h=b.insertCell(c.length);var i=Na(a,h,[d+" <img src='"+g+"buttonDownTri.gif'>"],g,18);i[0].onclick=M(this,this.Pi,e,h);h.style.width=f}
;z.prototype.Kd=function(a,b,c,d){a.onclick=H(b,b.Rc,c);a.title=d}
;z.prototype.Bc=function(a,b,c){a.onclick=M(this,this.Pi,b,a);a.title=c}
;z.prototype.Dj=function(a){var b=this.b;var c=this.Ua[this.Ua.aj].div;var d=sa(a,c,"menuMainTbl",this.vd,3,"100%","20","table");d.style.tableLayout="fixed";var e=d.insertRow(0);var f=e.insertCell(0);this.Zg=V(a,f,"A1","");this.$g=V(a,f,"","");f.className="menuMainFormu";f.onclick=L(b,b.ij);this.Yg=f;f=e.insertCell(1);var g=f.style;g.textAlign="right";g.borderLeft="solid #ebf2fe 1px";var h=["Sum","Count","Average","Min","Max","Product","<b>more&raquo;</b>"];for(var i=1;i<=h.length;i++){var j=V(a,
f,h[i-1],"menuMainLink");if(i==h.length){j.onclick=L(b,b.Pl)}else{j.onclick=H(b,b.Eh,h[i-1])}}g.paddingRight="6px";g.width="320px"}
;z.prototype.Ld=function(a,b){var c=this.Zg;var d=this.$g;if(b==null){c.innerHTML=" ";d.innerHTML=" "}else{c.innerHTML=a;X(this.b.x(),d,b)}}
;z.prototype.Vg=function(a){if(!this.J){var b=this.Yg;b.style.width=a?b.offsetWidth:""}}
;z.prototype.Fj=function(a){var b=this.b;var c=b.pathImg;var d=this.Ua[this.Ua.hj].div;d.style.overflow="hidden";var e=sa(a,d,"menuMainTbl",this.vd,3,"500","20","table");var f=e.insertRow(0);var g=0;var h=f.insertCell(g);var i=h.style;i.borderRight="#fff solid 1px";i.verticalAlign="bottom";var j=Na(a,h,["Freeze rows <img src='"+b.pathImg+"buttonDownTri.gif'>"],c,18);j[0].onclick=M(this,this.Ol,15,b);j[0].title="Frozen rows will remain visible as you scroll, and will not be moved when you sort.";g++
;h=f.insertCell(g);h.innerHTML="<b>Sort</b> sheet by <b>Selected Column </b>";h.className="menuMainLabel";i=h.style;i.fontWeight="normal";i.verticalAlign="bottom";i.paddingLeft="20px";j=Na(a,h,["A &rarr; Z","Z &rarr; A"],c,18);j[0].onclick=H(b,b.Id,1);j[1].onclick=H(b,b.Id,0)}
;z.prototype.Mi=function(a,b){if(a==null){this.lf()}else{var c=Vb;var d=this.ne;var e=this.Gf;e[d.bold].className=Yb(a)?"menuSel":"";e[d.italic].className=Zb(a)?"menuSel":"";e[d.underline].className=$b(a)?"menuSel":"";var f=U(a,"whiteSpace","white-space");var g=e[d.wrap].childNodes[0];if(f==="normal"){g.checked=true}else{g.checked=false}var h=a.colSpan;var i=this.Va.className;if(h>1&&h==b.colsSelected){if(i!="apart"){this.Va.className="apart";this.Ze.innerHTML="Break";this.$e.innerHTML="apart";c=
"Selected cell will be broken apart"}}else{if(i=="apart"){this.Ze.innerHTML="Merge";this.$e.innerHTML="across"}if(b.colsSelected>1){this.Va.className="active";c="Selected cells will be merged into one cell"}else{this.Va.className="inactive"}}this.Va.title=c}}
;z.prototype.lf=function(a){var b=this.ne;var c=this.Gf;c[b.bold].className="";c[b.italic].className="";c[b.underline].className="";c[b.wrap].checked=false;if(a!=false){this.Va.className="inactive";this.Va.title=Vb}}
;z.prototype.s=function(){if(this.sc!=null){this.sc.close()}if(this.ca!=null){this.ca.ua("none");this.ca=null}}
;z.prototype.Dk=function(){var a=this.b;var b=this.Va.className;if(b==="active"){a.merge(true)}else if(b==="apart"){a.merge(false)}}
;z.prototype.te=function(a,b){var c=null;if(a==1){c=[["Cut"],["Copy"],["Paste"],,["Insert left"],["Insert right"],,["Delete column(s)"],["Clear column(s)"],,["Sort A &rarr; Z"],["Sort Z &rarr; A"]]}else if(a==2){c=[["Cut"],["Copy"],["Paste"],,["Insert above"],["Insert below"],,["Delete row(s)"],["Clear row(s)"]]}else{c=[["Cut"],["Copy"],["Paste"],,["Clear selection"]]}var d=new ca(b.x(),b.getDivApp(),c,false);var e=d.xa();e[0].onclick=M(b,b.copy,q.pasteCut,false);e[1].onclick=M(b,b.copy,q.pasteAll,
true);e[2].onclick=H(b,b.paste,true);var f=8;if(a==1){e[4].onclick=M(b,b.W,q.colInsert,false);e[5].onclick=M(b,b.W,q.colInsertAfter,false);e[7].onclick=H(b,b.W,q.colDelete);e[10].onclick=H(b,b.Id,1);e[11].onclick=H(b,b.Id,0)}else if(a==2){e[4].onclick=M(b,b.W,q.rowInsert,false);e[5].onclick=M(b,b.W,q.rowInsertAfter,false);e[7].onclick=H(b,b.W,q.rowDelete)}else{f=4}e[f].onclick=L(b,b.Eg);return d}
;z.prototype.Xl=function(a,b){var c=this.b;var d=c.activeGrid;var e=d.rowsSelected;var f=d.colsSelected;var g=d.numCols==f;var h=d.numRows==e;if(c.eb()){return false}if(g&&h){g=false;h=false}if(this.Ye==null){this.Ye=this.te(0,c);this.Vh=this.te(1,c);this.Wh=this.te(2,c)}var i=this.Ye;if(g){i=this.Wh;var j=d.topLeftRow;var l="";if(e>1){l="s "+j+" - "+(j+e-1)}e=e>1?e:"";i.y(4,"Insert "+e+" above");i.y(5,"Insert "+e+" below");i.y(7,"Delete row"+l);i.y(8,"Clear row"+l)}else if(h){i=this.Vh;var k=d.topLeftCol;
var l="";if(f>1){l="s "+P(k)+" - "+P(k+f-1)}f=f>1?f:"";i.y(4,"Insert "+f+" left");i.y(5,"Insert "+f+" right");i.y(7,"Delete column"+l);i.y(8,"Clear column"+l)}if(i.isVisible){this.s();return false}c.s();var n=a+35+5;if(a>d.mainGridWid-i.menuWidth){n-=i.menuWidth+10}var o=this.divMain;var r=b+o.offsetTop+o.offsetHeight+20;if(b>d.mainGridHei-i.menuHeight+d.freezeHeight){r-=i.menuHeight}i.ua("",n,r);this.ca=i}
;z.prototype.Rl=function(a,b){var c=this.Sh;if(c==null){var d=null;d=[["Row <b>Above</b>"],["Row <b>Below</b>"],["1"],["2"],,["Column <b>Left</b>"],["Column <b>Right</b>"],["3"],["4"]];c=new ca(b.x(),b.getDivApp(),d,false);var e=c.xa();e[0].onclick=M(b,b.W,q.rowInsert,true);e[1].onclick=M(b,b.W,q.rowInsertAfter,true);e[2].onclick=H(b,b.W,q.rowInsert);e[3].onclick=H(b,b.W,q.rowInsertAfter);e[5].onclick=M(b,b.W,q.colInsert,true);e[6].onclick=M(b,b.W,q.colInsertAfter,true);e[7].onclick=H(b,b.W,q.colInsert)
;e[8].onclick=H(b,b.W,q.colInsertAfter);this.Sh=c}if(c.isVisible){this.s();return false}var f=b.activeGrid;var g=f.rowsSelected;var h=f.colsSelected;var i=g!=f.numRows&&h==f.numCols;var j=g==f.numRows&&h!=f.numCols;c.y(0," Row <b>Above</b>");c.y(1," Row <b>Below</b>");c.y(2,g+" Rows <b>Above</b>");c.y(3,g+" Rows <b>Below</b>");c.y(5," Column <b>Left</b>");c.y(6," Column <b>Right</b>");c.y(7,h+" Columns <b>Left</b>");c.y(8,h+" Columns <b>Right</b>");if(i){c.y(5,null);c.y(6,null);c.y(7,null);c.y(8,
null)}else if(j){c.y(0,null);c.y(1,null);c.y(2,null);c.y(3,null)}if(g==1){c.y(2,null);c.y(3,null)}if(h==1){c.y(7,null);c.y(8,null)}b.s();var l=this.divMain;c.ua("",a,l.offsetTop+l.offsetHeight-2);this.ca=c}
;z.prototype.Nl=function(a,b){var c=b.activeGrid;var d=this.Qh;if(d==null){var e=[["1"],["2"],["Clear Selection"]];d=new ca(b.x(),b.getDivApp(),e,false);var f=d.xa();f[0].onclick=H(b,b.W,q.rowDelete);f[1].onclick=H(b,b.W,q.colDelete);f[2].onclick=L(b,b.Eg);this.Qh=d}if(d.isVisible){this.s();return false}var g=c.topLeftRow;var h=c.topLeftCol;var i=c.rowsSelected;var j=c.colsSelected;var l;if(i>1){l="s "+g+" - "+(g+i-1)}else{l=" "+g}d.y(0,"Delete <b>Row"+l+"</b>");var k=P(h);if(j>1){l="s "+k+" - "+
P(h+j-1)}else{l=" "+k}d.y(1,"Delete <b>Column"+l+"</b>");b.s();var n=this.divMain;d.ua("",a,n.offsetTop+n.offsetHeight-2);this.ca=d}
;z.prototype.bh=function(a){var b=this.b;b.activeGrid.Ke(a);b.A(true,true)}
;z.prototype.Ol=function(a,b){var c=this.Rh;if(c==null){var d=[["Unfreeze"],,["1 row"],["2 rows"],["3 rows"],["4 rows"],["5 rows"]];c=new ca(b.x(),b.getDivApp(),d,false);var e=c.xa();e[0].onclick=H(this,this.bh,0);for(var f=2;f<d.length;f++){e[f].onclick=H(this,this.bh,f-1)}this.Rh=c}if(c.isVisible){this.s();return false}b.s();var g=this.divMain;c.ua("",a,g.offsetTop+g.offsetHeight-2);this.ca=c}
;z.prototype.Sl=function(a,b){var c=this.Th;if(c==null){var d=[["Normal",,"#.###############"],,["1,000","Rounded","#,##0"],["1,000.12","2 Decimals","#,##0.00"],,["(1,000)","Financial rounded","#,##0;(#,##0)"],["(1,000.12)","Financial","#,##0.00;(#,##0.00)"],,["$1,000","Dollar","$#,##0"],["$1,000.12","Dollar and cents","$#,##0.00"],,["10%","Percent rounded","0%"],["10.12%","Percent","0.00%"],,["3/24/2006","Date","M/d/yyyy"],["24-Mar-2006","Date","d-MMM-yyyy"],["3:59:00","Time","H:mm:ss"],["3/24/2006 3:59:00"
,"Date time","M/d/yyyy H:mm:ss"],,["Plain text",,"@STRING@"]];c=new ca(b.x(),b.getDivApp(),d,true);var e=c.xa();for(var f=0;f<d.length;f++){if(d[f]!=null){e[f].onclick=H(this,this.nj,d[f][2])}}this.Th=c}if(c.isVisible){this.s();return false}b.s();var g=this.divMain;c.ua("",a,g.offsetTop+g.offsetHeight-2);this.ca=c}
;z.prototype.nj=function(a){var b=this.b;b.activeGrid.jb(q.numberFormat,a,Q);b.A()}
;z.prototype.Pi=function(a,b){var c=this.b;if(c.X(true)){var d=b.offsetLeft+this.vd;if(a==z.NUMFMT){this.Sl(d,c)}else if(a==z.INSERT){this.Rl(d,c)}else if(a==z.DELETE){this.Nl(d,c)}else{var e=this.sc;var f=e.$j()==a;if(e.yk()){c.s()}else if(this.ca!=null){c.s();f=false}else{c.s(this);f=false}if(!f){e.zl(Math.max(0,a),a);var g="color";if(a==m.BGCOLOR){g="backgroundColor"}else if(a==m.FONT){g="fontFamily"}else if(a==m.SIZE){g="fontSize"}else if(a==m.BORDER){g="borders"}else if(a==m.ALIGN){g="align"
}e.open(d,this.divMain.offsetHeight,g)}}c.A(false,true)}else{c.A()}}
;z.prototype.wb=function(a,b){var c=this.b;if(b=="fontSize"){c.activeGrid.ja(b,a+"0%")}else if(b=="borders"){c.activeGrid.jb(q.borders,a,Q)}else{c.activeGrid.ja(b,a)}c.A()}
;z.prototype.$l=function(a){var b=this.b;if(b.modalDbox==null){b.s();if(this.Oc!=a){var c=this.Ua[this.Oc];var d=this.Ua[a];c.head.className="menuMainHeaderCellOff";c.div.style.visibility="hidden";d.head.className="menuMainHeaderCellOn";d.div.style.visibility="visible";this.Oc=a}b.A()}}
;z.prototype.cleanup=function(){if(this.divMain!=null){this.divMain.innerHTML=""}this.sc=null}
;
function Z(a,b,c,d,e,f){this.Zb=1;this.b=a;var g=a.x();this.ca=null;this.Hb=b;var h=v(g,b,"toolOuter",c,d,e,f);this.Ce=h;V(g,h,"&nbsp;&nbsp;","");var i=Na(g,h,["Add Sheet"],a.pathImg,"");i[0].onclick=L(a,a.vc);var c=i[0].offsetWidth+20;this.Kh=c;this.addButton=i;this.Mj=v(g,h,"toolArrows",-1,0,"7px","100%");this.Mj.innerHTML="<b>&nbsp</b>";var j=h.offsetWidth;var l=j-13-2;this.divButtonContent=v(g,h,"toolContent",c,0,l-7-c+"px","80%");var k=da(g,this.divButtonContent,"toolTable","");this.toolTDs=
k.insertRow(0);this.cb=v(g,h,"toolArrows",l,0,"13px","50%");this.cb.innerHTML="<b>></b>";this.bb=v(g,h,"toolArrows",l,h.offsetHeight/2,"13px","50%");this.bb.innerHTML="<b><</b>";this.bi=p.createAdapter(this,this.Qk);p.addBuiltInListener(this.bb,"mouseover",this.bi);this.ci=p.createAdapter(this,this.Rk);p.addBuiltInListener(this.cb,"mouseover",this.ci);this.li=p.createAdapter(this,this.Nk);p.addBuiltInListener(this.bb,"mouseout",this.li);this.mi=p.createAdapter(this,this.Ok);p.addBuiltInListener(this.cb,
"mouseout",this.mi);this.Bd=p.createAdapter(this,this.yc);p.addBuiltInListener(this.bb,"mousedown",this.Bd);p.addBuiltInListener(this.cb,"mousedown",this.Bd);this.nc=0;this.rd=null}
Z.prototype.clear=function(a){if(a==true){var b=this.toolTDs.cells.length;for(var c=0;c<b;c++){this.toolTDs.deleteCell(0)}}else{this.Ce.innerHTML="";this.Ce=null}}
;Z.prototype.Lj=function(a,b){var c=this.b;if(!c.X(false))return false;var d=this.ca;if(d==null){var e=[["Delete"],["Rename"],,[3],[4]];d=new ca(c.x(),c.getDivApp(),e,false);var f=d.xa();f[0].onclick=L(c,c.yb);f[1].onclick=L(c,c.Wb);this.ca=d}if(d.isVisible){this.s()}else{c.s();var g=d.menuHeight/4;var h=g*2;d.y(3,null);d.y(4,null);var i=c.grids.T();if(i>1){var j=c.activeGrid.index;var f=d.xa();if(j<i-1){d.y(4,"Move right &raquo;");f[4].onclick=M(c,c.Xa,null,c.M(j+1).id);h+=g}if(j>0){d.y(3,"&laquo; Move left"
);f[3].onclick=M(c,c.Xa,null,j<2?-1:c.M(j-2).id);h+=g}}h=this.Hb.offsetTop-h;if(u.os==2){h-=this.b.activeGrid.scrollDepth}d.ua("",this.Kh+Math.max(0,b.offsetLeft-this.divButtonContent.scrollLeft),h)}c.A(false,true)}
;Z.prototype.s=function(){if(this.ca!=null){this.ca.ua("none")}}
;Z.prototype.ik=function(){return this.toolTDs}
;Z.prototype.sg=function(a,b,c){var d=this.toolTDs.cells.length;this.toolTDs.insertCell(d);var e=this.toolTDs.cells[d];e.innerHTML=a+"<img id='tri' src='"+this.b.pathImg+"buttonDownTriBlue.gif'>";e.className=b;if(c&&d+1>1){this.toolTDs.insertCell(d);this.toolTDs.cells[d].innerHTML="|";e=this.toolTDs.cells[d+1]}else{e=this.toolTDs.cells[d]}return e}
;Z.prototype.ll=function(){var a=this.Ce.offsetWidth;var b=a-13-2;this.divButtonContent.style.width=b-7-this.Kh;this.cb.style.left=b;this.bb.style.left=b}
;Z.prototype.Di=function(){this.divButtonContent.scrollLeft=this.divButtonContent.scrollLeft+1*this.Zb*this.nc}
;Z.prototype.Qk=function(a){this.s();this.Zb=1;this.nc=-1;this.rd=fc(this,this.Di,10)}
;Z.prototype.Rk=function(a){this.s();this.Zb=1;this.nc=1;this.rd=fc(this,this.Di,10)}
;Z.prototype.Nk=function(a){clearInterval(this.rd);this.nc=0}
;Z.prototype.Ok=function(a){clearInterval(this.rd);this.nc=0}
;Z.prototype.yc=function(a){if(this.Zb<4){this.Zb++}else{this.Zb=1}}
;Z.prototype.cleanup=function(){p.removeBuiltInListener(this.bb,"mouseover",this.bi);p.removeBuiltInListener(this.cb,"mouseover",this.ci);p.removeBuiltInListener(this.bb,"mouseout",this.li);p.removeBuiltInListener(this.cb,"mouseout",this.mi);p.removeBuiltInListener(this.bb,"mousedown",this.Bd);p.removeBuiltInListener(this.cb,"mousedown",this.Bd)}
;
function E(a){this.b=a;var b=a.x();if(u.type==1||u.firefox&&u.version!=1.07){this.ei=p.createAdapter(a,a.s);p.addBuiltInListener(b.body,"mouseup",this.ei)}this.uc=false;this.Ib=null;this.P=false;this.kc=null;this.R=0;this.sa=0;this.z=0;this.mouseRight=false;this.C=0;this.D=0;this.Wa=0;this.Ba=0;this.V=0;this.Ai=0;this.Bi=0;this.za=null;this.ha=v(this.b.doc,this.b.divGrids,"divRCResize",0,0,0,0);this.ha.style.visibility="hidden";this.fb=false;this.Ga=0;this.Yb=0;this.Pg=p.createAdapter(this,this.Kk)
;this.Ci=p.createAdapter(this,this.Uk);this.mouseDownHandler=p.createAdapter(this,this.yc);this.gb=p.createAdapter(this,this.df);this.yd=p.createAdapter(this,this.Tk);this.Aa=p.createAdapter(this,this.Sb);this.Zh=p.createAdapter(this,this.Mk);this.fi=p.createAdapter(this,this.ni);this.$h=p.createAdapter(this,this.ki);if(u.type==1){b.oncontextmenu=function(){N(null)}
}else{b.oncontextmenu=function(){return false}
;p.bindDom(this.b.sb(),"mouseout",this,this.Wk)}p.addBuiltInListener(this.ha,"mousedown",this.Zh);p.addBuiltInListener(this.ha,"mouseup",this.fi);p.addBuiltInListener(this.ha,"mousemove",this.$h)}
E.prototype.Bl=function(a,b){p.addBuiltInListener(b,"dblclick",this.Pg);p.addBuiltInListener(a.divMain,"scroll",this.Ci);p.addBuiltInListener(b,"mousedown",this.mouseDownHandler);if(b.setCapture){p.addBuiltInListener(b,"mousemove",this.gb);p.addBuiltInListener(b,"mouseup",this.Aa)}else{var c=this.b.sb();p.addBuiltInListener(c,"mousemove",this.gb);p.addBuiltInListener(c,"mouseup",this.Aa)}a.rowHObj.je(this);a.colHObj.je(this);if(u.type==1){p.addBuiltInListener(b,"mousewheel",this.yd)}else{p.addBuiltInListener(
b,"DOMMouseScroll",this.yd)}}
;E.prototype.Kk=function(a){var b=this.b;if(!b.cellSelection.rc()&&b.modalDbox==null&&b.mode<=0){var c=this.b.cellSelection;c.La(true);c.F2OrMouse=true}}
;E.prototype.Uk=function(a){this.b.iconManager.od();var b=this.db(true);b.Li(b.wa(),500,true);if(this.z==0){var c=this.b.cellSelection;if(c.isEditBoxActive){c.Dc()}var d=b.divMain.scrollLeft;var e=b.divMain.scrollTop;b.colHObj.na(d);b.rowHObj.na(e);b.Oe().na(d,e);this.Ba=-d;this.V=-e;c.A();return false}}
;E.prototype.Wk=function(a){if(!a.relatedTarget&&this.z===1){this.Sb(a)}}
;E.prototype.Fl=function(a){this.Ba=-a.divMain.scrollLeft;this.V=-a.divMain.scrollTop}
;E.prototype.Tk=function(a){this.z=9;var b=this.db(true);if(this.P){this.b.cellSelection.Dc()}var c=a.wheelDelta;if(!c){c=-a.detail}if(c>0){this.V=Math.min(this.V+b.mainGridHei*0.05,0)}else{this.V=Math.max(this.V-b.mainGridHei*0.05,-2000000)}this.af(b);N(a);this.z=0}
;E.prototype.pc=function(a,b){var c=0;var d=0;var e=b.divMain;if(u.type==1){c=a.offsetX-e.offsetLeft+e.scrollLeft;d=a.offsetY-e.offsetTop+e.scrollTop}else{if(a.target===b.divTop){c=a.layerX-e.offsetLeft+e.scrollLeft;d=a.layerY-e.offsetTop+e.scrollTop}else{c=a.screenX-this.Ai-e.offsetLeft+e.scrollLeft;d=a.screenY-this.Bi-e.offsetTop+e.scrollTop}}if(d<e.scrollTop){d-=e.scrollTop}return[c,d]}
;E.prototype.ka=function(a,b,c,d){try{var e=a.j();if(d==2){e=a.rowHObj}var f,g,h,i,j;if(d==1){i=1}else if(c<0&&a.freezeRow>0){c+=a.freezeHeight;for(h=1;h<=a.freezeRow&&i==null;h++){f=e.e(h);if(U(f,"display","display")!="none"){if(c<e.K(f)+f.offsetHeight){i=h}}}}else{var l=a.freezeRow+1;f=e.e(l);while(U(f,"display","display")=="none"){l++;f=e.e(l)}if(c<e.K(f)+f.offsetHeight){i=l}else{var k=a.numRows;f=e.e(k);while(U(f,"display","display")=="none"){k--;f=e.e(k)}if(c>e.K(f)){i=k}else{i=null;var n,o;
while(i==null){n=Math.round((k+l)/2);o=n;f=e.e(o);while(U(f,"display","display")=="none"){o++;f=e.e(o)}if(c<e.K(f)){k=n-1}else if(c>e.K(f)+f.offsetHeight){l=o+1}else{i=o}}}}}if(d==2){j=1}else{h=2;j=h;var r=true;f=e.e(0);var s=f.cells;while(r&&h<s.length){g=s[h];if(U(g,"display","display")=="none"){h++}else if(b<=g.offsetLeft){r=false}else{h++;j=h}}j--}if(d==null||d==0){g=e.e(i).cells[j];var w=Ha(g,a,false);if(w!=null){j=w}}return[i,j]}catch(C){return null}}
;E.prototype.db=function(a){var b=this.b.activeGrid;if(a){this.P=this.b.cellSelection.rc()}if(this.P){if(this.b.activeFormuGrid==null){this.b.activeFormuGrid=this.b.activeGrid}b=this.b.activeFormuGrid;this.Ib=b.divFormulas;this.kc=this.b.cellSelection.Mb()}else{this.Ib=b.divSelection;this.kc=null}return b}
;E.prototype.Ac=function(a,b,c){var d=this.b.x();var e=this.kc;var f=this.hk(a,b,c);if(e.selectionStart){var g=e.selectionStart;var h=e.selectionEnd;var i=e.value;e.value=i.substring(0,g)+f+i.substring(h);e.setSelectionRange(g,g+f.length);e.focus()}else if(d.selection){e.focus();var j=d.selection.createRange();if(j.text.length==0){j.text=" ";j.moveStart("character",-1);j.moveEnd("textedit");j.select();j=d.selection.createRange();j.text=f}else{j.text=f}}this.b.cellSelection.Xb()}
;E.prototype.uf=function(){var a=this.b.x();var b=this.kc;if(b.selectionStart){var c=b.selectionEnd;b.setSelectionRange(c,c);b.focus()}else if(a.selection){var d=a.selection.createRange();if(d.text.length==0){d=b.createTextRange();d.moveEnd("character",0)}d.collapse(false);d.select()}}
;E.prototype.hk=function(a,b,c){var d=null;if(this.z===2){var e=this.ka(a,this.C,this.D);var f=b[1];if(a.freezeRow==0){f=Math.max(0,f)}else if(c!=null){f=c}var g=this.ka(a,b[0],f);if(e[0]==g[0]&&e[1]==g[1]){d=P(g[1])+g[0]}else{var h=Math.min(e[0],g[0]);var i=Math.min(e[1],g[1]);var j=Math.max(e[0],g[0]);var l=Math.max(e[1],g[1]);d=P(i)+h+":"+P(l)+j}}else if(this.z===4){var k=Math.min(this.R,this.sa);var n=Math.max(this.R,this.sa);d=P(k)+":"+P(n)}else if(this.z===3){var k=Math.min(this.R,this.sa);
var n=Math.max(this.R,this.sa);d=k+":"+n}else{d=this.R+":"+this.sa}if(this.b.activeFormuGrid!=this.b.activeGrid){if(a.name.indexOf(" ")>-1){d="'"+a.name+"'!"+d}else{d=a.name+"!"+d}}return d}
;E.prototype.Ab=function(a,b,c,d,e,f,g){this.R=a;this.sa=b;g.Qj(c,d,e,f,this.Ib)}
;E.prototype.Ak=function(a){if(!this.P){if(u.type==1&&(a.button==2||a.button==3)){return true}else if(a.which==2||a.which==3){return true}}return false}
;E.prototype.fh=function(a,b,c){var d=a.j();var e=d.e(b);var f=d.K(e)+(b>a.freezeRow?a.freezeHeight:0);if(c==true){return f+e.offsetHeight}return f}
;E.prototype.xk=function(a,b){if(a.yg()){var c=a.rowsSelected;var d=a.colsSelected;var e=a.numCols==d;var f=a.numRows==c;if(e&&f){return true}var g=b[1]+a.freezeHeight;var h=b[0];var i=a.topLeftRow;var j=this.fh(a,i);var l=this.fh(a,i+c-1,true);var k=a.divSelection;var n=k.offsetLeft;var o=n<h&&n+k.offsetWidth>h;var r=j<g&&l>g;return e&&r||f&&o||r&&o}return false}
;E.prototype.yc=function(a){this.mouseRight=false;var b=this.db(true);var c=this.b;this.za=ka(this.za);if(!this.P){c.cellSelection.fa(true)}if(c.modalDbox==null){var d=this.pc(a,b);if(this.Ak(a)){this.mouseRight=true;if(this.xk(b,d)){N(a);return false}}this.uc=true;var e=d[0]<b.divMain.scrollLeft;var f=d[1]<-b.freezeHeight;if(c.isPanningOn&&!this.P){if(e&&f){}else{if(a.button==0||a.button==1){this.C=a.screenX;this.D=a.screenY;this.Wa=(new Date).getTime();this.z=1}var g=this.ka(b,d[0],d[1]);if(g!=
null){b.F(g[0],g[1],true)}}}else{var h=e&&f;var i=b.j();if(h){if(this.P){this.Ab(1,b.numRows,0,0,i.rb(),i.Fa(),b)}else{c.cellSelection.Fi();c.copyPaste.Zc(b)}}else if(e){if(d[1]>0){var g=this.ka(b,1,d[1]);if(this.P){var j=b.rowHObj;var l=j.e(g[0]);this.Ab(g[0],g[0],0,j.K(l),i.rb(),l.offsetHeight,b)}else{b.F(g[0],g[1],true);c.cellSelection.vf()}this.z=3}}else if(f){var g=this.ka(b,d[0],1);if(this.P){var k=b.colHObj.Pa(g[1]);this.Ab(g[1],g[1],k.offsetLeft,0,k.offsetWidth,i.Fa(),b)}else{b.F(g[0],g[1]
,true);c.cellSelection.tf()}this.z=4}else{if(!this.P){b.ya(1)}this.C=d[0];this.D=d[1];this.se(b,d[0],d[1],1,1,this.Ib);this.z=2}if(this.P){if(a.shiftKey){this.kc.value+=":";this.uf()}this.Ac(b,d);if(h){this.uf()}}}}if(b.divTop.setCapture){b.divTop.setCapture()}else{this.Ai=a.screenX-a.layerX;this.Bi=a.screenY-a.layerY}N(a);c.A();return false}
;E.prototype.Sb=function(a){this.uc=false;var b=this.db(false);var c=this.b;b.divTop.style.cursor="default";if(a.target!==b.divTop&&u.type==1){b.divTop.fireEvent("onmouseup")}else{if(this.z===1){this.rh(b,a);c.copyPaste.Zc(b);if(a.ctrlKey){b.hyperlink()}}else if(this.z===8){this.ni(a)}else{if(this.z===2||this.z===3||this.z===4){var d=this.pc(a,b);if(this.P){b.ya(3);this.Ac(b,d);this.uf()}else{if(this.z===2){if(a.shiftKey&&b.topLeftRow!=null){this.C=b.colHObj.Pa(b.topLeftCol).offsetLeft+2;var e=b.rowHObj;
this.D=e.K(e.e(b.topLeftRow))+2}var f=Math.min(d[0],this.C);var g=Math.min(d[1],this.D);var h=Math.max(d[0],this.C);var i=Math.max(d[1],this.D);var j=this.ka(b,f,g);if(j!=null){var l=this.ka(b,h,i);b.activeRow=j[0];b.activeCol=j[1];b.da(b.activeRow,b.activeCol,l[0],l[1],true)}else{this.zi(b,d)}if(a.ctrlKey){b.hyperlink()}}c.copyPaste.Zc(b)}}}this.za=ka(this.za);this.z=0;if(this.mouseRight){this.mouseRight=false;var k=this.pc(a,b);var n=b.divMain;var o=Math.max(0,k[0]-n.scrollLeft);var r=Math.max(
0,k[1]-n.scrollTop+b.freezeHeight);c.menuMain.Xl(o,r)}if(c.x().releaseCapture){c.x().releaseCapture()}N(a);return false}}
;E.prototype.df=function(a){if(this.uc){var b=this.db(false);if(a.target!==b.divTop&&u.type==1){b.divTop.fireEvent("onmousemove")}else{if(this.z===1){var c=(new Date).getTime();if(c-this.Wa>20){this.Wa=c;this.rh(b,a)}N(a);return false}else if(this.z===8){this.ki(a)}else{if(this.z===2||this.z===3||this.z===4){this.za=ka(this.za);var d=this.pc(a,b);if(this.z===2){var e=this.oh(b,d);if(e[0]!=0||e[1]!=0){var f=d[1];this.Rg(Va(e[1]),Va(e[0]),d,f);this.za=Pa(this,this.Rg,250,e[1],e[0],d,f)}else{this.se(
b,Math.min(this.C,d[0]),Math.min(this.D,d[1]),Math.abs(d[0]-this.C),Math.abs(d[1]-this.D),this.Ib)}}else{this.zi(b,d)}if(this.P){this.b.cellSelection.Dc();this.Ac(b,d)}N(a);return false}}}}else{this.Wl(a)}}
;E.prototype.se=function(a,b,c,d,e,f){var g=a.freezeHeight;var h=this.D;if(c==null){c=f.offsetTop}c=Math.max(-g,c);if(c<0){this.Ei(a)}if(e==null){e=g+h}if(b==null){b=f.offsetLeft}if(d==null){d=this.C}var i=this.ka(a,b,c,0);var j=this.ka(a,b+d,c+e,0);a.Fe(i[0],i[1],j[0],j[1],f)}
;E.prototype.Ei=function(a){this.V=0;a.divMain.scrollTop=0;a.rowHObj.na(0);a.Oe().na(null,0)}
;E.prototype.zi=function(a,b){var c=this.oh(a,b);if(this.z===3){if(c[1]==0){var d=this.ka(a,a.j().rb(),b[1]);if(this.P){var e=a.rowHObj;var f=e.e(Math.min(this.R,d[0]));var g=e.e(Math.max(this.R,d[0]));var h=e.K(f);this.Ab(this.R,d[0],0,h,a.j().rb(),e.K(g)+g.offsetHeight-h,a)}else{a.da(a.activeRow,a.activeCol,d[0],d[1])}}else{if(this.P){this.dd(Va(c[1]),0);this.za=Pa(this,this.dd,250,c[1],0)}else{this.ed(Va(c[1]),0);this.za=Pa(this,this.ed,250,c[1],0)}}}else if(this.z===4){if(c[0]==0){var d=this.ka(
a,b[0],a.j().Fa());if(this.P){var i=a.colHObj;var j=i.Pa(Math.min(this.R,d[1]));var l=i.Pa(Math.max(this.R,d[1]));this.Ab(this.R,d[1],j.offsetLeft,0,l.offsetLeft+l.offsetWidth-j.offsetLeft,a.j().Fa(),a)}else{a.da(a.activeRow,a.activeCol,d[0],d[1])}}else{if(this.P){this.dd(0,Va(c[0]));this.za=Pa(this,this.dd,250,0,c[0])}else{this.ed(0,Va(c[0]));this.za=Pa(this,this.ed,250,0,c[0])}}}}
;E.prototype.Rg=function(a,b,c,d){var e=this.db(false);var f=this.Ib;var g,h,i,j;this.Ba=-e.divMain.scrollLeft;this.V=-e.divMain.scrollTop;if(b==0){g=Math.min(this.C,c[0]);i=Math.abs(c[0]-this.C)}else{var l=f.offsetWidth+b*20;var k=l+f.offsetLeft;if(b>0){if(k<e.j().rb()){var n=b*20;if(c[0]<this.C){g=f.offsetLeft+n;i=f.offsetWidth-n;this.Ba=-f.offsetLeft+e.mainGridWid-50}else{this.Ba=-k+e.mainGridWid-100;i=l}c[0]=c[0]+n}else{i=f.offsetWidth}}else if(b<0){var n=-b*20;if(c[0]<this.C){if(f.offsetLeft-
n>0){g=f.offsetLeft-n;i=f.offsetWidth+n;this.Ba=-f.offsetLeft+50}}else{i=l;this.Ba=-k+50}c[0]=c[0]-n}}if(a==0){h=Math.min(this.D,c[1]);j=Math.abs(c[1]-this.D)}else{var o=f.offsetHeight+a*10;var r=o+f.offsetTop;if(a>0){if(r<e.j().Fa()){var n=a*10;if(c[1]<this.D){h=f.offsetTop+n;j=f.offsetHeight-n;this.V=-f.offsetTop+e.mainGridHei-50}else{this.V=-r+e.mainGridHei-50;j=o}c[1]=c[1]+n}else{j=f.offsetHeight}}else if(a<0){var n=-a*10;if(c[1]<this.D){if(f.offsetTop-n>0){h=f.offsetTop-n;j=f.offsetHeight+n;
this.V=-f.offsetTop+25}}else{j=o;this.V=-r+25}c[1]=c[1]-n}}if(e.freezeRow>0&&d<0&&this.V==0){h=d}else{d=null}this.se(e,g,h,i,j,f);this.af(e);if(this.P){this.Ac(e,c,d)}}
;E.prototype.ed=function(a,b){var c=this.b.activeGrid;var d=c.activeRow+c.rowsSelected-1;var e=c.activeCol+c.colsSelected-1;if(this.z===3){if(a>0){if(c.topLeftRow==c.activeRow&&c.rowsSelected>1){d=Math.min(c.activeRow+c.rowsSelected-1+a,c.numRows)}else{d=c.topLeftRow+1}}else if(a<0){if(c.topLeftRow==c.activeRow&&c.rowsSelected>1){d=Math.max(c.activeRow+c.rowsSelected-1+a,1)}else{d=Math.max(c.topLeftRow-1+a,1)}}c.da(c.activeRow,c.activeCol,d,e);c.ma(d,c.activeCol)}else if(this.z===4){if(b>0){if(c.topLeftCol==
c.activeCol&&c.colsSelected>1){e=Math.min(c.activeCol+c.colsSelected-1+b,c.numCols)}else{e=c.topLeftCol+1}}else if(b<0){if(c.topLeftCol==c.activeCol&&c.colsSelected>1){e=Math.max(c.activeCol+c.colsSelected-1+b,1)}else{e=Math.max(c.topLeftCol-1+b,1)}}c.da(c.activeRow,c.activeCol,d,e);c.ma(c.activeRow,e)}}
;E.prototype.dd=function(a,b){var c=this.db(false);if(this.z===3){var d=this.sa+a;if(a>0){d=Math.min(d,c.numRows)}else{d=Math.max(d,1)}this.sa=d;c.ma(d,c.activeCol);var e=c.rowHObj;var f=e.e(Math.min(this.R,d));var g=e.e(Math.max(this.R,d));var h=e.K(f);this.Ab(this.R,this.sa,0,h,c.j().rb(),e.K(g)+g.offsetHeight-h,c)}else if(this.z===4){var i=this.sa+b;if(b>0){i=Math.min(i,c.numCols)}else{i=Math.max(i,1)}this.sa=i;c.ma(c.activeRow,i);var j=c.colHObj;var l=j.Pa(Math.min(this.R,i));var k=j.Pa(Math.max(
this.R,i));this.Ab(this.R,this.sa,l.offsetLeft,0,k.offsetLeft+k.offsetWidth-l.offsetLeft,c.j().Fa(),c)}this.Ac(c,null)}
;E.prototype.oh=function(a,b){var c=b[0]-a.divMain.scrollLeft;if(c<0){c=Math.round(-0.5+c/50)}else if(c>a.mainGridWid-a.scrollDepth){c=Math.round(0.5+(c-a.mainGridWid+a.scrollDepth)/50)}else{c=0}var d=b[1]-a.divMain.scrollTop;if(d<-a.freezeHeight){d=Math.round(-0.5+d/50)}else if(d>a.mainGridHei-a.scrollDepth){d=Math.round(0.5+(d-a.mainGridHei+a.scrollDepth)/50)}else{d=0}return[c,d]}
;E.prototype.rh=function(a,b){this.Ba=this.Ba-(this.C-b.screenX);this.C=b.screenX;this.V=this.V-(this.D-b.screenY);this.D=b.screenY;this.af(a)}
;E.prototype.af=function(a){var b=a.divMain;var c=-this.Ba;var d=-this.V;b.scrollLeft=c;b.scrollTop=d;a.colHObj.na(c);a.rowHObj.na(d);a.Oe().na(c,d);this.Ba=-b.scrollLeft;this.V=-b.scrollTop}
;E.prototype.xi=function(a){var b=a.divMain;b.scrollLeft=a.colHObj.Nb();b.scrollTop=a.rowHObj.Nb()}
;E.prototype.Mk=function(a){this.uc=true;this.z=8;var b=this.b.activeGrid;if(this.fb){b.divTop.style.cursor="n-resize"}else{b.divTop.style.cursor="e-resize"}if(this.ha.setCapture){this.ha.setCapture()}this.C=a.screenX;this.D=a.screenY;N(a);return false}
;E.prototype.ni=function(a){var b=this.b.activeGrid;b.divTop.style.cursor="default";if(this.z==8){var c=this.Ga;var d=this.Ga;if(this.fb){var e=b.topLeftRow;var f=e+b.rowsSelected-1;if(e<=c&&f>=c){c=e;d=f}}else{var g=b.topLeftCol;var h=g+b.colsSelected-1;if(g<=c&&h>=c){c=g;d=h}}b.rl(this.Ga,c,d,this.fb)}this.C=0;this.D=0;this.uc=false;this.z=0;this.b.A();if(this.b.x().releaseCapture){this.b.x().releaseCapture()}this.xi(b);N(a);return false}
;E.prototype.ki=function(a){if(this.z==8){var b=this.b.activeGrid;var c=null;var d=0;if(this.fb){c=b.rowHObj.e(this.Ga);d=Math.max(0,a.screenY+c.offsetHeight-this.D)}else{c=b.colHObj.Pa(this.Ga);d=Math.max(0,a.screenX+c.offsetWidth-this.C)}if(this.Yb!=d){b.of(this.Ga,this.Ga,this.fb,d,false);if(this.fb){this.D=this.D+c.offsetHeight-this.Yb-1;this.ha.style.top=b.rowHObj.K(c)+c.offsetHeight+20-b.divMain.scrollTop+b.freezeHeight-1}else{this.C=this.C+c.offsetWidth-this.Yb;if(u.type==2){this.C-=1}this.ha.style.left=
c.offsetLeft+c.offsetWidth+35-b.colHObj.Nb()-1}this.Yb=d;b.Za()}}}
;E.prototype.Wl=function(a){var b=false;var c=this.db(true);var d=this.ha;if(a.target===c.divTop){if(!this.P&&!this.b.eb()){var e=this.pc(a,c);if(e[1]>0&&e[0]<c.colHObj.Nb()||e[1]<-c.freezeHeight){var f=d.style;if(e[1]<0){var g=this.ka(c,e[0],e[1],1);if(g[1]<=c.numCols){var h=c.colHObj.Pa(g[1]);var i=h.offsetLeft+h.offsetWidth;if(Math.abs(i-e[0])<5){f.left=i+35-c.colHObj.Nb()-1;f.top=1;f.height=20;f.width="";f.visibility="visible";f.cursor="e-resize";b=true;this.fb=false;this.Ga=g[1];this.Yb=h.offsetWidth;
this.C=e[0]}}}else{var g=this.ka(c,e[0],e[1],2);if(g[0]<=c.numRows){var h=c.rowHObj.e(g[0]);var i=c.rowHObj.K(h)+h.offsetHeight;if(Math.abs(i-e[1])<5){f.left=1;f.top=i+20-c.divMain.scrollTop+c.freezeHeight-1;f.height="";f.width=35;f.visibility="visible";f.cursor="n-resize";b=true;this.fb=true;this.Ga=g[0];this.Yb=h.offsetHeight;this.D=e[1]}}}}}}if(!b&&a.target!==d){d.style.visibility="hidden"}}
;E.prototype.Re=function(a){if(a!=this.Ga){this.ha.style.visibility="hidden"}}
;E.prototype.gl=function(a,b){if(u.os!=1){p.removeBuiltInListener(this.b.x().body,"mouseup",this.ei)}p.removeBuiltInListener(b,"dblclick",this.Pg);p.removeBuiltInListener(a.divMain,"scroll",this.Ci);p.removeBuiltInListener(b,"mousedown",this.mouseDownHandler);if(b.setCapture){p.removeBuiltInListener(b,"mousemove",this.gb);p.removeBuiltInListener(b,"mouseup",this.Aa)}else{var c=this.b.sb();p.removeBuiltInListener(c,"mousemove",this.gb);p.removeBuiltInListener(c,"mouseup",this.Aa)}a.rowHObj.gf(this)
;a.colHObj.gf(this);if(u.type==1){p.removeBuiltInListener(b,"mousewheel",this.yd)}else{p.removeBuiltInListener(b,"DOMMouseScroll",this.yd)}}
;E.prototype.hl=function(){p.removeBuiltInListener(this.ha,"mousedown",this.Zh);p.removeBuiltInListener(this.ha,"mouseup",this.fi);p.removeBuiltInListener(this.ha,"mousemove",this.$h)}
;
function S(a,b){this.w=a;this.ra=v(a.trixApp.x(),b,"divRowHead",0,20,35,a.mainGridHei);this.ra.style.cursor="default";this.Ka=null;this.q=null;this.ti=null}
S.prototype.je=function(a){p.addBuiltInListener(this.ra,"mousedown",a.mouseDownHandler)}
;S.prototype.gf=function(a){p.removeBuiltInListener(this.ra,"mousedown",a.mouseDownHandler)}
;S.prototype.lj=function(){var a,b,c;var d=[];var e=this.w;var f=e.j().Me();var g=1;var h="<table cellpadding='0' class='tblGenFixed'";if(u.type==1){h+=" style='border-top:1px solid #FFF;'"}h+=">";for(a=0;a<f.length;a++){c=f[a];d.push(h);for(b=1;b<c.length;b++){d.push("<tr><td class='rAll' style='height:",c[b].offsetHeight,"'>",g,"</td></tr>");g++}d.push("</table>")}d.push("<div style='width:100%;height:"+(e.scrollDepth-1)+"px' class='headerEnd'></div>");this.ra.innerHTML=d.join("");this.Ka=[];this.q=
[];for(a=0;a<f.length;a++){this.Ka[a]=this.ra.childNodes[a];this.q[a]=this.Ka[a].rows}}
;S.prototype.ke=function(){var a=this.w;var b=a.j();var c,d,e,f,g;var h=a.zf();if(a.lastTblHeight!=b.Fa()){var i=b.Me();var j=[];var l=0;var k=0;for(c=0;c<i.length;c++){e=this.q[c];f=i[c];if(e!=null&&f!=null){for(d=0;d<e.length;d++){l=f[d+1].offsetHeight;if(e[d].offsetHeight!=l){j[k]=l}k++}}}k=0;for(c=0;c<i.length;c++){e=this.q[c];if(e!=null){for(d=0;d<e.length;d++){l=j[k];if(l!=null){g=e[d];g.cells[0].style.height=l;g.style.height=l}k++}}}h=true}if(h){a.Za();a.lastTblHeight=b.Fa()}}
;S.prototype.nk=function(){var a=this.w;var b=a.j().Me();var c,d,e,f;for(c=0;c<b.length;c++){e=this.q[c];f=b[c];if(e!=null&&f!=null){for(d=0;d<e.length;d++){if(a.O(null,f[d+1])){e[d].style.display="none"}}}}}
;S.prototype.xg=function(a,b){var c=this.w;if(a<=c.freezeRow){c.zf()}else{var d=this.e(a);var e=b.offsetHeight;d.cells[0].style.height=e;d.style.height=e;c.lastTblHeight=c.j().Fa()}}
;S.prototype.Cc=function(a){this.ra.style.visibility=a}
;S.prototype.e=function(a,b){var c=this.w.j();if(b==null){b=c.qb(a)}return this.q[b][a-c.ld()[b]-1]}
;S.prototype.K=function(a){return a.parentNode.parentNode.offsetTop+a.offsetTop}
;S.prototype.Md=function(a){this.ra.style.height=a}
;S.prototype.Il=function(a){this.ra.style.top=a}
;S.prototype.na=function(a){this.ra.scrollTop=a}
;S.prototype.Nb=function(){return this.ra.scrollTop}
;S.prototype.si=function(a,b,c){if(c==null){c=b.qb(a);window.clearTimeout(this.ti)}var d=b.ld()[c]+1;var e=this.q[c];if(e!=null){for(var f=0;f<e.length;f++){X(null,e[f].cells[0],d);d++}}c++;if(c<this.q.length){this.ti=qa(this,this.si,0,a,b,c)}}
;S.prototype.tk=function(a,b,c,d){var e=this.w.j();var f=e.qb(a);var g=a-e.ld()[f]-1+d;var h=this.e(a,f).cells[0];var i,j;for(var l=0;l<b;l++){i=this.Ka[f].insertRow(g);j=i.insertCell(0);j.className=h.className;j.style.cssText=h.style.cssText;j.style.height=c}}
;S.prototype.Jj=function(a){var b=this.w.j();var c=b.qb(a);var d=a-b.ld()[c]-1;eb(this.Ka[c],this.e(a,c),d);if(this.q[c].length==0){this.ra.removeChild(this.Ka[c]);this.Ka[c]=null;this.q[c]=null;if(c==0){this.ra.style.top=21}}}
;
function T(a,b,c,d,e,f,g){this.trixApp=a;this.divParent=b;this.moved=false;this.visible=false;var h=this.trixApp.x();this.I=h;this.modal=c;var i=null;if(!c){i=v(h,b,f,0,0,d,e)}else{i=v(h,h.body,f,0,0,d,e);var j=h.getElementById("modalDialogBackground");if(j==null){j=h.createElement("div");h.body.appendChild(j);if(u.type!=1){j.style.backgroundImage="url("+a.pathImg+"modalDlgBack.png) !important"}j.id="modalDialogBackground"}this.Xh=j}this.divMain=i;i.style.visibility="hidden";this.divBar=v(h,i,"dlgBar"
,5,0,d-40,30);this.butClose=Ma(h,i,null,4,"",20,"dlgClose",g,L(this,this.hide));this.butClose.style.right="5px";this.Yh=p.createAdapter(this,this.yc);this.gb=p.createAdapter(this,this.df);this.Aa=p.createAdapter(this,this.Sb);p.addBuiltInListener(this.divBar,"mousedown",this.Yh);this.eventSrc=this.divBar;this.Ra=p.createAdapter(this,this.xc);p.addBuiltInListener(this.butClose,"keydown",this.Ra);this.C=0;this.D=0;this.Wa=0;this.focusElem=this.butClose}
T.prototype.wd=function(a,b,c){var d=this.divBar.style;d.top=15;d.left=20;d=this.butClose.style;d.top=20;d.right=30;if(u.type==1){var e=this.I.createElement("div");d="position:absolute; width: "+a+"px; height: "+b+"px; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c+"', sizingMethod='scale'); display:block; z-index:-1;";e.style.cssText=d;this.divMain.appendChild(e)}else{this.divMain.style.backgroundImage="url("+c+")"}}
;T.prototype.move=function(a,b){this.divMain.style.left=a;this.divMain.style.top=b;this.moved=true}
;T.prototype.xl=function(){if(this.focusElem!=null){this.focusElem.focus()}}
;T.prototype.show=function(){if(!this.visible){var a=this.divMain.style;if(u.os==2){a.display=""}if(this.moved==false||this.modal){a.left=(this.divParent.offsetWidth-this.divMain.offsetWidth)/2;if(this.modal){a.top=Math.max((this.I.body.clientHeight-this.divMain.offsetHeight)/2,0)}else{a.top=70}}a.visibility="visible";if(this.modal){this.trixApp.modalDbox=this;this.Xh.style.display="block"}this.visible=true;lb(this,this.xl,50)}}
;T.prototype.hide=function(){var a=this.divMain.style;this.visible=false;a.visibility="hidden";this.trixApp.A(true);if(this.modal){this.trixApp.modalDbox=null;this.Xh.style.display="none"}if(u.os==2){a.display="none"}}
;T.prototype.yc=function(a){this.moved=true;this.C=a.screenX;this.D=a.screenY;this.Wa=(new Date).getTime();if(this.divBar.setCapture){this.eventSrc=this.divBar;p.addBuiltInListener(this.divBar,"mousemove",this.gb);p.addBuiltInListener(this.divBar,"mouseup",this.Aa);this.divBar.setCapture()}else{this.eventSrc=this.trixApp.sb();p.addBuiltInListener(this.eventSrc,"mousemove",this.gb);p.addBuiltInListener(this.eventSrc,"mouseup",this.Aa)}N(a);return false}
;T.prototype.Sb=function(a){this.Wa=0;this.gi(a);if(this.I.releaseCapture){this.I.releaseCapture()}p.removeBuiltInListener(this.eventSrc,"mousemove",this.gb);p.removeBuiltInListener(this.eventSrc,"mouseup",this.Aa);N(a);return false}
;T.prototype.df=function(a){if(this.Wa>0){var b=(new Date).getTime();if(b-this.Wa>10){this.gi(a);this.Wa=b}N(a);return false}}
;T.prototype.gi=function(a){var b=this.divMain.style;var c=this.divMain.offsetLeft+a.screenX-this.C;var d=this.divMain.offsetTop+a.screenY-this.D;b.left=Math.max(-this.divParent.offsetLeft,c);b.top=Math.max(-this.divParent.offsetTop,d);this.C=a.screenX;this.D=a.screenY}
;T.prototype.xc=function(a){var b=a.keyCode?a.keyCode:(a.which?a.which:a.charCode);if(b==27){this.hide()}}
;T.prototype.cleanup=function(){p.removeBuiltInListener(this.divBar,"mousedown",this.Yh);p.removeBuiltInListener(this.butClose,"keydown",this.Ra)}
;
function ub(a,b){var c=416;var d=202;var e=a.x();var f=new T(a,b,true,c,d,"dlgAlert","Close");f.wd(c,d,a.pathImg+"smallDlgBack.png");this.screen=f;var g=f.divMain;var h=v(e,g,"dlgContentOut",20,50,376,90);this.zd=v(e,h,"dlgMsgIn",0,0,"","");var i=Ma(e,g,null,150,"","","dlgButt","OK",L(f,f.hide));i.style.right="20px";f.focusElem=null}
ub.prototype.Ki=function(a,b){this.screen.divBar.innerHTML=a;this.zd.innerHTML=b}
;ub.prototype.cleanup=function(){this.screen.cleanup()}
;
function Za(a,b){var c=300;var d=350;var e=a.x();var f=new T(a,b,false,c,d,"dlgNotRounded","Close");this.screen=f;f.divBar.innerHTML="Insert a Function";var g=f.divBar.offsetHeight;var h=v(e,f.divMain,"dlgContentOut",0,g,c-2,"");h.innerHTML="<table cellpadding=0 cellspacing=0></table>";var i=h.childNodes[0];i.className="funcTbl";i.width=c-20;var j=i.insertRow(i.rows.length);var l=j.insertCell(0);var k=j.insertCell(0);k.className="funcHead1";l.className="funcHead2";k.innerHTML="Function";l.innerHTML=
"Category";g+=h.offsetHeight;var n=v(e,f.divMain,"dlgContentOut",0,g,c-2,d-g-2);n.innerHTML="<table cellpadding=0 cellspacing=0></table>";i=n.childNodes[0];var o=O+"=5";var r=W(a.url,o,false);var s=eval(r.responseText);this.Aa=p.createAdapter(this,this.Sb);this.ai=p.createAdapter(this,this.Pk);this.di=p.createAdapter(this,this.Sk);p.addBuiltInListener(i,"mouseup",this.Aa);p.addBuiltInListener(i,"mouseout",this.ai);p.addBuiltInListener(i,"mouseover",this.di);this.Le=i;i.className="funcTbl";i.width=
c-22;var w,C;for(var F=0;F<s.length;F++){j=i.insertRow(i.rows.length);C=j.insertCell(0);w=j.insertCell(0);l=j.insertCell(0);k=j.insertCell(0);k.className="funccel1";l.className="funccel2";w.className="funccelx";C.className="funccelx";X(e,k,s[F][0]);X(e,l,s[F][1]);X(e,w,s[F][2]);X(e,C,s[F][3])}}
Za.prototype.Sb=function(a){var b=a.target;var c=b.parentNode.cells;this.screen.trixApp.Eh(c[0].innerHTML,c[3].innerHTML);N(a)}
;Za.prototype.Sk=function(a){var b=a.target;var c=b.parentNode.cells;if(c!=null){for(var d=0;d<c.length;d++){c[d].style.backgroundColor="#EDEFFF"}}N(a)}
;Za.prototype.Pk=function(a){var b=a.target;var c=b.parentNode.cells;if(c!=null){for(var d=0;d<c.length;d++){c[d].style.backgroundColor=""}}N(a)}
;Za.prototype.cleanup=function(){p.removeBuiltInListener(this.Le,"mouseup",this.Aa);p.removeBuiltInListener(this.Le,"mouseout",this.ai);p.removeBuiltInListener(this.Le,"mouseover",this.di);this.screen.cleanup()}
;
function vb(a,b,c,d,e,f,g){this.addOnVisible=f;this.maxMsgs=e;this.doc=a.x();var h=new T(a,b,false,c,d,"dlgNotRounded","Close");this.screen=h;var i=h.divBar;var j=i.offsetHeight;i.innerHTML="Debug Screen";this.Lg=v(this.doc,h.divMain,"dlgContentOut",0,j,c-2,d-j-2);this.am=sa(this.doc,this.Lg,"dlgTblGen",0,0,"","","table");this.classCells=g}
vb.prototype.tg=function(a){if(this.addOnVisible||this.screen.visible){var b=this.am;var c=b.rows.length;if(this.maxMsgs!=null){if(c>=this.maxMsgs){b.deleteRow(0)}}var d=b.insertRow(b.rows.length);var e=d.insertCell(0);e.className=this.classCells;X(this.doc,e,a);this.Lg.scrollTop=2000000}}
;vb.prototype.cleanup=function(){this.screen.cleanup()}
;
function Sa(a,b){this.p=a;var c=416;var d=202;var e=a.x();var f=new T(a,b,true,c,d,"dlgAlert","");f.wd(c,d,a.pathImg+"smallDlgBack.png");this.screen=f;var g=f.divMain;var h=v(e,g,"dlgContentOut",20,50,376,90);this.zd=v(e,h,"dlgMsgIn",0,0,"","");var i=Ma(e,g,25,150,200,"","","Discard Changes and Reload",H(this,this.show,true));this.uj=i;i=Ma(e,g,null,150,140,"","","Switch to View Only",L(this,this.El));i.style.right="25px";f.focusElem=null;this.tb=null}
Sa.prototype.El=function(){this.tb=ka(this.tb);this.screen.hide();var a=this.p;a.setMode(2);var b=a.gooffiLink;if(b!=null){b.Hl()}}
;Sa.prototype.Xi=function(){var a=this.p;var b=false;try{var c=W(a.url,O+"=6",false);if(c.status!=200){b=true}}catch(d){b=true}try{if(!b){var e=a.gooffiLink;if(e!=null){qa(e,e.el,0)}else{window.setTimeout(a.sb().location.reload(true),0)}}}catch(d){}}
;Sa.prototype.Al=function(a,b){if(a==null)a="Disconnected";this.screen.divBar.innerHTML=a;if(b==null){b=this.p.qj()?"Oops, it looks like you've made a few changes while offline. We're sorry, these changes cannot be saved.\n\nPlease check your internet connection.":"Oops, it looks like you've lost connection to the server. Please check your internet connection."}this.zd.innerHTML=b}
;Sa.prototype.show=function(a){var b=this.screen;var c=this.uj.style;if(a){b.divBar.innerHTML="Reconnecting...";this.zd.innerHTML="Trying to reconnect to the server.<img src='"+this.p.pathImg+"spinWait.gif'/>";c.display="none";this.Xi();this.tb=ka(this.tb);this.tb=Pa(this,this.Xi,15000)}else{c.display=""}if(!b.visible){b.show()}}
;Sa.prototype.cleanup=function(){this.tb=ka(this.tb);this.screen.cleanup()}
;
function hb(a){this.trixApp=a;this.J=u.type==1;this.ib=null;this.Lf="";this.Gb=0}
hb.prototype.start=function(a){var b=O+"=4";b+="&id="+a;var c=W(this.trixApp.url,b,false);this.ib=eval(c.responseText);this.Lf="";this.Gb=0;this.run()}
;hb.prototype.run=function(){if(this.ib!=null){if(this.Gb<this.ib.length){eval(this.ib[this.Gb][0])}}}
;hb.prototype.check=function(){if(this.ib!=null){var a=null;var b="";var c=null;eval(this.ib[this.Gb][1]);if(a!=null){if(c===false){this.Lf+=a+"\n"}this.trixApp.ab(c+": "+a,b,false)}this.Gb++;if(this.Gb<this.ib.length){this.run()}else{this.ib=null;alert(this.Lf)}}}
;
function J(a,b,c){this.J=u.type==1;this.status=0;this.w=b;var d=sa(a,c,"framesContainer",0,0,"","","table");var e=Math.ceil(b.numRows/200);var f=null;var g=[];for(var h=0;h<e;h++){g[h]=this.Ej(d,h,a);f=g[h].nh();f.width=c.offsetWidth;f.height=c.offsetHeight;g[h].r1=h*200;g[h].r2=Math.min(g[h].r1+200,b.numRows)}this.Oa=g;this.Yj=d.rows;this.q=null;this.Ja=null;this.Ma=null;this.Uc=false;this.bordersChanged=false}
J.prototype.Uj=function(){if(this.bordersChanged){var a=this.Ja;for(var b=0;b<a.length;b++){a[b].style.borderCollapse="separate"}qa(this,this.ul,0)}}
;J.prototype.ul=function(){var a=this.Ja;for(var b=0;b<a.length;b++){a[b].style.borderCollapse="collapse"}this.bordersChanged=false}
;J.prototype.M=function(){return this.w}
;J.prototype.Me=function(){return this.q}
;J.prototype.ld=function(){return this.Ma}
;J.prototype.Ej=function(a,b,c){var d=a.insertRow(b).insertCell(0);d.className="framesContainerCells";return new Ya(c,d)}
;J.prototype.hm=function(){this.q=null;this.Ja=null;this.Ma=null;var a=this.ph();var b=this.Oa;for(var c=0;c<b.length;c++){b[c].bk(a+"&srow="+b[c].r1+"&erow="+b[c].r2)}this.Uc=false}
;J.prototype.ph=function(){var a=this.w.trixApp.url+"&"+O+"=1&tile="+this.w.id;if(this.J&&this.w.numRows<201){a+="&rpert=100"}else{a+="&rpert=20"}return a}
;J.prototype.ck=function(){return this.Oa}
;J.prototype.th=function(){return this.status==2}
;J.prototype.wk=function(){return this.Uc}
;J.prototype.pj=function(){if(this.Uc){return true}else{var a=this.Oa;var b,c,d,e;var f=0;for(var g=0;g<a.length;g++){if(a[g].processed==true){f++}else{b=a[g].ih();b.window=a[g].md();b.trixIndex=g;a[g].tblMain=b.getElementById("tblMain");if(a[g].tblMain==null){return false}else{var h=b.getElementsByTagName("meta");if(h==null){return false}else{c=h["trixcnt"].content;d=h["trixlast"].content;e=b.getElementById("tblMain_"+(c-1));if(e==null){return false}else{if(e.rows[d]==null){return false}else{if(
!this.J||b.readyState=="complete"){a[g].processed=true;f++}else{return false}}}}}}}return f==a.length}}
;J.prototype.bl=function(){if(this.pj()){this.Uc=true;this.Ja=[];this.q=[];this.Ma=[];this.Ma[0]=0;var a=0;var b=this.Oa;var c;for(var d=0;d<b.length;d++){c=b[d].ih();a=this.al(a,c,c.getElementsByTagName("meta")["trixcnt"].content)}this.lc();this.w.Zk();this.$k();if(this.w===this.w.trixApp.activeGrid){this.w.zb(true,false)}return true}else{return false}}
;J.prototype.al=function(a,b,c){var d=this.Ja.length;var e=null;for(var f=0;f<c;f++){e=b.getElementById("tblMain_"+f);this.Ja[d]=e;this.q[d]=e.rows;a+=e.rows.length-1;d++;this.Ma[d]=a}return a}
;J.prototype.$k=function(){var a=null;for(var b=0;b<this.Oa.length;b++){a=this.Oa[b].md();var c=a.mCs;if(c!=null){var d,e,f,g,h;for(d=0;d<c.length;d++){g=this.q[c[d][0]][c[d][1]].cells;f=c[d][2];h=g[f];for(e=0;e<c[d][3];e++){g[f+e].mergP=h}}a.mCs=null}}}
;J.prototype.lc=function(){var a=this.Oa;var b=this.rb();var c=null;for(var d=0;d<a.length;d++){c=a[d].nh();c.width=b+"px";c.height=a[d].tblMain.offsetHeight+"px"}}
;J.prototype.qb=function(a){var b=1;while(a>this.Ma[b]){b++}return b-1}
;J.prototype.e=function(a,b){if(b==true||a==0||this.w.freezeRow<a){var c=this.qb(a);return this.q[c][a-this.Ma[c]]}else{return this.w.colHObj.kd(a)}}
;J.prototype.insertRow=function(a,b){var c=this.qb(a);var d=this.Ma;for(var e=c+1;e<d.length;e++){d[e]++}return this.Ja[c].insertRow(a-d[c]+b)}
;J.prototype.deleteRow=function(a){var b=this.qb(a);var c=this.Ma;var d=a-c[b];eb(this.Ja[b],this.q[b][d],d);for(var e=b+1;e<c.length;e++){c[e]--}if(this.q[b].length==1&&b>0){var f=this.Ja[b].parentNode.parentNode;var g=f.parentNode.parentNode;eb(g,f,f.rowIndex);this.Ja[b]=null;this.q[b]=null}}
;J.prototype.Te=function(a,b,c,d){var e,f,g;var h,i,j,l;var k=this.q;var n=a==this.w.numCols&&d;for(h=0;h<k.length;h++){if(k[h]!=null){for(i=0;i<k[h].length;i++){e=k[h][i];f=e.cells[a];for(j=0;j<b;j++){l=Ha(f,this.w,false);g=Xb(f,e,a+d,n);if(l!=null){if(l<a){g.mergP=f.mergP;g.style.display="none"}}if(i==0){g.style.height="0px";g.style.width=c}}}}}}
;J.prototype.xe=function(a,b){var c,d,e;var f=null;var g=this.q;for(c=0;c<g.length;c++){if(g[c]!=null){for(d=0;d<g[c].length;d++){f=g[c][d];for(e=0;e<b;e++){if(this.J){f.removeChild(f.cells[a])}else{f.deleteCell(a)}}}}}}
;J.prototype.ol=function(a,b){var c=null;for(var d=0;d<this.q.length;d++){if(this.q[d]!=null){c=this.q[d][0].cells[a];c.style.width=b}}}
;J.prototype.mk=function(a,b,c){var d,e,f,g;var h=this.q;for(e=0;e<h.length;e++){if(h[e]!=null){for(f=0;f<h[e].length;f++){d=h[e][f].cells;for(g=a;g<=b;g++){d[g].style.display=c}}}}}
;J.prototype.rb=function(){return this.Oa[0].tblMain.offsetWidth}
;J.prototype.Fa=function(){var a=this.Oa;var b=0;for(var c=0;c<a.length;c++){b+=a[c].tblMain.offsetHeight}return b}
;J.prototype.K=function(a){if(a.isHeader==true){return a.offsetTop-20}else{return this.Yj[a.ownerDocument.trixIndex].offsetTop+a.parentNode.parentNode.parentNode.offsetTop+a.offsetTop}}
;
var O="action";var q={value:1,formula:2,clear:3,clearFmt:4,numberFormat:8,fontFamily:9,fontSize:10,fontWeight:11,fontStyle:12,textDecoration:13,whiteSpace:14,textAlign:15,verticalAlign:16,color:17,backgroundColor:31,borders:32,freeze:40,resizeRow:41,resizeCol:42,tc:43,Ud:44,vc:51,yb:52,Wb:53,Xa:54,pasteValues:59,pasteFormat:60,rowInsert:61,rowDelete:62,colInsert:63,colDelete:64,pasteAll:65,pasteCut:66,pasteFromClip:67,rowInsertAfter:68,colInsertAfter:69,undo:71,redo:72,Pc:73,ye:74,newIM:75,mode:81,
chartCreate:91,sort:151,errorGeneric:200,errorSuggReload:201,errorReload:202,errorLow:203,errorHigh:204,errorSeq:205,error9:206,renameDoc:301,lastSaved:302,autoSave:303};var ac=null;function t(a,b,c){this.isIE=u.type==1;this.mode=c;if(c==null){this.mode=0}this.win=a;this.doc=b;this.doc.window=this.win;this.MIN_APP_WIDTH=450;this.MIN_APP_HEIGHT=250;this.S=null;this.grids=null;this.activeGrid=null;this.activeFormuGrid=null;this.divGrids=null;this.Fc=null;this.menuMain=null;this.Ee=null;this.bd=null;
this.Ha=null;this.Ui=null;this.Qc=z.HEIGHT;this.pathImg="../images/";this.url=null;this.Jf=null;this.Nf=null;this.isPanningOn=false;this.$=[];this.jc=0;if(this.isIE){this.$f=1}else{this.$f=3}this.timeStart=new Date;this.iconManager=null;this.cellSelection=null;this.mouseSelection=null;this.ad=null;this.dboxAlert=null;this.screenHttp=null;this.screenFuncs=null;this.modalDbox=null;this.copyPaste=null;this.defaultColWidth="64px";this.defaultRowHeight="17px";this.testScripts=new hb(this);this.qc=null;
this.Vi=false;this.isDirty=null;this.oe=false;this.gooffiLink=null;this.isReady=false;this.nd=false;this.Hk=0;this.Rb=null;this.Ec=[];this.ac=null}
t.prototype.autoLoad=function(a,b,c,d){lb(this,this.vi,500);this.S=a;this.S.innerHTML="";this.S.trixNode=this;this.grids=new Ra(this);this.Jl(b,c);this.yl(d);if(ac==null){ac=Qb(d,["toolbarAll3.gif","buttonLight.gif","buttonDownTri.gif","buttonDownTriBlue.gif","smallDlgBack.png","modalDlgBack.png","buttonLightPressed.gif","hyperlink.gif"])}this.pk();var e=O+"=0";var f=W(b,e,false);var g=eval(f.responseText)[0];if(g.dw!=null){this.defaultColWidth=g.dw}if(g.dh!=null){this.defaultRowHeight=g.dh}this.Rb=
g.lsq;var h=g.a;if(g.action==0&&h!=null){for(var i=0;i<h.length;i++){this.grids.qg(h[i].g,h[i].i,h[i].r,h[i].c)}for(var i=0;i<this.grids.T();i++){this.grids.M(i).info.Lh()}this.Mh();this.sj();this.menuMain.Vg(true)}else{this.oa("We're sorry.  There was an error loading your spreadsheet.")}}
;t.prototype.pk=function(){var a=this.S;var b=this.doc;var c=Math.max(this.MIN_APP_HEIGHT,a.offsetHeight)-this.Qc-26;var d=da(b,a,"","");d.style.tableLayout="fixed";d.style.width="100%";var e=d.insertRow(0);var f=e.insertCell(0);f.style.height=z.HEIGHT;this.Fc=f;e=d.insertRow(1);f=e.insertCell(0);var g=v(b,f,"divAppArea",0,0,"100%",c);this.divGrids=g;this.iconManager=new gb(this,b,g);this.cellSelection=new G(this);this.mouseSelection=new E(this);this.copyPaste=new Xa(this);this.divMsg=v(b,g,"divMsg"
,-1000,2,"","");e=d.insertRow(2);f=e.insertCell(0);d=da(b,f,"","");e=d.insertRow(0);f=e.insertCell(0);f.style.height=26;var h=Math.max(f.offsetWidth,this.MIN_APP_WIDTH);this.bd=v(b,f,"panels",0,0,(this.isIE?h:h-1)-250,"100%");f=e.insertCell(1);f.style.height=26;var i=v(b,f,"panels panelStatus",0,0,250,"100%");this.Ee=i;i.innerHTML="<table cellpadding='0' class='tblGeneric' style='table-layout:fixed'><tr><td class='secStatus'></td><td class='secVersion'></td></tr></table>";var j=i.childNodes[0].rows[
0].cells;this.Ui=j[0];j[1].innerHTML="V"+this.kk();this.tl();this.dboxAlert=new ub(this,a);this.screenHttp=new vb(this,a,350,400,100,false,"dlgDebugCells")}
;t.prototype.A=function(a,b){this.cellSelection.A(a,b)}
;t.prototype.Y=function(a,b){var c=this.dboxAlert;if(b==null){c.Ki("&nbsp;Oops",a)}else{c.Ki(b,a)}c.screen.show()}
;t.prototype.Mh=function(a){var b=null;if(a==null){while(this.$.length>0){this.$.pop()}for(var c=0;c<this.grids.T();c++){b=this.grids.M(c).j();b.status=0;this.$.push(b)}}else{this.timeStart=new Date;b=a.j();b.status=0;this.$.push(b)}this.jc=0;this.Dg()}
;t.prototype.Dg=function(){if(!this.oe&&this.$.length>0){var a=null;for(var b=0;b<this.$.length&&this.jc>0;b++){if(this.$[b].status==1){a=this.$[b];if(a.bl()){a.status=2;this.jc--}}}for(var b=0;b<this.$.length&&this.jc<this.$f;b++){if(this.$[b].status==0){a=this.$[b];a.hm();a.status=1;this.jc++}}while(this.$.length>0&&this.$[0].status==2){this.$.shift()}if(this.$.length>0){lb(this,this.Dg,50)}else{if(!this.nd){this.qc.connect()}this.cellSelection.Jg(false);this.isReady=true;var c=this.nd;this.nd=
true;if(!c&&u.os==2){this.activate(0,true,false,true)}if(this.mode==-1){this.oa("Time: "+(new Date-this.timeStart))}else{this.oa("Ready")}}}}
;t.prototype.wl=function(a,b){this.qc=new fb(this,a,b)}
;t.prototype.Sd=function(){if(this.qc!=null){this.qc.disconnect()}}
;t.prototype.vi=function(){var a=0;var b=0;if(this.grids==null){a=1}else{var c,d,e,f,g;for(c=0;c<this.grids.T();c++){e=this.M(c);a+=e.numRows;f=e.j();if(f.wk()){b+=e.numRows}else{g=f.ck();if(g!=null){for(d=0;d<g.length;d++){if(g[d].processed==true){b+=g[d].r2-g[d].r1}}}}}}if(!this.oe&&b<a){var h=Math.floor(b/a*100);this.Z(h>0?h+"% loaded...":"Loading...",true);lb(this,this.vi,500)}else{this.wh(true)}}
;t.prototype.tl=function(){if(!this.isIE){this.Nf=p.createAdapter(this,this.Vk);p.addBuiltInListener(this.win,"resize",this.Nf)}this.cellSelection.sl()}
;t.prototype.Vk=function(){this.menuMain.Ld();this.menuMain.Vg(false)}
;t.prototype.yi=function(a,b,c){var d=Math.max(a,this.MIN_APP_WIDTH);this.S.style.width=d;this.divGrids.style.width=d;this.bd.style.width=(this.isIE?d:d-1)-250;this.Ee.style.width=250;if(!this.eb()){this.Qc=z.HEIGHT;this.Fc.style.display=""}else{this.Qc=0;this.Fc.style.display="none"}var e=Math.max(b,this.MIN_APP_HEIGHT);this.S.style.height=e;this.divGrids.style.height=e-this.Qc-26;this.Ha.ll();if(c){for(var f=0;f<this.grids.T();f++){this.grids.M(f).wi()}}if(!this.isIE){if(this.activeGrid!=null){
this.activeGrid.zb(true,false)}}}
;t.prototype.setMode=function(a){this.mode=a;if(this.gooffiLink!=null){this.gooffiLink.Dl(this.eb())}if(this.isReady){this.Cg();this.oa("");this.yi(this.S.offsetWidth,this.S.offsetHeight,true);if(this.activeGrid!=null){this.activate(this.activeGrid.index,true,false,true)}}}
;t.prototype.eb=function(){return this.mode>0}
;t.prototype.sb=function(){return this.win}
;t.prototype.x=function(){return this.doc}
;t.prototype.getDivApp=function(){return this.S}
;t.prototype.oa=function(a,b){var c=this.Ui;X(this.doc,c,a);c.title=a;var d="secStatus ";if(b!=null){d+=b}c.className=d}
;t.prototype.kh=function(){return this.grids}
;t.prototype.M=function(a){return this.grids.M(a)}
;t.prototype.activate=function(a,b,c,d,e,f){c=c==null?false:c;var g=this.cellSelection.rc()&&!c;var h=null;if(!g&&!c&&e!=false){this.cellSelection.fa(true)}if(this.modalDbox==null||d){for(var i=0;i<this.grids.T();i++){if(i!=a){this.M(i).Nd(1,false)}}var j=2;if(u.os==2){j=1}if(g){this.cellSelection.Dc();h=this.M(a);this.activeFormuGrid=h;h.Nd(j,true);h.ya(0)}else{h=this.M(a);this.activeGrid=h;h.Nd(j,true)}this.A();if(b){var l=this.Ha;var k=l.ik();var n=null;var o=this.activeGrid.index;for(var i=0;
i<this.grids.T();i++){n=k.cells[i];if(i==a){if(!this.eb()){n.className="sheetNotActive sheetActive";n.onclick=M(l,l.Lj,i,n)}else{n.className="sheetNotActive sheetReadonly";n.onclick=null}}else{if(i==o){n.className="sheetNotActive sheetFormula"}else{n.className="sheetNotActive"}n.onclick=M(this,this.activate,i,true)}}}if(this.nd){if(f!=true){h.kl()}h.Nd(2,true);this.mouseSelection.Fl(h)}}}
;t.prototype.sj=function(){if(this.menuMain==null){this.Ha=new Z(this,this.bd,0,0,"100%","100%");this.Cg();for(var a=0;a<this.grids.T();a++){this.Ha.sg(this.M(a).name,"",false)}}this.activate(0,true,false,true)}
;t.prototype.Cg=function(){if(this.menuMain==null){this.menuMain=new z(this,this.Fc,0)}var a=this.Ha.addButton.container.style;if(!this.eb()){this.menuMain.divMain.style.display="";a.display=""}else{this.menuMain.divMain.style.display="none";a.display="none"}}
;t.prototype.Pl=function(){if(this.screenFuncs==null){this.screenFuncs=new Za(this,this.S)}this.screenFuncs.screen.show()}
;t.prototype.Xa=function(a,b,c){if(a==null){if(this.X(false)){var d=O+"=9";d+="&gid="+this.activeGrid.id;d+="&atyp="+q.Xa;d+="&v="+b;this.Z(Q);this.ea(d,false)}this.A()}else{var e=this.grids;var f=b==-1?0:e.ids[b].index;if(b>-1&&f<a.index){f++}e.Xa(a,f,c)}}
;t.prototype.vc=function(a,b,c,d,e,f){if(c==null){if(this.X(false)){if(this.grids.T()>19){this.Y("We're sorry.  You can only have 20 sheets in each document.")}else{var g=O+"=9";g+="&gid="+this.activeGrid.id;g+="&atyp="+q.vc;this.Z(Q);this.ea(g,false)}}this.A()}else{var h=this.grids.qg(b,c,d,e);h.info.Lh();this.Mh(h);this.grids.Xa(h,a.index+1,f)}}
;t.prototype.yb=function(a,b){if(a==null){if(this.grids.T()>1){if(this.X(false)){if(confirm("Are you sure you want to remove this sheet?")){var c=O+"=9";c+="&gid="+this.activeGrid.id;c+="&atyp="+q.yb;this.Z(Q);this.ea(c,true)}}}else{this.Y("You can't remove the last sheet in a document.")}this.A()}else{this.grids.yb(a,b)}}
;t.prototype.Wb=function(a,b,c,d){if(b==null){if(this.X(false)){if(a==null){b=this.activeGrid;a=b.index}else{b=this.M(a)}c=c==null?b.name:c;if(d==null){c=prompt("Rename sheet as:\n(Please use only letters, numbers, and spaces)",c)}else{c=prompt(d,c)}if(c!=null&&c!=b.name){var e=30;d="";if(c.length==0||c.length>e){d="Oops.  Your sheet name may be too long or completely empty.\nPlease try again."}else if(!Ac(c)){d="Oops.  Your sheet name cannot contain special characters.\nPlease use only letters, numbers and spaces."
}else if(!isNaN(c.charAt(0))){d="Oops.  The first character in you sheet must be a letter.\nPlease try again."}else{for(var f=0;f<this.grids.T();f++){if(f!=a){if(this.M(f).name==c){d="Oops.  You already have a sheet with that name.\nPlease try again."}}}}if(d.length!=0){this.Wb(a,null,c.substring(0,e),d)}else{d=O+"=9";d+="&gid="+b.id;d+="&atyp="+q.Wb;d+="&v="+encodeURIComponent(c);this.Z(Q);this.ea(d,false)}}}this.A()}else{b.name=c;this.kf(this.activeGrid.index,false)}}
;t.prototype.kf=function(a,b){this.Ha.clear(true);for(var c=0;c<this.grids.T();c++){this.Ha.sg(this.M(c).name,"",false)}this.activate(a,true,false,true,b)}
;t.prototype.Yk=function(){this.win.open(this.activeGrid.j().ph())}
;t.prototype.ij=function(){var a=this.activeGrid;if(this.modalDbox==null&&a!=null){var b=this.cellSelection;if(!b.isEditBoxActive){b.La(true);b.F2OrMouse=true}this.A()}}
;t.prototype.Eh=function(a,b){var c=this.cellSelection;var d=this.activeGrid;if(this.modalDbox==null&&d!=null){var e=c.Mb();if(c.isEditBoxActive){e.value+=a+"(";if(b!=null){e.value+=b+")"}c.Xb()}else{var f=d.rowsSelected;var g=d.colsSelected;if(b!=null||f==1&&g==1){c.La(false);e.value="="+a+"(";if(b!=null){e.value+=b+")"}c.Xb()}else{var h=d.topLeftRow;var i=d.topLeftCol;var j="="+a+"("+this.ak(h,i,f,g,null)+")";if(f>1){if(h+f<=d.numRows){d.da(h,i,h+f,i+g-1);d.F(h+f,i,false)}}else{if(i+g<=d.numCols)
{d.da(h,i,h+f-1,i+g);d.F(h,i+g,false)}}c.La(false,0);e.value+=j;c.Xb()}}}this.A()}
;t.prototype.ak=function(a,b,c,d,e){var f=P(b)+a+":"+P(b+d-1)+(a+c-1);if(e!=null){if(e.name.indexOf(" ")>-1){f="'"+e.name+"'!"+f}else{f=e.name+"!"+f}}return f}
;t.prototype.Hd=function(a){if(this.X(false)){var b=O+"=9";b+="&atyp="+a;this.Z(Q);this.ea(b,true)}this.A()}
;t.prototype.copy=function(a,b){if(this.X(true)){this.copyPaste.copy(a);this.activeGrid.zg(true)}this.A();if(b){if(this.isIE){this.cellSelection.Mb().createTextRange().execCommand("Copy")}else{this.oa("To copy to your system clipboard, use Ctrl-C or the Edit menu.","secStatCopy")}}}
;t.prototype.paste=function(a,b){if(this.X(true)){var c=this.copyPaste;if(c.copyType==null){if(a){if(this.isIE){this.cellSelection.Mb().createTextRange().execCommand("Paste");c.pi()}else{this.oa("To paste from your system clipboard, use Ctrl-V or the Edit menu.","secStatCopy")}}else{c.pi()}}else{if(b!=null){c.copyType=b}c.paste()}}this.A()}
;t.prototype.Eg=function(){if(this.X(true)){this.activeGrid.ze()}}
;t.prototype.wj=function(){if(this.X(true)){this.activeGrid.jb(q.clearFmt,"",Q);this.menuMain.lf(false)}this.A()}
;t.prototype.W=function(a,b){if(this.X(true)){if(b==null)b=false;var c=this.activeGrid;var d=c.info.rowsTOids;var e=c.info.colsTOids;var f=c.rowsSelected==null?1:c.rowsSelected;var g=c.colsSelected==null?1:c.colsSelected;var h=c.topLeftRow;if(a==q.rowInsertAfter){h+=f-1}var i=d[h];var j=c.topLeftCol;if(a==q.colInsertAfter){j+=g-1}var l=e[j];if(i==null||l==null){this.ab($a,q.errorGeneric,true)}else{var k=false;var n=O+"=9";n+="&gid="+this.activeGrid.id;n+="&atyp="+a;var o=false;if(a==q.rowInsert||
a==q.rowInsertAfter){if(h<=c.freezeRow){k=true;this.Y("Sorry, you can't insert rows in the frozen header section.  Try turning off frozen headers first.")}else{n+="&srow="+i;n+="&v="+(b?1:f)}}else if(a==q.rowDelete){o=true;n+="&srow="+i;if(f==c.numRows){k=true;this.Y("You can't delete all of the rows in a sheet.")}else if(h<=c.freezeRow){k=true;this.Y("Sorry, you can't delete rows in the frozen header section.  Try turning off frozen headers first.")}else{n+="&erow="+d[c.topLeftRow+f-1]}}else if(
a==q.colInsert||a==q.colInsertAfter){n+="&scol="+l;n+="&v="+(b?1:g)}else if(a==q.colDelete){o=true;n+="&scol="+l;if(g==c.numCols){k=true;this.Y("You can't delete all of the columns in a sheet.")}else{n+="&ecol="+e[c.topLeftCol+g-1]}}else{k=true;this.Y("Unrecognized command.")}if(!k){this.Z(Q,true);this.ea(n,o)}}}this.A()}
;t.prototype.Id=function(a){if(this.X(true)){var b=this.activeGrid;var c=b.topLeftCol;if(c!=null){var d=O+"=9";d+="&gid="+this.activeGrid.id;d+="&atyp="+q.sort;d+="&scol="+b.info.colsTOids[c];d+="&v="+a;this.Z(Q);this.ea(d,true)}}this.A()}
;t.prototype.merge=function(a){if(this.X(true)){var b=this.activeGrid;var c=b.topLeftRow;var d=b.topLeftCol;if(c!=null&&d!=null){b.rowsSelected=1;var e=b.rowsSelected==null?1:b.rowsSelected;var f=b.colsSelected==null?1:b.colsSelected;if(this.oj(b,c,d,e,f)){if(a){var g=b.j();var h=true;var i,j,l;for(i=0;i<e&&h;i++){l=g.e(c+i).cells;for(j=0;j<f&&h;j++){if(i+j>0){if(l[d+j].innerHTML.length>0){h=false}}}}if(!h){if(confirm("Merging these cells will erase some of the contents.\nAre you sure you want to merge across?"
)){h=true}}if(h){b.activeRow=b.topLeftRow;b.activeCol=b.topLeftCol;b.jb(q.tc,"",Q)}}else{b.jb(q.Ud,"",Q)}}else{this.Y("You must select all cells in a merged range to merge or unmerge them.")}}}this.A()}
;t.prototype.oj=function(a,b,c,d,e){var f=null;var g=a.j();for(var h=0;h<d;h++){f=Ha(g.e(b+h).cells[c],a);if(f!=null){if(ab(f)<c){return false}if(ta(f,a)>e){return false}h+=f.rowSpan-1}}if(e>1){for(var h=0;h<d;h++){f=Ha(g.e(b+h).cells[c+e-1],a);if(f!=null){if(ab(f)+ta(f,a)>c+e){return false}h+=f.rowSpan-1}}}return true}
;t.prototype.Rc=function(a){if(this.X(true)){var b=this.activeGrid;var c=b.wa();if(c!=null){if(a==="bold"){b.ja("fontWeight",Yb(c)?"normal":"bold")}if(a==="italic"){b.ja("fontStyle",Zb(c)?"normal":"italic")}if(a==="underline"){b.ja("textDecoration",$b(c)?"none":"underline")}if(a==="wrap"){var d=U(c,"whiteSpace","white-space");if(d==="normal"){b.ja("whiteSpace","nowrap")}else{b.ja("whiteSpace","normal")}}if(a==="alignLeft"){b.ja("textAlign","left")}if(a==="alignCenter"){b.ja("textAlign","center")}
if(a==="alignRight"){b.ja("textAlign","right")}if(a==="alignTop"){b.ja("verticalAlign","top")}if(a==="alignMiddle"){b.ja("verticalAlign","middle")}if(a==="alignBottom"){b.ja("verticalAlign","bottom")}this.menuMain.Mi(c,b)}}this.A()}
;t.prototype.s=function(a){if(a!==this.menuMain){this.menuMain.s()}this.Ha.s();var b=this.gooffiLink;if(b!=null){if(b.s){b.s()}}}
;t.prototype.wb=function(a,b){this.menuMain.wb(a,b)}
;t.prototype.lm=function(){this.activeGrid.jb(q.chartCreate,0,Q)}
;t.prototype.yl=function(a){this.pathImg=a}
;t.prototype.Jl=function(a,b){this.url=a+(a.indexOf("?")==-1?"?":"");if(b==null){this.Jf=this.url}else{this.Jf=b+(b.indexOf("?")==-1?"?":"")}}
;t.prototype.Z=function(a,b){if(b==true){this.divMsg.innerHTML=a;this.divMsg.style.left=2}else{if(this.ac==null){this.ac=qa(this,this.Z,1000,a,true)}}}
;t.prototype.wh=function(a){if(a||this.Ec.length<1){this.ac=ka(this.ac);this.divMsg.style.left=-1000}}
;t.prototype.X=function(a){if(this.modalDbox==null){if(this.cellSelection.isEditBoxActive){this.Y("You can't do this while editing a cell.<br>Press enter to finish editing the selected cell.")}else{if(a){if(this.activeGrid.topLeftRow==null){this.Y("Please select a cell to perform this operation.")}else{return true}}else{return true}}}return false}
;t.prototype.kk=function(){return"1.1.4d"}
;t.prototype.ab=function(a,b,c){var d=O+"=3";d+="&emsg="+encodeURIComponent(a);d+="&ecod="+b;W(this.url,d,true);if(c&&a!=null){this.Y(a)}}
;t.prototype.ea=function(a,b){this.screenHttp.tg(a);if(b==true){this.copyPaste.copyType=null}a+="&msq="+ ++this.Hk;if(this.Rb!=null){a+="&lsq="+this.Rb}var c=W(this.Jf,a,true);var d={};d.http=c;d.msg=a;d.date=new Date;this.Ec.push(d);c.onreadystatechange=H(this,this.cl,c)}
;t.prototype.Vl=function(){this.ad.show(true)}
;t.prototype.Td=function(a,b){if(!this.Vi){this.Vi=true;this.Sd();var c=this.ad;if(c==null){c=new Sa(this,this.S);this.ad=c}c.Al(a,b);c.show(false)}}
;t.prototype.cl=function(a){if(a.readyState==4){try{if(a.status!=200){this.Td()}}catch(b){this.Td()}if(this.qi(a.responseText,a)){this.wh(false)}}}
;t.prototype.Tj=function(a){if(a==null){return true}var b=this.Rb;if(b!=null){if(b<a[0]-1){this.ui();return false}}this.Rb=a[a.lenghth-1];return true}
;t.prototype.ui=function(){this.ab(this.Rb,q.errorSeq,false)}
;t.prototype.zk=function(a){if(a!=null){var b=this.Ec;for(var c=0;c<b.length;c++){if(b[c].http==a){b.splice(c,1);return true}}}return false}
;t.prototype.qj=function(){var a=this.Ec;if(a!=null){return a.length>0}return false}
;t.prototype.qi=function(a,b){var c=this.zk(b);var d=null;var e=this.grids;var f=null;var g=null;var h=null;this._action=null;this._sq=null;this._c=null;this._a=null;if(a!=null){if(a.indexOf("action")>-1){this.screenHttp.tg(a)}}eval(a);if(this._action==9){var i=this._c;var j=this._a;if(!this.Tj(this._sq)){return false}try{if(i!=null){var l=0;for(var k=0;k<i.length;k++){l=i[k].t;if(i[k].g==null){switch(l){case q.mode:this.setMode(i[k].v);break;case q.errorSuggReload:this.Td("Server error","We're sorry. The server encountered an error. If you have made changes in the last few minutes, they may not have been saved."
);break;case q.errorLow:this.Y(i[k].v);break;case q.errorHigh:alert(i[k].v);break;default:break}}else{d=e.ids[i[k].g];g=d.info.idsTOrows;h=d.info.idsTOcols;var n,o,r,s;switch(l){case q.resizeRow:n=g[i[k].r];o=g[i[k].r2];d.of(n,o,true,i[k].sz,true);this.mouseSelection.Re(n);d.Za();break;case q.resizeCol:r=h[i[k].c];s=h[i[k].c2];d.of(r,s,false,i[k].sz,true);this.mouseSelection.Re(r);d.Za();break;case q.tc:n=g[i[k].r];o=g[i[k].r2];r=h[i[k].c];s=h[i[k].c2];d.tc(n,r,o-n+1,s-r+1);d.Za();break;case q.Ud:
n=g[i[k].r];o=g[i[k].r2];r=h[i[k].c];s=h[i[k].c2];d.Ud(n,r,o-n+1,s-r+1);d.Za();break;case q.vc:this.vc(d,i[k].nm,i[k].ng,i[k].rs,i[k].cs,c);break;case q.yb:this.yb(d,c);break;case q.Wb:this.Wb(null,d,i[k].nm,null);break;case q.Xa:this.Xa(d,i[k].pg,c);break;case q.freeze:d.Ke(i[k].r,true);break;default:if(l==q.pasteCut){this.copyPaste.copyType=null}else if(l>=q.rowInsert&&l<=q.colDelete||l==q.rowInsertAfter||l==q.colInsertAfter){d.sk(l,i[k])}if(i[k].fI!=null||i[k].nI!=null||i[k].v!=null){d.info.gm(
i[k])}if(i[k].css!=null){d.fm(i[k])}break}}}if(!this.isIE){for(var w=0;w<this.grids.T();w++){this.M(w).j().Uj()}}}if(j!=null){d=this.activeGrid;f=d.j();var C=null;var n,o,r;for(var k=0;k<j.length;k++){if(d.id!=j[k].g){d=e.ids[j[k].g];f=d.j()}g=d.info.idsTOrows;h=d.info.idsTOcols;n=g[j[k].r];r=h[j[k].c];C=f.e(n).cells[r];if(k>0&&n!=o){d.lastTblHeight=-1}o=n;X(null,C,j[k].v);d.info.Cl(n,r,j[k])}}}catch(F){this.ab(sc(F),q.error9,false)}for(var k=0;k<e.T();k++){d=e.M(k);if(d.j().th()){d.rowHObj.ke();
this.mouseSelection.xi(d)}}d=this.activeGrid;d.xf(d.wa(),true);if(this.gooffiLink!=null){this.gooffiLink.Jk(i,j)}this.testScripts.check()}return true}
;t.prototype.cleanup=function(){this.gooffiLink=null;this.Ec=null;this.ac=ka(this.ac);this.oe=true;this.Sd();this.qc=null;this.Ha.cleanup();this.iconManager=null;this.cellSelection.cleanup();this.mouseSelection.hl();var a=null;for(var b=0;b<this.grids.T();b++){a=this.grids.M(b);this.mouseSelection.gl(a,a.divTop)}var c=this.screenFuncs;if(c!=null){c.cleanup()}c=this.ad;if(c!=null){c.cleanup();c=null}this.dboxAlert.cleanup();this.screenHttp.cleanup();this.S=null;this.win=null;this.doc=null;this.grids=
null;this.activeGrid=null;this.activeFormuGrid=null;this.divGrids=null;this.Fc=null;this.bd=null;this.Ee=null;this.Ha=null;this.Nf=null;if(this.menuMain!=null){this.menuMain.cleanup();this.menuMain=null}this.$=null;this.cellSelection=null;this.mouseSelection=null;this.dboxAlert=null;this.screenHttp=null;this.screenFuncs=null;this.modalDbox=null;this.copyPaste=null;this.testScripts=null}
;
var Q="Updating...";var $a="A server error occoured.  Please press 'Reload' in your browser.";var Tb="It looks like your formula has errors. Make sure your formula has matching parenthesis.";var Vb="You can't merge unless multiple cells are selected";
function zc(a){if(!/^((ftp|http|https|gopher|mailto|news|telnet|aim):\/\/)/.test(a)){a="http://"+a}return a}
function sa(a,b,c,d,e,f,g,h){var i=a.createElement(h);i.className=c;var j=i.style;j.left=d+"px";j.top=e+"px";j.width=f;j.height=g;b.appendChild(i);return i}
function U(a,b,c){if(a.currentStyle){return a.currentStyle[b]}else{var d=a.ownerDocument.window;if(d.getComputedStyle){return d.getComputedStyle(a,"").getPropertyValue(c)}}return null}
function Va(a){if(a>0){return 1}else if(a<0){return-1}else{return 0}}
function Ia(a){if(a.childNodes.length>0){return a.childNodes[0].nodeValue}else{return""}}
function ib(a){return Ia(a).length==0}
function X(a,b,c){if(b.childNodes.length>0){b.childNodes[0].nodeValue=c}else{b.innerHTML="";if(a==null){a=b.ownerDocument}b.appendChild(a.createTextNode(c))}}
function Ac(a){var b;for(var c=0;c<a.length;c++){b=a.charCodeAt(c);if(b==32){}else if(b<48||b>122||b>57&&b<65||b>90&&b<97){return false}}return true}
function Xb(a,b,c,d){var e;if(u.type==1&&d!=true){e=b.insertCell(0);b.insertBefore(e,b.cells[c+1])}else{e=b.insertCell(c)}e.className=a.className;return e}
function ab(a){if(u.type==1){var b=a.parentNode.cells;for(var c=1;c<b.length;c++){if(b[c]===a){return c}}return null}else{return a.cellIndex}}
function ta(a,b){if(a.colSpan>1){var c=a.colSpan;var d=1;var e=ab(a);var f=b.j().e(0).cells;var g=1;var h=null;while(g<c){h=f[e+d];d++;if(!b.O(null,h)){g++}}return d}return 1}
function Ha(a,b,c){if(a.mergP==null){var d=a.parentNode.cells;var e=ab(a);while(b.O(null,a)&&e>0){e--;a=d[e]}if(a.colSpan>1){if(c==false){return e}else{return a}}}else{if(c==false){return ab(a.mergP)}else{return a.mergP}}return null}
function Yb(a){var b=U(a,"fontWeight","font-weight");return b===700||b==="bold"}
function Zb(a){var b=U(a,"fontStyle","font-style");return b==="italic"}
function $b(a){var b=U(a,"textDecoration","text-decoration");return b==="underline"}
function vc(a,b,c){if(u.type==1){a.addRule(b,c)}else{a.insertRule(b+" {"+c+"}",a.cssRules.length)}}
function xc(a,b){var c=a.styleSheets;var d,e,f;b="."+b;for(d=0;d<c.length;d++){if(u.type==1){f=c[d].rules}else{f=c[d].cssRules}for(e=0;e<f.length;e++){if(f[e].selectorText==b){return f[e].style.cssText}}}return null}
;
function fb(a,b,c){this.p=a;this.cm=b;this.vj=c;this.U=null;this.aa=null;this.Je=false;this.Qe=null;this.Yc=0}
fb.prototype.disconnect=function(){this.Je=true;ka(this.Qe);if(this.aa!=null){this.aa.Tf()}this.U=null;this.aa=null}
;fb.prototype.connect=function(){kb=undefined;if(this.Je){return false}if(typeof ob=="undefined"){window.status="Operating in non-collaborative mode!"}else{this.Yc++;var a=new Object;a.BrowserChannelClosed=function(c){}
;a.BrowserChannelOpened=function(c,d){var e=c.owner;e.p.oa("Connected");e.Yc=0;e.p.ui()}
;a.BrowserChannelError=function(c,d){if(c.ec){var e=c.owner;ka(e.Qe);var f=6000+Math.random()*1000;if(e.Yc>0){f=0}e.Qe=qa(e,e.dm,f)}}
;a.BrowserChannelHandleArray=function(c,d){c.owner.p.qi(d[0])}
;var b=new ob("1");b.hc(a);b.dc(window.location,this.cm,this.vj);b.owner=this;this.aa=b;this.U=a}}
;fb.prototype.dm=function(){if(!this.Je){var a=this.p;if(a.getDivApp().trixNode===a){a.oa("Disconnected","secStatDisconn");if(this.Yc>(u.type==1?3:10)){a.Td()}else{this.connect()}}else{a.cleanup()}}}
;
m.imgPath=null;m.MENU_ID=["menu_color_","menu_font_","menu_size_"];m.DEFAULT_VALUE=[m.COLOR_DEFAULT,m.FONT_DEFAULT,m.SIZE_DEFAULT];m.MENU_STYLE="font-size:10pt;font-family:arial;text-decoration:none;display:block;padding:2 9 2 4;color:#000;";m.MENU_CHILD_STYLE="vertical-align:middle";m.UNHIGHLIGHT_BACK="#c3d9ff";m.UNHIGHLIGHT_FORE="#000";m.HIGHLIGHT_BACK="#5570cc";m.HIGHLIGHT_FORE="#fff";m.FCOLOR=-1;m.BGCOLOR=0;m.FONT=1;m.SIZE=2;m.BORDER=5;m.ALIGN=6;m.COLOR_PALETTE_ID_PREFIX="menu_cp_";m.COLOR_DEFAULT=
"000000";m.COLORS=[["ffffff","c0c0c0","969696","808080","333333"],["cc99ff","993366","800080","6666cc","333399"],["99ccff","00ccff","3366ff","0000ff","000080"],["ccffff","00ffff","33cccc","008080","003366"],["ccffcc","00ff00","339966","008000","003300"],["ffff99","ffff00","99cc00","808000","333300"],["ffcc99","ffcc00","ff9900","ff6600","993300"],["ff99cc","ff00ff","ff0000","800000","000000"]];m.FONT_DEFAULT="fontname-default";m.FONT_NORMAL="Normal";m.FONTS=[["fontname-times","times new roman,serif"
,"Times New Roman"],["fontname-arial","arial,sans-serif","Arial"],["fontname-courier","courier new,monospace","Courier New"],["fontname-georgia","georgia","Georgia"],["fontname-trebuchet","trebuchet ms","Trebuchet"],["fontname-verdana","verdana","Verdana"]];m.FONT_MENU_ITEMS=[m.FONT_DEFAULT,m.FONTS[0][0],m.FONTS[1][0],m.FONTS[2][0],m.FONTS[3][0],m.FONTS[4][0],m.FONTS[5][0]];m.FONT_VALUE_MAP={"fontname-default":"arial,sans-serif","fontname-times":"times new roman,serif","fontname-arial":"arial,sans-serif"
,"fontname-courier":"courier new,monospace","fontname-georgia":"georgia","fontname-trebuchet":"trebuchet ms","fontname-verdana":"verdana"};m.SIZE_MENU_ITEMS=["fontsize-6","fontsize-7","fontsize-8","fontsize-9","fontsize-10","fontsize-11","fontsize-12","fontsize-14","fontsize-18","fontsize-24","fontsize-36"];m.SIZE_DEFAULT=m.SIZE_MENU_ITEMS[1];m.SIZE_6="6";m.SIZE_7="7";m.SIZE_8="8";m.SIZE_9="9";m.SIZE_10="10";m.SIZE_11="11";m.SIZE_12="12";m.SIZE_14="14";m.SIZE_18="18";m.SIZE_24="24";m.SIZE_36="36"
;m.SIZE_VALUE_MAP={"fontsize-6":6,"fontsize-7":7,"fontsize-8":8,"fontsize-9":9,"fontsize-10":10,"fontsize-11":11,"fontsize-12":12,"fontsize-14":14,"fontsize-18":18,"fontsize-24":24,"fontsize-36":36};m.SIZE_OPTION_HTML_MAP={"fontsize-6":'<font style="font-size:'+m.SIZE_VALUE_MAP["fontsize-6"]+"pt;"+m.MENU_CHILD_STYLE+'" unselectable=on>'+m.SIZE_6+"</font>","fontsize-7":'<font style="font-size:'+m.SIZE_VALUE_MAP["fontsize-7"]+"pt;"+m.MENU_CHILD_STYLE+'" unselectable=on>'+m.SIZE_7+"</font>","fontsize-8"
:'<font style="font-size:'+m.SIZE_VALUE_MAP["fontsize-8"]+"pt;"+m.MENU_CHILD_STYLE+'" unselectable=on>'+m.SIZE_8+"</font>","fontsize-9":'<font style="font-size:'+m.SIZE_VALUE_MAP["fontsize-9"]+"pt;"+m.MENU_CHILD_STYLE+'" unselectable=on>'+m.SIZE_9+"</font>","fontsize-10":'<font style="font-size:'+m.SIZE_VALUE_MAP["fontsize-10"]+"pt;"+m.MENU_CHILD_STYLE+'" unselectable=on>'+m.SIZE_10+"</font>","fontsize-11":'<font style="font-size:'+m.SIZE_VALUE_MAP["fontsize-11"]+"pt;"+m.MENU_CHILD_STYLE+'" unselectable=on>'
+m.SIZE_11+"</font>","fontsize-12":'<font style="font-size:'+m.SIZE_VALUE_MAP["fontsize-12"]+"pt;"+m.MENU_CHILD_STYLE+'" unselectable=on>'+m.SIZE_12+"</font>","fontsize-14":'<font style="font-size:'+m.SIZE_VALUE_MAP["fontsize-14"]+"pt;"+m.MENU_CHILD_STYLE+'" unselectable=on>'+m.SIZE_14+"</font>","fontsize-18":'<font style="font-size:'+m.SIZE_VALUE_MAP["fontsize-18"]+"pt;"+m.MENU_CHILD_STYLE+'" unselectable=on>'+m.SIZE_18+"</font>","fontsize-24":'<font style="font-size:'+m.SIZE_VALUE_MAP["fontsize-24"
]+"pt;"+m.MENU_CHILD_STYLE+'" unselectable=on>'+m.SIZE_24+"</font>","fontsize-36":'<font style="font-size:'+m.SIZE_VALUE_MAP["fontsize-36"]+"pt;"+m.MENU_CHILD_STYLE+'" unselectable=on>'+m.SIZE_36+"</font>"};m.BORDER_PALETTE_ID_PREFIX="menu_bord_";m.BORDERS=[[14,16,17,15],[18,19,20,21]];m.BORDERVALS=[["111100","000011","111111","222222"],["100000","001000","010000","000100"]];m.ALIGN_PALETTE_ID_PREFIX="menu_align_";m.ALIGNS=[[7,8,9],[10,11,12]];m.ALIGNVALS=[["left","center","right"],["top","middle"
,"bottom"]];function m(a,b,c,d){m.imgPath=d;this.app=a;this.win=a.sb();this.divOwner=b;this.styleNm="";this.menutype=c;this.actualtype=null;this.div_id=m.MENU_ID[c];this.selected=m.DEFAULT_VALUE[c]}
m.prototype.zl=function(a,b){this.actualtype=b;this.menutype=a;this.div_id=m.MENU_ID[a];this.selected=m.DEFAULT_VALUE[a]}
;m.prototype.$j=function(){return this.actualtype}
;m.prototype.open=function(a,b,c){var d=false;var e=this.win.document.getElementById(this.div_id);if(e==null){d=true;e=this.win.document.createElement("div");e.style.left=a;e.style.top=b;e.id=this.div_id;m.Gl(e,this.menutype);this.divOwner.appendChild(e)}this.dl(e,d);this.styleNm=c;var f=e.style;f.zIndex=100;f.left=a;f.top=b;f.display="block"}
;m.prototype.close=function(){var a=this.win.document.getElementById(this.div_id);if(a!=null){a.style.display="none"}}
;m.prototype.yk=function(){var a=this.win.document.getElementById(this.div_id);return a&&a.style.display=="block"}
;m.prototype.dl=function(a,b){if(b||this.menutype!=m.BGCOLOR){a.innerHTML=m.ek(this.menutype,this.selected);this.jj(a)}}
;m.prototype.jj=function(a){if(this.menutype==m.BGCOLOR){for(var b=0;b<m.COLORS.length;b++){for(var c=0;c<m.COLORS[b].length;c++){var d=m.COLOR_PALETTE_ID_PREFIX+m.COLORS[b][c];var e=this.win.document.getElementById(d);e.onmouseover=m.Fb(this,d,"white");e.onmouseout=m.Fb(this,d,"#bbb");e.onclick=m.zj(this,d)}}}else if(this.menutype==m.BORDER){for(var b=0;b<m.BORDERS.length;b++){for(var c=0;c<m.BORDERS[b].length;c++){var d=m.BORDER_PALETTE_ID_PREFIX+m.BORDERVALS[b][c];var e=this.win.document.getElementById(
d);e.onmouseover=m.Fb(this,d,"white");e.onmouseout=m.Fb(this,d,"#c3d9ff");e.onclick=m.rj(this,d)}}}else if(this.menutype==m.ALIGN){for(var b=0;b<m.ALIGNS.length;b++){for(var c=0;c<m.ALIGNS[b].length;c++){var d=m.ALIGN_PALETTE_ID_PREFIX+m.ALIGNVALS[b][c];var e=this.win.document.getElementById(d);e.onmouseover=m.Fb(this,d,"white");e.onmouseout=m.Fb(this,d,"#c3d9ff");e.onclick=m.mj(this,d,b==0)}}}else{var f=m.fk(this.menutype);var g=a.childNodes[0].rows;for(var b=0;b<f.length;b++){var d=f[b];g[b].onmouseover=
m.mh(this,d,m.HIGHLIGHT_FORE,m.HIGHLIGHT_BACK);g[b].onmouseout=m.mh(this,d,m.UNHIGHLIGHT_FORE,m.UNHIGHLIGHT_BACK);g[b].onclick=m.gk(this,d)}}}
;m.fk=function(a){if(a==m.FONT){return m.FONT_MENU_ITEMS}else if(a==m.SIZE){return m.SIZE_MENU_ITEMS}}
;m.Gl=function(a,b){a.style.cursor="pointer";a.style.border="2px solid";a.style.borderColor="#e8f1ff #9daecd #9daecd #e8f1ff";a.style.padding="2";a.style.background="#c3d9ff";a.style.zIndex="2";a.style.position="absolute"}
;m.ek=function(a,b){if(a==m.BGCOLOR){return m.yj()}else if(a==m.FONT){return m.Xg(m.FONT_MENU_ITEMS,m.Wj(),b)}else if(a==m.SIZE){return m.Xg(m.SIZE_MENU_ITEMS,m.SIZE_OPTION_HTML_MAP,b)}else if(a==m.BORDER){return m.Bg(m.BORDER_PALETTE_ID_PREFIX,m.BORDERS,m.BORDERVALS)}else if(a==m.ALIGN){return m.Bg(m.ALIGN_PALETTE_ID_PREFIX,m.ALIGNS,m.ALIGNVALS)}}
;m.Xg=function(a,b,c){var d="<table border=0 cellpadding=0 cellspacing=0>";for(var e=0;e<a.length;e++){var f=a[e];var g=b[f];var h="&nbsp;";d+='<tr><td style="'+m.MENU_STYLE+'" id="'+f+'" unselectable=on  >'+h+"&nbsp;"+g+"</td></tr>"}return d+"</table>"}
;m.mh=function(a,b,c,d){return function(){m.xh(a.win,b,c,d)}
}
;m.gk=function(a,b){return function(){a.close();a.selected=b;m.xh(a.win,b,m.UNHIGHLIGHT_FORE,m.UNHIGHLIGHT_BACK);a.app.wb(m.jk(b,a.menutype),a.styleNm)}
}
;m.xh=function(a,b,c,d){m.yf(a,b,"color",c);m.yf(a,b,"background",d)}
;m.yf=function(a,b,c,d){var e=a.document.getElementById(b);e.style[c]=d}
;m.jk=function(a,b){if(b==m.FONT){return m.Xj()[a]}else if(b==m.SIZE){return m.SIZE_VALUE_MAP[a]}}
;m.yj=function(){var a=["<table cellspacing=0 cellpadding=0>"];for(var b=0;b<m.COLORS.length;b++){a[a.length]="<tr>";for(var c=0;c<m.COLORS[b].length;c++){a[a.length]="<td id="+m.COLOR_PALETTE_ID_PREFIX+m.COLORS[b][c]+" bgcolor=#"+m.COLORS[b][c]+" unselectable=on style='width:15px;height:15px;padding:0px;margin:0px;border:1px solid #bbb;'><img width=1 height=1></td>"}}a[a.length]="</table>";return a.join("")}
;m.Fb=function(a,b,c){return function(){m.Xc(a.win,b,c)}
}
;m.zj=function(a,b){return function(){a.close();a.selected=b.substr(m.COLOR_PALETTE_ID_PREFIX.length);m.Xc(a.win,b,"#bbb");a.app.wb("#"+a.selected,a.styleNm)}
}
;m.Xc=function(a,b,c){m.yf(a,b,"borderColor",c)}
;m.Wj=function(){var a=new Object;a[m.FONT_DEFAULT]=m.FONT_NORMAL;for(var b=0;b<m.FONTS.length;++b){var c=m.FONTS[b];a[c[0]]='<font face="'+c[1]+'" class='+m.MENU_CHILD_STYLE+" unselectable=on>"+c[2]+"</font>"}return a}
;m.Xj=function(){var a=new Object;a[m.FONT_DEFAULT]=m.FONTS[1][1];for(var b=0;b<m.FONTS.length;b++){a[m.FONTS[b][0]]=m.FONTS[b][1]}return a}
;m.Bg=function(a,b,c){var d=["<table cellspacing=0 cellpadding=0>"];for(var e=0;e<b.length;e++){d[d.length]="<tr>";for(var f=0;f<b[e].length;f++){d[d.length]="<td id="+a+c[e][f]+" unselectable=on style='padding:2;border:1px solid #c3d9ff;'><div style='width:18;height:18;' class='menuToolbarCell'><img src='"+m.imgPath+"/toolbarAll3.gif' style='position:absolute;left:"+-18*b[e][f]+"'></div></td>"}d[d.length]="</tr>"}d[d.length]="</table>";return d.join("")}
;m.rj=function(a,b,c){return function(){a.close();a.selected=b.substr(m.BORDER_PALETTE_ID_PREFIX.length);m.Xc(a.win,b,"#c3d9ff");a.app.wb(a.selected,a.styleNm)}
}
;m.mj=function(a,b,c){return function(){a.close();a.selected=b.substr(m.ALIGN_PALETTE_ID_PREFIX.length);m.Xc(a.win,b,"#c3d9ff");if(c){a.app.wb(a.selected,"textAlign")}else{a.app.wb(a.selected,"verticalAlign")}}
}
;
function ca(a,b,c,d){this.Mg=v(a,b,"dropMenu",0,0,"","");var e=da(a,this.Mg,"dropMenu","");var f,g,h;for(var i=0;i<c.length;i++){f=e.insertRow(i);g=f.insertCell(0);if(c[i]==null){g.colSpan=2;g.className="sep";if(d){g=f.insertCell(1);g.className="sep"}}else{h="<div class='item'>";h+=c[i][0];h+="</div>";g.innerHTML=h;if(d){g.colSpan=2;g=f.insertCell(1);h="<div class='key'>";if(c[i][1]!=null){h+=c[i][1]}h+="</div>";g.innerHTML=h}}this.enable(f,i,true)}this.qf=e.rows;this.menuHeight=e.offsetHeight;this.menuWidth=
e.offsetWidth;this.ua("none",null,null);this.isVisible=false}
ca.prototype.enable=function(a,b,c){if(c){a.onmouseover=M(this,this.Ii,b,"#D3E3FE");a.onmouseout=M(this,this.Ii,b,"");a.style.cursor="pointer";a.cells[0].style.color=""}else{a.onmouseover=null;a.onmouseout=null;a.onclick=null;a.style.cursor="";a.cells[0].style.color="#676767"}}
;ca.prototype.Ii=function(a,b){this.qf[a].style.backgroundColor=b}
;ca.prototype.xa=function(){return this.qf}
;ca.prototype.y=function(a,b){var c=this.qf[a];if(b==null){c.style.display="none"}else{c.style.display="";c.cells[0].childNodes[0].innerHTML=b}}
;ca.prototype.ua=function(a,b,c){var d=this.Mg.style;if(b!=null){d.left=b;d.top=c}d.display=a;this.isVisible=a.length==0}
;
function Qb(a,b){var c=[];for(var d=0;d<b.length;d++){var e=new Image;e.src=a+b[d];c.push(e)}return c}
function K(a,b,c){var d=a.insertRow(a.rows.length);var e=d.insertCell(0);if(c!=null){e.className=c}if(b!=null){e.style.height=b}return e}
function ha(a,b,c,d){var e=a.createElement("a");e.href=c;e.appendChild(a.createTextNode(d));b.appendChild(e);return e}
function xa(a,b,c){var d=a.createTextNode(c);b.appendChild(d);return d}
function V(a,b,c,d){var e=a.createElement("span");e.innerHTML=c;e.className=d;b.appendChild(e);return e}
function sb(a,b,c,d,e,f){var g=a.createElement("img");g.src=c;g.className=d;g.style.cssText=e;g.title=f;b.appendChild(g);return g}
function da(a,b,c,d){var e=a.createElement("table");e.className=c;e.style.cssText=d;e.cellPadding=0;e.cellSpacing=0;b.appendChild(e);return e}
function v(a,b,c,d,e,f,g,h){var i=a.createElement("div");i.className=c;var j=i.style;j.left=d+"px";j.top=e+"px";j.width=f;j.height=g;if(h==null){b.appendChild(i)}else{b.insertBefore(i,h)}return i}
function pa(a,b,c,d,e,f,g,h,i,j,l){var k=null;if(l==="textarea"){k=a.createElement("textarea")}else{k=a.createElement("input");k.type=l}k.className=c;var n=k.style;n.cssText=d;n.position=e;if(f!=null){n.left=f+"px"}if(g!=null){n.top=g+"px"}n.width=h;n.height=i;k.tabIndex=j;b.appendChild(k);return k}
function Ma(a,b,c,d,e,f,g,h,i){var j=pa(a,b,g,"","absolute",c,d,e,f,1,"button");j.onclick=i;j.value=h;return j}
function Rb(a,b){return function(){a.className=b}
}
function tb(a,b,c,d){var e=a.createElement("div");e.className="regularButton";e.innerHTML=c;var f=e.style;var g="url("+d+"buttonLight.gif)";var h="url("+d+"buttonLightPressed.gif)";f.backgroundImage=g;e.onmousedown=Qa(f,h);e.onmouseup=Qa(f,g);e.onmouseout=Qa(f,g);b.appendChild(e);return e}
function Qa(a,b){return function(){a.backgroundImage=b}
}
function Na(a,b,c,d,e){var f="url("+d+"buttonLight.gif)";var g="url("+d+"buttonLightPressed.gif)";var h=a.createElement("table");h.className="buttonTable";h.cellPadding=0;h.cellSpacing=0;b.appendChild(h);h.style.height=e;var i=h.insertRow(0);var j=i.insertCell(0);j.innerHTML="&nbsp;";j.style.backgroundImage=f;j.className="buttonTopLeft";var l=c.length;var k=[];var n,o;for(var r=0;r<l;r++){j=i.insertCell(r+1);o=j.style;o.backgroundImage=f;j.onmousedown=Qa(o,g);j.onmouseup=Qa(o,f);j.onmouseout=Qa(o,
f);n="buttonContent";if(l>1){if(r==0){n+=" pill first"}else{n+=" pill"}}j.className=n;j.innerHTML="<div class='buttonText'>"+c[r]+"</div>";k[r]=j}var s=i.cells;j=i.insertCell(l+1);j.innerHTML="&nbsp;";j.style.backgroundImage=f;j.className="buttonTopRight";i=h.insertRow(1);j=i.insertCell(0);j.innerHTML="&nbsp;";j.style.backgroundImage=f;j.className="buttonBottomLeft";j=i.insertCell(1);j.innerHTML="&nbsp;";j.style.backgroundImage=f;j.className="buttonBottomRight";for(var r=0;r<l;r++){s[r+1].rowSpan=
2}k.container=h;return k}
function L(a,b){return function(){return b.call(a)}
}
function H(a,b,c){return function(){return b.call(a,c)}
}
function M(a,b,c,d){return function(){return b.call(a,c,d)}
}
function la(a,b,c,d,e,f){var g=[];for(var h=2;h<arguments.length;h++){g[h-2]=arguments[h]}return function(){return b.apply(a,g)}
}
function Pa(a,b,c,d,e,f,g){var h=[];for(var i=3;i<arguments.length;i++){h[i-3]=arguments[i]}var j=window.setInterval(function(){b.apply(a,h)}
,c);return j}
function qa(a,b,c,d,e,f){var g=[];for(var h=3;h<arguments.length;h++){g[h-3]=arguments[h]}var i=window.setTimeout(function(){b.apply(a,g)}
,c);return i}
function ka(a){if(a!=null){window.clearInterval(a)}return null}
function W(a,b,c){var d=null;try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){try{d=new XMLHttpRequest}catch(e){return null}}if(a!=null){d.open("POST",a,c);d.setRequestHeader("Cache-Control","no-cache");d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.setRequestHeader("Content-Length",b.length);d.send(b)}return d}
function Sb(a,b){var c=null;if(b==true){c=window.open(a)}else{c=window.open("http://www.google.com/url?q="+a+"&sa=D")}c.focus();return c}
function tc(a){if(a.length>30){a=a.substring(0,27)+"..."}return a}
function ra(a){try{var b=eval(a);if(b[0]==0){return b[1]}else{alert(b[1]);return null}}catch(c){alert("Oops.  A server error occurred.");return null}}
function eb(a,b,c){if(u.type==1){a.firstChild.removeChild(b)}else{a.deleteRow(c)}}
function Oa(a){if(a!=null){a.style.visibility="hidden"}}
function _GetWindowWidth(a){return Nb(a,Lc)}
function _GetWindowHeight(a){return Nb(a,Kc)}
function sc(a){var b="Unknown JS error.";if(a!=null){b="JS error: "+a.message}return b}
;
function La(a,b,c){this.I=a;var d="ifrm"+c;this.rk=c;this.initFileUpload=false;this.Cd=null;var e="<iframe src='javascript:return false;' name=";e+=d;e+=" id=";e+=d;e+=" style='display:none;'></iframe>";b.innerHTML=e;this.iFrame=a.getElementById(d);var f=a.createElement("form");f.onsubmit=function(){return false}
;f.method="post";f.target=d;f.style.margin=0;f.encoding="multipart/form-data";f.acceptCharset="utf-8";b.appendChild(f);this.Xe=f;this.qd=null;this.jf()}
La.prototype.jf=function(){var a=null;var b=this.qd;if(b!=null){a=b.onchange;if(b.value.length==0){return false}}var c=this.rk;var b=this.I.createElement("input");b.type="file";b.setAttribute("name",c);b.id=c;b.className="browseButton";b.onchange=a;var d=this.Xe;d.innerHTML="";d.appendChild(b);this.qd=b}
;La.prototype.Ji=function(a,b,c,d){if(u.type==1){this.Cd=p.createAdapter(a,c);p.addBuiltInListener(this.iFrame,"load",this.Cd)}else{this.iFrame.onload=L(a,c)}this.Xe.action=b;this.qd.onchange=M(this,this.zc,a,d)}
;La.prototype.zc=function(a,b){var c=this.qd.value;var d=c.length;if(d<5)return false;if(c.substring(d-4,d-3)!=".")return false;var e=c.substring(d-4).toLowerCase();var f=false;if(e==".xls"||e==".csv"){f=true;this.initFileUpload=true;this.Xe.submit()}b.call(a,f,c)}
;La.prototype.cleanup=function(){if(this.Cd!=null){p.removeBuiltInListener(this.iFrame,"load",this.Cd)}}
;
function lb(a,b,c){var d=window.setTimeout(function(){b.apply(a)}
,c);return d}
function fc(a,b,c){var d=window.setInterval(function(){b.apply(a)}
,c);return d}
Array.prototype.clear=function(){while(this.length>0)this.pop()}
;document.getElementsByClassName=function(a){var b=document.all;if(!b)b=document.getElementsByTagName("*");var c=[];for(var d=0;d<b.length;d++){if(b[d].className==a){c[c.length]=b[d]}}return c}
;function N(a){if(u.type==1){window.event.cancelBubble=true;window.event.returnValue=false}else{a.cancelBubble=true;a.preventDefault();a.stopPropagation()}}
if(!Array.prototype.push){Array.prototype.push=function(a){this[this.length]=a}
}function Tc(a){return document.getElementById(a)}
function _nullFunction(){}
;
function hc(a,b,c){this.type=a;this.version=b;this.os=c;this.firefox=false;this.good=true}
;var u=new hc(0,0,null);var ga=navigator.userAgent.toLowerCase();if(ga.indexOf("opera")!=-1){u.good=false;u.type=4;if(ga.indexOf("opera/7")!=-1||ga.indexOf("opera 7")!=-1){u.version=7}else if(ga.indexOf("opera/8")!=-1||ga.indexOf("opera 8")!=-1){u.version=8}}else if(ga.indexOf("msie")!=-1&&document.all){u.type=1;if(ga.indexOf("msie 5")!=-1){u.version=5;u.good=false}}else if(ga.indexOf("safari")!=-1){u.type=3}else if(ga.indexOf("mozilla")!=-1){u.type=2;if(ga.indexOf("firefox")!=-1){u.firefox=true;
if(parseInt(navigator.productSub)<20050915){u.good=false}else if(navigator.vendorSub=="1.0.7"){u.version=1.07}}}if(ga.indexOf("x11;")!=-1){u.os=1}else if(ga.indexOf("macintosh")!=-1){u.os=2}function Nc(){if(!u.good){if(u.type==1){alert("Oops, you must have IE version 6 or higher.")}else if(u.firefox){alert("Oops, you must have Firefox version 1.0.7 or higher.")}else{alert("Oops, we currently only support Firefox and IE.")}return false}else if(u.type==3){return confirm("Oops, sorry Safari is not yet supported.\nDo you want to continue?"
)}return true}
;
function p(){}
p.addListener=function(a,b,c){var d=p.getPropertyName(b);if(a[d]){a[d].push(c)}else{a[d]=[c]}return new nc(a,d,c)}
;p.removeListener=function(a){var b=a.instance[a.propertyName];for(var c=0;c<b.length;c++){if(b[c]==a.listenerFn){b.splice(c,1);return}}}
;p.clearListeners=function(a,b){var c=p.getPropertyName(b);a[c]=null}
;p.trigger=function(a,b){var c=p.getPropertyName(b);var d=a[c];if(d&&d.length>0){var e=[];for(var f=2;f<arguments.length;f++){e.push(arguments[f])}for(var f=0;f<d.length;f++){var g=d[f];if(g){try{g.apply(this,e)}catch(h){}}}}}
;function nc(a,b,c){this.instance=a;this.propertyName=b;this.listenerFn=c}
p.getPropertyName=function(a){return"_e__"+a}
;p.addBuiltInListener=function(a,b,c){if(u.type==3&&b=="dblclick"){a["on"+b]=c;return}if(a.addEventListener){a.addEventListener(b,c,false)}else if(a.attachEvent){a.attachEvent("on"+b,c)}else{a["on"+b]=c}}
;p.removeBuiltInListener=function(a,b,c){if(a.removeEventListener){a.removeEventListener(b,c,false)}else if(a.detachEvent){a.detachEvent("on"+b,c)}else{a["on"+b]=null}}
;p.bindDom=function(a,b,c,d){var e=p.createAdapter(c,d);return p.addBuiltInListener(a,b,e)}
;p.bind=function(a,b,c,d){return p.addListener(a,b,function(){d.apply(c,arguments)}
)}
;p.createAdapter=function(a,b){return function(c){if(!c){c=window.event}if(c&&!c.target){c.target=c.srcElement}b.call(a,c)}
}
;
function ob(a){this.E=null;this.ta=null;this.Vb=null;this.$b=null;this.Ed=null;this.Pb=null;this.Ta=null;this.B=1;this.Ad=0;this.Tb=new Array;this.U=null;this.Ti=0;this.Df=0;this.Hg=null;this.Fg=a;this.om=null;this.ef=null;this.re=null;this.Yi=null;this.Ih=-1}
ob.prototype={dc:function(a,b,c){A("BrowserChannel.Connect()");this.Ta=a;this.Vb=c;this.Sf(b)}
,Sf:function(a){A("BrowserChannel.ConnectTest_()");this.re=new Bb;this.re.hc(this);this.re.dc(this.Ta,a)}
,Rf:function(){A("BrowserChannel.ConnectChannel_()");this.Uf(1);this.$b=Ab(this.Ta,this.Vb);this.Hg=Ea();this.Mc()}
,Yd:function(){if(this.ta){this.ta.Ic();this.ta=null}if(this.E){this.E.Ic();this.E=null}}
,Tf:function(){A("BrowserChannel.Disconnect()");this.Yd();if(this.B==3){var a=this.Ad++;var b=this.$b+"&SID="+this.mb+"&RID="+a+"&TYPE=terminate";var c=new ya(this,this.mb,a);c.kg(b);this.be()}}
,bj:function(){return this.U}
,hc:function(a){this.U=a}
,ej:function(a){if(this.B==0){throw"Invalid operation: must be in the right state";}this.Tb.push(a);if(this.B==2||this.B==3){this.Vf()}}
,gj:function(a){this.km=a}
,fj:function(a){this.jm=a}
,ec:function(){return this.B==0}
,cj:function(){return this.hg()==0}
,hg:function(){var a=0;if(this.ta){a++}if(this.E){a++}return a}
,Vf:function(){if(this.E){return}if(this.ef){return}var a=this;this.ef=Fa(null,function(){a.ef=null;a.Mc()}
,0)}
,Mc:function(){A("BrowserChannel.Poll_()");if(this.Ti>0&&Ea()>this.Hg+this.Ti){this.qa(1);return}if(this.B==1){this.gg();this.B=2}else if(this.B==3){this.Wf();if(!this.Zd()){return}if(this.Tb.length==0){A("--------poll returned: nothing to send");return}if(this.E){A("--------poll returned: connection already in progress");return}this.ig();A("--------poll finished, sent request")}}
,gg:function(){A("BrowserChannel.Open_()");this.B=2;this.Ad=Math.floor(Math.random()*100000);var a=this.Ad++;var b=new ya(this,"",a);var c=this.ae();var d=this.$b+"&VER=4&RID="+a;if(this.Fg){d+="&CVER="+this.Fg}b.de(d,c,true);this.E=b}
,ig:function(){var a=this.Ad++;var b=this.$b+"&VER=2&SID="+this.mb+"&RID="+a;var c=this.ae();var d=new ya(this,this.mb,a);d.ic(3);this.E=d;d.de(b,c,true)}
,ae:function(){var a="count="+this.Tb.length+"&";for(var b=0;b<this.Tb.length;b++){var c=this.Tb[b];for(var d in c){a+="req"+b+"_"+d+"="+encodeURIComponent(c[d])+"&"}}this.Tb=new Array;return a}
,Wf:function(){if(this.ta){return}if(!this.Zd()){return}A("BrowserChannel: creating new BrowserChannelRequest");this.ta=new ya(this,this.mb,"rpc");var a=this.Ed;a=ia(a,"RID","rpc");a=ia(a,"SID",this.mb);a=ia(a,"CI",this.Yi?"0":"1");a=ia(a,"AID",this.Ih);if(ua()){a=ia(a,"TYPE","html");this.ta.ee(a,this.Pb)}else{a=ia(a,"TYPE","xmlhttp");this.ta.ic(3);this.ta.Jc(a,true)}A("BrowserChannel: new Request created")}
,Zd:function(){if(this.U.BrowserChannelCheckCookies){var a=this.U.BrowserChannelCheckCookies();if(a!=0){A("BrowserChannel: handler cookie check failed");this.qa(a);return false}}return true}
,Xd:function(a,b){A("BrowserChannel: connection test succeeded");this.Yi=b;this.Rf()}
,Pf:function(a,b){A("BrowserChannel: connection test failed");this.qa(2)}
,Of:function(a){A("BrowserChannel: test connection blocked");this.qa(9)}
,Db:function(a,b){if(this.B==0){return}var c=false;if(this.ta==a){c=true}else if(this.E==a){c=true}if(c==false){return}if(this.E==a&&this.B==3){if(b!="y2f%"){A("BrowserChannel: Bad data returned - missing/invalid magic cookie");this.qa(11)}}else{if(!(jc(b)=="")){var d=eval(b);this.ag(d)}}}
,ob:function(a){A("BrowserChannel: request complete");var b=false;if(this.ta==a){this.ta=null;b=true}else if(this.E==a){this.E=null;b=true}if(b==false){return}if(this.B==0){return}if(a.he()==false){A("BrowserChannel Error: HTTP request failed");if(a.fc()==1){this.qa(5)}else if(a.fc()==4){this.qa(109)}else if(a.fc()==3){this.qa(6)}else{this.qa(2)}return}this.Mc()}
,ag:function(a){for(var b=0;b<a.length;b++){var c=a[b];this.Ih=c[0];c=c[1];if(this.B==2){if(c[0]=="c"){this.mb=c[1];this.Pb=c[2];this.B=3;this.U.BrowserChannelOpened(this,this.mb);this.Ed=zb(this.Ta,this.Pb,this.Vb)}else if(c[0]=="stop"){this.qa(7)}}else if(this.B==3){if(c[0]=="stop"){this.qa(7)}else if(c[0]=="noop"){}else{this.U.BrowserChannelHandleArray(this,c)}}}}
,Uf:function(a){if(this.B!=a){throw"Invalid operation: must be in the right state";}}
,qa:function(a){if(a==2||a==9){var b=this;rc(function(c){if(c){b.Lc(a)}else{b.Lc(8)}}
)}else{this.Lc(a)}}
,Lc:function(a){A("BrowserChannel: error - "+a);this.B=0;this.U.BrowserChannelError(this,a);this.be();this.Yd()}
,be:function(){this.B=0;this.U.BrowserChannelClosed(this)}
};
function Ab(a,b){var c=pb(a,null,b);A("BrowserChannel: SendDataUrl: "+c);return c}
function zb(a,b,c){var d=pb(a,ua()?b:null,c);A("BrowserChannel: RecvDataUrl: "+d);return d}
function pb(a,b,c,d){var e;if(b){e=b+"."+a.hostname}else{e=a.hostname}var f;var g=d||a.port;var f=a.protocol+"//"+e+(g?":"+g:"")+a.pathname+c;return f}
;var Sc=Ea();
var yb=new Object;var mb=new Object;function ya(a,b,c){this.aa=a;this.mb=b;this.hb=c;this.Nh=0;this.retryTimerID=null;this.Ia=false;this.bc=null;this.Mf=null;this.$a=0;this.Gc=null;this.H=null;this.Ub=null;this.Q=null;this.Wd=null;this.Da=null;this.Bb=null;this.Sa=null;this.Si=this.fe();this.pa=window;this.Hi=true;this.Eb=false}
ya.prototype={ic:function(a){this.Nh=a}
,fe:function(){if(this.aa.Df>0){var a=Math.random()*100;return a<this.aa.Df}return false}
,de:function(a,b,c){this.Gc=2;this.H=this.gc(a);this.Ub=b;this.Kg=c;this.Nc()}
,Jc:function(a,b,c){this.Gc=2;this.H=this.gc(a);this.Ub=null;this.Kg=b;if(c){this.Hi=false}this.Nc()}
,Nc:function(){var a=this;var b=function(){try{a.fg()}catch(c){A("Failed call to OnXmlHttpReadyStateChanged_");if(a.Q&&a.Q.responseText){ma(c,"ResponseText: "+a.Q.responseText)}else{ma(c,"No response text")}}}
;this.Wd=0;this.Q=Cc();Ja("SendXmlHttp: "+this.H);if(this.Ub){this.Bb="POST";cc(this.Q,this.Bb,this.H,b);ec(this.Q,"Content-Type","application/x-www-form-urlencoded");dc(this.Q,this.Ub)}else{this.Bb="GET";cc(this.Q,this.Bb,this.H,b);if(this.Hi){ec(this.Q,"Connection","close")}dc(this.Q,null)}za(this.Bb,"XMLHTTP",this.hb,true,this.$a+1,false,"sendXmlHttp");if(this.Ub){$("<pre>"+oa(this.Ub)+"</pre>")}this.Cb()}
,fg:function(){if(ua()){if(this.Q.readyState<4){return}}else{if(this.Q.readyState<3){return}}if(this.Si){za(this.Bb,"XMLHTTP",this.hb,false,this.$a+1,true,"Simulating failure");Ja("Simulating failure");return}this.cc();var a=this.Q.readyState;try{var b=this.Q.status}catch(c){b=500}var d=this.Q.responseText;if(!d){A("BrowserChannelRequest: no response text for url "+this.H+" status "+b.toString())}this.Ia=b==200;za(this.Bb,"XMLHTTP",this.hb,false,this.$a+1,!this.Ia,"onXmlHttpReadyStateChanged");Ja(
"Readystate: "+a);Ja(b.toString());if(!this.Ia){if(b==400&&d.indexOf("Unknown SID")>0){this.Sa=3}else{this.Sa=0}if(d){$("<pre>"+oa(d)+"</pre>")}this.Kc();this.nb();return}if(a==4){this.nb()}if(this.Kg){while(!this.Eb&&this.Wd<d.length){var e=this.Yf(d);if(e==mb){if(a==4){this.Sa=4;this.Ia=false}$("<pre>[Incomplete Response]</pre>");break}else if(e==yb){this.Sa=4;this.Ia=false;break}else{$("<pre>"+oa(e)+"</pre>");this.aa.Db(this,e)}}if(a==4&&d.length==0){this.Sa=1;this.Ia=false}}else{$("<pre>"+oa(
d)+"</pre>");this.aa.Db(this,d)}if(!this.Ia){$("<pre>Invalid Chunked Response: "+oa(d)+"</pre>");this.Kc();this.nb();return}if(!this.Eb){if(a==4){this.aa.ob(this)}else{this.Cb()}}}
,Yf:function(a){var b=this.Wd;var c=a.indexOf("\n",b);if(c==-1){return mb}var d=a.substr(b,c-b);var e=parseInt(d,10);if(isNaN(e)){return yb}var f=c+1;if(f+e>a.length){return mb}var g=a.substr(f,e);this.Wd=f+e;return g}
,ee:function(a,b){this.Gc=4;this.H=this.gc(a);this.mg(b)}
,mg:function(a){this.Da=new ActiveXObject("htmlfile");var b="";var c="<html>";if(a){b=this.pa.location.hostname;c+="<script>document.domain='"+b+"'<\/script>"}c+="</html>";this.Da.open();this.Da.write(c);this.Da.close();var d=this;this.Da.parentWindow.m=function(g){d.dg(g)}
;this.Da.parentWindow.d=function(){d.ce(true)}
;this.Da.parentWindow.rpcClose=function(){d.ce(false)}
;var e=this.Da.createElement("DIV");this.Da.appendChild(e);var f=this.H+"&DOMAIN="+b;e.innerHTML='<IFRAME src="'+f+'"></IFRAME>';za("GET","TRIDENT",this.hb,true,this.$a+1,false,"SendUsingTrident");Ja(f);this.Cb()}
,dg:function(a){var b=this;Fa(this.pa,function(){b.cg(a)}
,0)}
,cg:function(a){if(this.Eb){return}za("GET","TRIDENT",this.hb,false,this.$a+1,false,"onTridentRpcMessageAsync");$("<pre>"+oa(a)+"</pre>");this.cc();this.aa.Db(this,a);this.Cb()}
,ce:function(a){var b=this;Fa(this.pa,function(){b.bg(a)}
,0)}
,bg:function(a){if(this.Eb){return}za("GET","TRIDENT",this.hb,false,this.$a+1,!a,"onTridentDoneAsync");$("<pre>Received done message: "+(a?"success":"failure")+"</pre>");this.cc();this.nb();this.Ia=a;this.aa.ob(this)}
,kg:function(a){this.Gc=3;this.H=this.gc(a);this.lg()}
,lg:function(){var a=this.pa.document.createElement("IMG");a.src=this.H;this.Cb()}
,Ic:function(){this.Eb=true;this.cc();this.nb();if(this.Fd){Cb(null,this.Fd);this.Fd=null}}
,Cb:function(){this.Mf=(new Date).getTime()+45000;this.ge(45000)}
,ge:function(a){gc(this.bc==null,"Watchdog timer not null");var b=this;this.bc=Fa(this.pa,function(){b.eg()}
,a)}
,cc:function(){if(this.bc){Cb(this.pa,this.bc);this.bc=null}}
,eg:function(){this.bc=null;var a=(new Date).getTime();if(a-this.Mf>0){this.Zf()}else{A("HttpConnection: Watchdog timer called too early");this.ge(this.Mf-a)}}
,Zf:function(){if(this.Ia){A("HttpConnection: Received watchdog timeout even though request loaded successfully")}za("GET/POST","TIMEOUT",this.hb,false,this.$a+1,true,"handleTimeout");this.nb();this.Sa=2;this.Kc()}
,Kc:function(){if(this.aa.ec()){return}if(this.Eb){return}if(this.Sa==3){$("<font color='red'>Unknown SID</font><br>");A("BrowserChannelRequest Error: Unknown SID. ");this.aa.ob(this)}else if(this.$a>=this.Nh){$("<font color='red'>Exceeded max number of retries</font><br>");A("BrowserChannelRequest Error: Exceeded max number of retries. Last Error:\n"+this.Xf(this.Sa)+"\n");this.aa.ob(this)}else{var a=this;this.Fd=Fa(null,function(){a.Fd=null;a.jg()}
,2000)}}
,Xf:function(a){if(a==0){return"Non-200 return code"}else if(a==1){return"XMLHTTP failure (no data)"}else if(a==2){return"HttpConnection timeout"}else{return"Unknown error"}}
,jg:function(){this.$a++;this.Si=this.fe();if(this.Gc==2){this.Nc()}}
,nb:function(){if(this.Q){Bc(this.Q);this.Q=null}if(this.Da){this.Da=null}}
,he:function(){return this.Ia}
,fc:function(){return this.Sa}
,dj:function(){return this.hb}
,gc:function(a){var b=Math.round(Math.random()*2147483648);var c=Math.round(Math.random()*2147483648);var d=b.toString(36)+(c^Ea()).toString(36);return ia(a,"zx",d)}
};function za(a,b,c,d,e,f,g){var h=new Array(7);var i=0;if(d){h[i++]="<b>";h[i++]=a;h[i++]=" ("+b+") ";h[i++]=c;h[i++]=" [attempt ";h[i++]=e;h[i++]="] ";h[i++]=g;h[i++]=" ))) </b><br>";$(h.join(""))}else{if(f){h[i++]="<font color='red'>"}h[i++]="<b>((( ";h[i++]=a;h[i++]=" ("+b+") ";h[i++]=c;h[i++]=" [attempt ";h[i++]=e;h[i++]="] ";h[i++]=g;h[i++]="</b><br>";if(f){h[i++]="</font>"}$(h.join(""))}var j=new Date;Ja(j.getDate()+"-"+["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"
][j.getMonth()]+" "+j.toLocaleTimeString())}
var ic=false;function Ja(a){$(oa(a)+"<br>")}
function $(a){if(ic){A("[browserchannel] "+a)}}
;
function Bb(){this.Q=null;this.E=null;this.Dd=false;this.Lb=null;this.Ve=null;this.U=null;this.H=null;this.Ta=null;this.Df=0}
Bb.prototype={dc:function(a,b){this.Ta=a;this.Vb=b;this.$b=Ab(this.Ta,this.Vb);var c=this.$b;c=ia(c,"MODE","init");this.E=new ya(this,"none","none");this.E.ic(0);this.E.Jc(c,false,true);this.B=0}
,Qf:function(){var a=pb(this.Ta,this.Ag,"images/cleardot.gif");a=ia(a,"rand",Ea());var b=this;Pb(a,5000,function(c){if(c){b.B=2;b.$d()}else{b.U.Of(this)}}
,3)}
,$d:function(){A("TestConnection: starting stage 2");this.E=new ya(this,"none","none");this.E.ic(0);var a=this.Ed;if(ua()){a=ia(a,"TYPE","html");this.E.ee(a,this.Pb)}else{a=ia(a,"TYPE","xmlhttp");this.E.Jc(a,false)}}
,Zi:function(){if(this.E){this.E.Ic();this.E=null}}
,hc:function(a){this.U=a}
,ec:function(){return false}
,Db:function(a,b){if(this.B==0){A("TestConnection: Got data for stage 1");if(!b){A("TestConnection: Null responseText")}var c=eval(b);this.Pb=c[0];this.Ag=c[1];this.Ed=zb(this.Ta,this.Pb,this.Vb)}else if(this.B==2){if(this.Dd==true){this.Ve=new Date}else{if(b=="1"){this.Dd=true;this.Lb=new Date}else{this.Lb=new Date;this.Ve=new Date;this.Dd=false}}}}
,ob:function(a){if(this.E.he()==false){A("TestConnection: request failed, in state "+this.B);this.U.Pf(this,this.E.fc());return}if(this.B==0){A("TestConnection: request complete for stage 1");if(this.Ag){this.B=1;this.Qf()}else{this.B=2;this.$d()}}else if(this.B==2){A("TestConnection: request complete for stage 2");var b=false;if(ua()){var c=this.Ve.valueOf()-this.Lb.valueOf();if(c<200){b=false}else{b=true}}else{b=this.Dd}if(b==true){A("Test connection succeeded; using streaming connection");this.U.Xd(
this,true)}else{A("Test connection failed; not using streaming");this.U.Xd(this,false)}}}
};
function bb(a){if(a in nb){return nb[a]}return nb[a]=navigator.userAgent.toLowerCase().indexOf(a)!=-1}
var nb={};function ua(){return bb("msie")}
function Qc(a){if(typeof Error!="undefined"){throw new Error(a||"Assertion Failed");}else{throw a;}}
function oc(a){if(a===undefined)a="Assertion failed";if(typeof Hb!="undefined")Hb(a+"\n");Qc(a)}
function gc(a,b){if(!a){if(b===undefined)b="Assertion failed";oc(b)}}
;function Ea(){return(new Date).getTime()}
function Mb(a){var b=a.offsetLeft;if(a.offsetParent!=null)b+=Mb(a.offsetParent);return b}
;var Lc={Ah:function(a){return a.document.body.clientWidth}
,Bh:function(a){return a.document.documentElement.clientWidth}
,Og:function(a){return a.innerWidth}
};var Kc={Ah:function(a){return a.document.body.clientHeight}
,Bh:function(a){return a.document.documentElement.clientHeight}
,Og:function(a){return a.innerHeight}
};function Nb(a,b){try{if("compatMode" in a.document&&a.document.compatMode=="CSS1Compat"){return b.Bh(a)}else if(ua()){return b.Ah(a)}}catch(c){}return b.Og(a)}
var Dc=/&/g;var Oc=/</g;var Mc=/>/g;function oa(a){if(!a)return"";return a.replace(Dc,"&amp;").replace(Oc,"&lt;").replace(Mc,"&gt;").replace(Pc,"&quot;")}
var Pc=/\"/g;var Rc=/\s+/g;var Ec=/^ /;var Fc=/ $/;function jc(a){if(!a)return"";return a.replace(Rc," ").replace(Ec,"").replace(Fc,"")}
function bc(a){return encodeURIComponent(a)}
function Fa(a,b,c){if(!a)a=window;if(!a._tm){a._tm=[]}var d=uc(a,b);var e=a.setTimeout(d,c);d.id=e;a._tm[e]=1;return e}
function uc(a,b){var c=function(){try{b(a);var d=a._tm;if(d){delete d[c.id]}}catch(e){ma(e)}}
;return c}
function Cb(a,b){if(!a)a=window;a.clearTimeout(b);if(a._tm){delete a._tm[b]}}
function Hc(a){return document.getElementById(a)}
function Ic(a){return document.all[a]}
var Gc=document.getElementById?Hc:Ic;function kb(a){try{if(window.parent!=window&&window.parent.log){window.parent.log(window.name+"::"+a);return}}catch(b){}var c=Gc("log");if(c){var d="<p class=logentry><span class=logdate>"+new Date+"</span><span class=logmsg>"+a+"</span></p>";c.innerHTML=d+c.innerHTML}else{window.status=a}}
;
function rc(a){var b="http://www.google.com/url?rand="+Ea()+"&q="+bc("http://www.google.com/images/cleardot.gif");Ob(b,10000,a)}
function Pb(a,b,c,d){if(d==0){c(false);return}d--;Ob(a,b,function(e){if(e){c(true)}else{Pb(a,b,c,d)}}
)}
function Ob(a,b,c){A("Net_TestLoadImage: loading "+a);var d=new Image;d.onload=function(){try{A("Net_TestLoadImage: loaded");db(d);c(true)}catch(e){ma(e)}}
;d.onerror=function(){try{A("Net_TestLoadImage: error");db(d);c(false)}catch(e){ma(e)}}
;d.onabort=function(){try{A("Net_TestLoadImage: abort");db(d);c(false)}catch(e){ma(e)}}
;d.ontimeout=function(){try{A("Net_TestLoadImage: timeout");db(d);c(false)}catch(e){ma(e)}}
;Fa(null,function(){if(d.ontimeout){d.ontimeout()}}
,b);d.src=a}
function db(a){a.onload=(a.onerror=(a.onabort=(a.ontimeout=null)))}
;
function ia(a,b,c){if(a.indexOf("?")<0){a+="?"}return a+("&"+b+"="+bc(c))}
;
var _XH_ACTIVE_X_IDENTS=["MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","MICROSOFT.XMLHTTP.1.0","MICROSOFT.XMLHTTP.1","MICROSOFT.XMLHTTP"];var _xh_ieProgId=undefined;function _XH_XmlHttpInit(){if(typeof XMLHttpRequest=="undefined"&&typeof ActiveXObject!="undefined"){for(var a=0;a<_XH_ACTIVE_X_IDENTS.length;a++){var b=_XH_ACTIVE_X_IDENTS[a];try{new ActiveXObject(b);_xh_ieProgId=b;break}catch(c){}}if(undefined===_xh_ieProgId){throw"Could not create ActiveXObject. ActiveX might be disabled, or msxml might not be installed"
;}}}
_XH_XmlHttpInit();function Cc(){if(_xh_ieProgId!==undefined){return new ActiveXObject(_xh_ieProgId)}else{return new XMLHttpRequest}}
function cc(a,b,c,d){a.onreadystatechange=d;a.open(b,c,true)}
function ec(a,b,c){a.setRequestHeader(b,c)}
function dc(a,b){try{a.send(b)}catch(c){kb("XMLHttpSend failed "+c.toString()+"<br>"+c.stack);throw c;}}
function Bc(a){Fa(window,function(){a.onreadystatechange=function(){}
}
,0);if(a.readyState<4){a.abort()}}
;
var Gb=false;function A(a){Fb(a,0)}
function Hb(a){try{throw a;}catch(b){ma(b)}}
function ma(a,b){var c="Javascript exception: "+(b?b:"")+" "+a;if(ua()){c+=" "+a.name+": "+a.message+" ("+a.number+")"}var d="";if(typeof a=="string"){d=a+"\n"}else{for(var e in a){try{d+=e+": "+a[e]+"\n"}catch(f){}}}d+=Db(ma.caller);Fb(c+"\n"+d,1)}
var Jc=/function (\w+)/;function kc(a){var b=Jc.exec(String(a));if(b){return b[1]}return""}
function Db(a){try{if(!ua()&&!(bb("safari")||bb("konqueror"))&&bb("mozilla")){return Error().stack}if(!a)return"";var b="- "+kc(a)+"(";for(var c=0;c<a.arguments.length;c++){if(c>0)b+=", ";var d=String(a.arguments[c]);if(d.length>40){d=d.substr(0,40)+"..."}b+=d}b+=")\n";b+=Db(a.caller);return b}catch(e){return"[Cannot get stack trace]: "+e+"\n"}}
var mc;var va=null;var qb=false;function lc(){if((va==null||va.closed)&&!qb){try{qb=true;va=window.open("","debug","width=700,height=500,toolbar=no,resizable=yes,scrollbars=yes,left=16,top=16,screenx=16,screeny=16");va.blur();va.document.open();qb=false;var a="<font color=#ff0000><b>To turn off this debugging window,hit 'D' inside the main caribou window, then close this window.</b></font><br>";Eb(a)}catch(b){}}}
function Fb(a,b){if(!Gb){if(typeof kb!="undefined"){kb(oa(a))}return}try{var c=Ea()-mc;var d="["+c+"] "+oa(a).replace(/\n/g,"<br>")+"<br>";if(b==1){d="<font color=#ff0000><b>Error: "+d+"</b></font>";va.focus()}Eb(d)}catch(e){}}
function Eb(a){if(!Gb){return}try{lc();va.document.write(a);va.scrollTo(0,1000000)}catch(b){}}
;

